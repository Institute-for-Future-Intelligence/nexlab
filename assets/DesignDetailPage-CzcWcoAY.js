import{f as V,r as P,p as tl,q as nl,j as g,B as Y,T as K,v as rr,a7 as Pn,aK as qt,I as me,aH as rl,a4 as qr,a8 as or,G as Wn,E as fi,bw as hi,H as gi,V as Jt,X as pi,b1 as lt,a0 as mi,a1 as xi,b9 as yi,a2 as bi,bx as vi,t as Hn,ad as ol,aI as il,by as wi,bz as Si,at as Un,bA as Ei,bB as Ci,bC as bn,D as Ct,a as Se,$ as _t,bD as sl,aJ as _i,al as Ii,A as ot,z as Ft,ac as al,C as It,a3 as Ai,bE as un,F as ki,w as Ni,S as ji,M as Mi}from"./ui-DvOWEHrS.js";import{a as rt,d as ll,s as B,b as Ee,c as $,t as q,v as Mr,g as cl,f as ul,u as dl}from"./index-BFbkbQ5Y.js";import{u as Q,C as zi,l as Ze,R as Be}from"./RichTextEditor-WNFUjVsk.js";import{r as Ti,g as fl}from"./vendor-BFl3bqVE.js";import hl from"./purify.es-CQJ0hv7W.js";import{k as Bn,r as Ln,z as Di,n as $i,p as Fi}from"./firebase-CTJJwFJC.js";function De(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,o;r<e.length;r++)(o=De(e[r]))!==""&&(t+=(t&&" ")+o);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var mr={exports:{}},xr={},yr={exports:{}},br={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yo;function gl(){if(yo)return br;yo=1;var e=Ti();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,o=e.useState,n=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function l(c,u){var h=u(),x=o({inst:{value:h,getSnapshot:u}}),v=x[0].inst,I=x[1];return i(function(){v.value=h,v.getSnapshot=u,d(v)&&I({inst:v})},[c,h,u]),n(function(){return d(v)&&I({inst:v}),c(function(){d(v)&&I({inst:v})})},[c]),s(h),h}function d(c){var u=c.getSnapshot;c=c.value;try{var h=u();return!r(c,h)}catch{return!0}}function f(c,u){return u()}var a=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:l;return br.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:a,br}var bo;function pl(){return bo||(bo=1,yr.exports=gl()),yr.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vo;function ml(){if(vo)return xr;vo=1;var e=Ti(),t=pl();function r(f,a){return f===a&&(f!==0||1/f===1/a)||f!==f&&a!==a}var o=typeof Object.is=="function"?Object.is:r,n=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,l=e.useMemo,d=e.useDebugValue;return xr.useSyncExternalStoreWithSelector=function(f,a,c,u,h){var x=i(null);if(x.current===null){var v={hasValue:!1,value:null};x.current=v}else v=x.current;x=l(function(){function p(E){if(!A){if(A=!0,k=E,E=u(E),h!==void 0&&v.hasValue){var z=v.value;if(h(z,E))return _=z}return _=E}if(z=_,o(k,E))return z;var S=u(E);return h!==void 0&&h(z,S)?(k=E,z):(k=E,_=S)}var A=!1,k,_,D=c===void 0?null:c;return[function(){return p(a())},D===null?void 0:function(){return p(D())}]},[a,c,u,h]);var I=n(f,x[0],x[1]);return s(function(){v.hasValue=!0,v.value=I},[I]),d(I),I},xr}var wo;function xl(){return wo||(wo=1,mr.exports=ml()),mr.exports}var yl=xl();const bl=fl(yl),vl={},So=e=>{let t;const r=new Set,o=(a,c)=>{const u=typeof a=="function"?a(t):a;if(!Object.is(u,t)){const h=t;t=c??(typeof u!="object"||u===null)?u:Object.assign({},t,u),r.forEach(x=>x(t,h))}},n=()=>t,d={setState:o,getState:n,getInitialState:()=>f,subscribe:a=>(r.add(a),()=>r.delete(a)),destroy:()=>{(vl?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},f=t=e(o,n,d);return d},wl=e=>e?So(e):So,{useDebugValue:Sl}=V,{useSyncExternalStoreWithSelector:El}=bl,Cl=e=>e;function Ri(e,t=Cl,r){const o=El(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return Sl(o),o}const Eo=(e,t)=>{const r=wl(e),o=(n,i=t)=>Ri(r,n,i);return Object.assign(o,r),o},_l=(e,t)=>e?Eo(e,t):Eo;function Le(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,n]of e)if(!Object.is(n,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const o of r)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var Il={value:()=>{}};function ir(){for(var e=0,t=arguments.length,r={},o;e<t;++e){if(!(o=arguments[e]+"")||o in r||/[\s.]/.test(o))throw new Error("illegal type: "+o);r[o]=[]}return new Tn(r)}function Tn(e){this._=e}function Al(e,t){return e.trim().split(/^|\s+/).map(function(r){var o="",n=r.indexOf(".");if(n>=0&&(o=r.slice(n+1),r=r.slice(0,n)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:o}})}Tn.prototype=ir.prototype={constructor:Tn,on:function(e,t){var r=this._,o=Al(e+"",r),n,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((n=(e=o[i]).type)&&(n=kl(r[n],e.name)))return n;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(n=(e=o[i]).type)r[n]=Co(r[n],e.name,t);else if(t==null)for(n in r)r[n]=Co(r[n],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Tn(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var r=new Array(n),o=0,n,i;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,n=i.length;o<n;++o)i[o].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],n=0,i=o.length;n<i;++n)o[n].value.apply(t,r)}};function kl(e,t){for(var r=0,o=e.length,n;r<o;++r)if((n=e[r]).name===t)return n.value}function Co(e,t,r){for(var o=0,n=e.length;o<n;++o)if(e[o].name===t){e[o]=Il,e=e.slice(0,o).concat(e.slice(o+1));break}return r!=null&&e.push({name:t,value:r}),e}var zr="http://www.w3.org/1999/xhtml";const _o={svg:"http://www.w3.org/2000/svg",xhtml:zr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function sr(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),_o.hasOwnProperty(t)?{space:_o[t],local:e}:e}function Nl(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===zr&&t.documentElement.namespaceURI===zr?t.createElement(e):t.createElementNS(r,e)}}function jl(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Pi(e){var t=sr(e);return(t.local?jl:Nl)(t)}function Ml(){}function Gr(e){return e==null?Ml:function(){return this.querySelector(e)}}function zl(e){typeof e!="function"&&(e=Gr(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var i=t[n],s=i.length,l=o[n]=new Array(s),d,f,a=0;a<s;++a)(d=i[a])&&(f=e.call(d,d.__data__,a,i))&&("__data__"in d&&(f.__data__=d.__data__),l[a]=f);return new Ve(o,this._parents)}function Tl(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Dl(){return[]}function Wi(e){return e==null?Dl:function(){return this.querySelectorAll(e)}}function $l(e){return function(){return Tl(e.apply(this,arguments))}}function Fl(e){typeof e=="function"?e=$l(e):e=Wi(e);for(var t=this._groups,r=t.length,o=[],n=[],i=0;i<r;++i)for(var s=t[i],l=s.length,d,f=0;f<l;++f)(d=s[f])&&(o.push(e.call(d,d.__data__,f,s)),n.push(d));return new Ve(o,n)}function Hi(e){return function(){return this.matches(e)}}function Ui(e){return function(t){return t.matches(e)}}var Rl=Array.prototype.find;function Pl(e){return function(){return Rl.call(this.children,e)}}function Wl(){return this.firstElementChild}function Hl(e){return this.select(e==null?Wl:Pl(typeof e=="function"?e:Ui(e)))}var Ul=Array.prototype.filter;function Bl(){return Array.from(this.children)}function Ll(e){return function(){return Ul.call(this.children,e)}}function Ol(e){return this.selectAll(e==null?Bl:Ll(typeof e=="function"?e:Ui(e)))}function Vl(e){typeof e!="function"&&(e=Hi(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var i=t[n],s=i.length,l=o[n]=[],d,f=0;f<s;++f)(d=i[f])&&e.call(d,d.__data__,f,i)&&l.push(d);return new Ve(o,this._parents)}function Bi(e){return new Array(e.length)}function Yl(){return new Ve(this._enter||this._groups.map(Bi),this._parents)}function On(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}On.prototype={constructor:On,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Xl(e){return function(){return e}}function ql(e,t,r,o,n,i){for(var s=0,l,d=t.length,f=i.length;s<f;++s)(l=t[s])?(l.__data__=i[s],o[s]=l):r[s]=new On(e,i[s]);for(;s<d;++s)(l=t[s])&&(n[s]=l)}function Gl(e,t,r,o,n,i,s){var l,d,f=new Map,a=t.length,c=i.length,u=new Array(a),h;for(l=0;l<a;++l)(d=t[l])&&(u[l]=h=s.call(d,d.__data__,l,t)+"",f.has(h)?n[l]=d:f.set(h,d));for(l=0;l<c;++l)h=s.call(e,i[l],l,i)+"",(d=f.get(h))?(o[l]=d,d.__data__=i[l],f.delete(h)):r[l]=new On(e,i[l]);for(l=0;l<a;++l)(d=t[l])&&f.get(u[l])===d&&(n[l]=d)}function Zl(e){return e.__data__}function Kl(e,t){if(!arguments.length)return Array.from(this,Zl);var r=t?Gl:ql,o=this._parents,n=this._groups;typeof e!="function"&&(e=Xl(e));for(var i=n.length,s=new Array(i),l=new Array(i),d=new Array(i),f=0;f<i;++f){var a=o[f],c=n[f],u=c.length,h=Ql(e.call(a,a&&a.__data__,f,o)),x=h.length,v=l[f]=new Array(x),I=s[f]=new Array(x),p=d[f]=new Array(u);r(a,c,v,I,p,h,t);for(var A=0,k=0,_,D;A<x;++A)if(_=v[A]){for(A>=k&&(k=A+1);!(D=I[k])&&++k<x;);_._next=D||null}}return s=new Ve(s,o),s._enter=l,s._exit=d,s}function Ql(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Jl(){return new Ve(this._exit||this._groups.map(Bi),this._parents)}function ec(e,t,r){var o=this.enter(),n=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(n=t(n),n&&(n=n.selection())),r==null?i.remove():r(i),o&&n?o.merge(n).order():n}function tc(e){for(var t=e.selection?e.selection():e,r=this._groups,o=t._groups,n=r.length,i=o.length,s=Math.min(n,i),l=new Array(n),d=0;d<s;++d)for(var f=r[d],a=o[d],c=f.length,u=l[d]=new Array(c),h,x=0;x<c;++x)(h=f[x]||a[x])&&(u[x]=h);for(;d<n;++d)l[d]=r[d];return new Ve(l,this._parents)}function nc(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var o=e[t],n=o.length-1,i=o[n],s;--n>=0;)(s=o[n])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function rc(e){e||(e=oc);function t(c,u){return c&&u?e(c.__data__,u.__data__):!c-!u}for(var r=this._groups,o=r.length,n=new Array(o),i=0;i<o;++i){for(var s=r[i],l=s.length,d=n[i]=new Array(l),f,a=0;a<l;++a)(f=s[a])&&(d[a]=f);d.sort(t)}return new Ve(n,this._parents).order()}function oc(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ic(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function sc(){return Array.from(this)}function ac(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],n=0,i=o.length;n<i;++n){var s=o[n];if(s)return s}return null}function lc(){let e=0;for(const t of this)++e;return e}function cc(){return!this.node()}function uc(e){for(var t=this._groups,r=0,o=t.length;r<o;++r)for(var n=t[r],i=0,s=n.length,l;i<s;++i)(l=n[i])&&e.call(l,l.__data__,i,n);return this}function dc(e){return function(){this.removeAttribute(e)}}function fc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function hc(e,t){return function(){this.setAttribute(e,t)}}function gc(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function pc(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function mc(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function xc(e,t){var r=sr(e);if(arguments.length<2){var o=this.node();return r.local?o.getAttributeNS(r.space,r.local):o.getAttribute(r)}return this.each((t==null?r.local?fc:dc:typeof t=="function"?r.local?mc:pc:r.local?gc:hc)(r,t))}function Li(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function yc(e){return function(){this.style.removeProperty(e)}}function bc(e,t,r){return function(){this.style.setProperty(e,t,r)}}function vc(e,t,r){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,r)}}function wc(e,t,r){return arguments.length>1?this.each((t==null?yc:typeof t=="function"?vc:bc)(e,t,r??"")):Gt(this.node(),e)}function Gt(e,t){return e.style.getPropertyValue(t)||Li(e).getComputedStyle(e,null).getPropertyValue(t)}function Sc(e){return function(){delete this[e]}}function Ec(e,t){return function(){this[e]=t}}function Cc(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function _c(e,t){return arguments.length>1?this.each((t==null?Sc:typeof t=="function"?Cc:Ec)(e,t)):this.node()[e]}function Oi(e){return e.trim().split(/^|\s+/)}function Zr(e){return e.classList||new Vi(e)}function Vi(e){this._node=e,this._names=Oi(e.getAttribute("class")||"")}Vi.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Yi(e,t){for(var r=Zr(e),o=-1,n=t.length;++o<n;)r.add(t[o])}function Xi(e,t){for(var r=Zr(e),o=-1,n=t.length;++o<n;)r.remove(t[o])}function Ic(e){return function(){Yi(this,e)}}function Ac(e){return function(){Xi(this,e)}}function kc(e,t){return function(){(t.apply(this,arguments)?Yi:Xi)(this,e)}}function Nc(e,t){var r=Oi(e+"");if(arguments.length<2){for(var o=Zr(this.node()),n=-1,i=r.length;++n<i;)if(!o.contains(r[n]))return!1;return!0}return this.each((typeof t=="function"?kc:t?Ic:Ac)(r,t))}function jc(){this.textContent=""}function Mc(e){return function(){this.textContent=e}}function zc(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Tc(e){return arguments.length?this.each(e==null?jc:(typeof e=="function"?zc:Mc)(e)):this.node().textContent}function Dc(){this.innerHTML=""}function $c(e){return function(){this.innerHTML=e}}function Fc(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Rc(e){return arguments.length?this.each(e==null?Dc:(typeof e=="function"?Fc:$c)(e)):this.node().innerHTML}function Pc(){this.nextSibling&&this.parentNode.appendChild(this)}function Wc(){return this.each(Pc)}function Hc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Uc(){return this.each(Hc)}function Bc(e){var t=typeof e=="function"?e:Pi(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Lc(){return null}function Oc(e,t){var r=typeof e=="function"?e:Pi(e),o=t==null?Lc:typeof t=="function"?t:Gr(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),o.apply(this,arguments)||null)})}function Vc(){var e=this.parentNode;e&&e.removeChild(this)}function Yc(){return this.each(Vc)}function Xc(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function qc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Gc(e){return this.select(e?qc:Xc)}function Zc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Kc(e){return function(t){e.call(this,t,this.__data__)}}function Qc(e){return e.trim().split(/^|\s+/).map(function(t){var r="",o=t.indexOf(".");return o>=0&&(r=t.slice(o+1),t=t.slice(0,o)),{type:t,name:r}})}function Jc(e){return function(){var t=this.__on;if(t){for(var r=0,o=-1,n=t.length,i;r<n;++r)i=t[r],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function eu(e,t,r){return function(){var o=this.__on,n,i=Kc(t);if(o){for(var s=0,l=o.length;s<l;++s)if((n=o[s]).type===e.type&&n.name===e.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=i,n.options=r),n.value=t;return}}this.addEventListener(e.type,i,r),n={type:e.type,name:e.name,value:t,listener:i,options:r},o?o.push(n):this.__on=[n]}}function tu(e,t,r){var o=Qc(e+""),n,i=o.length,s;if(arguments.length<2){var l=this.node().__on;if(l){for(var d=0,f=l.length,a;d<f;++d)for(n=0,a=l[d];n<i;++n)if((s=o[n]).type===a.type&&s.name===a.name)return a.value}return}for(l=t?eu:Jc,n=0;n<i;++n)this.each(l(o[n],t,r));return this}function qi(e,t,r){var o=Li(e),n=o.CustomEvent;typeof n=="function"?n=new n(t,r):(n=o.document.createEvent("Event"),r?(n.initEvent(t,r.bubbles,r.cancelable),n.detail=r.detail):n.initEvent(t,!1,!1)),e.dispatchEvent(n)}function nu(e,t){return function(){return qi(this,e,t)}}function ru(e,t){return function(){return qi(this,e,t.apply(this,arguments))}}function ou(e,t){return this.each((typeof t=="function"?ru:nu)(e,t))}function*iu(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],n=0,i=o.length,s;n<i;++n)(s=o[n])&&(yield s)}var Gi=[null];function Ve(e,t){this._groups=e,this._parents=t}function vn(){return new Ve([[document.documentElement]],Gi)}function su(){return this}Ve.prototype=vn.prototype={constructor:Ve,select:zl,selectAll:Fl,selectChild:Hl,selectChildren:Ol,filter:Vl,data:Kl,enter:Yl,exit:Jl,join:ec,merge:tc,selection:su,order:nc,sort:rc,call:ic,nodes:sc,node:ac,size:lc,empty:cc,each:uc,attr:xc,style:wc,property:_c,classed:Nc,text:Tc,html:Rc,raise:Wc,lower:Uc,append:Bc,insert:Oc,remove:Yc,clone:Gc,datum:Zc,on:tu,dispatch:ou,[Symbol.iterator]:iu};function qe(e){return typeof e=="string"?new Ve([[document.querySelector(e)]],[document.documentElement]):new Ve([[e]],Gi)}function au(e){let t;for(;t=e.sourceEvent;)e=t;return e}function tt(e,t){if(e=au(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var o=r.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var n=t.getBoundingClientRect();return[e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop]}}return[e.pageX,e.pageY]}const lu={passive:!1},dn={capture:!0,passive:!1};function vr(e){e.stopImmediatePropagation()}function Ot(e){e.preventDefault(),e.stopImmediatePropagation()}function Zi(e){var t=e.document.documentElement,r=qe(e).on("dragstart.drag",Ot,dn);"onselectstart"in t?r.on("selectstart.drag",Ot,dn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Ki(e,t){var r=e.document.documentElement,o=qe(e).on("dragstart.drag",null);t&&(o.on("click.drag",Ot,dn),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in r?o.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Cn=e=>()=>e;function Tr(e,{sourceEvent:t,subject:r,target:o,identifier:n,active:i,x:s,y:l,dx:d,dy:f,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:n,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:a}})}Tr.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function cu(e){return!e.ctrlKey&&!e.button}function uu(){return this.parentNode}function du(e,t){return t??{x:e.x,y:e.y}}function fu(){return navigator.maxTouchPoints||"ontouchstart"in this}function hu(){var e=cu,t=uu,r=du,o=fu,n={},i=ir("start","drag","end"),s=0,l,d,f,a,c=0;function u(_){_.on("mousedown.drag",h).filter(o).on("touchstart.drag",I).on("touchmove.drag",p,lu).on("touchend.drag touchcancel.drag",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(_,D){if(!(a||!e.call(this,_,D))){var E=k(this,t.call(this,_,D),_,D,"mouse");E&&(qe(_.view).on("mousemove.drag",x,dn).on("mouseup.drag",v,dn),Zi(_.view),vr(_),f=!1,l=_.clientX,d=_.clientY,E("start",_))}}function x(_){if(Ot(_),!f){var D=_.clientX-l,E=_.clientY-d;f=D*D+E*E>c}n.mouse("drag",_)}function v(_){qe(_.view).on("mousemove.drag mouseup.drag",null),Ki(_.view,f),Ot(_),n.mouse("end",_)}function I(_,D){if(e.call(this,_,D)){var E=_.changedTouches,z=t.call(this,_,D),S=E.length,w,M;for(w=0;w<S;++w)(M=k(this,z,_,D,E[w].identifier,E[w]))&&(vr(_),M("start",_,E[w]))}}function p(_){var D=_.changedTouches,E=D.length,z,S;for(z=0;z<E;++z)(S=n[D[z].identifier])&&(Ot(_),S("drag",_,D[z]))}function A(_){var D=_.changedTouches,E=D.length,z,S;for(a&&clearTimeout(a),a=setTimeout(function(){a=null},500),z=0;z<E;++z)(S=n[D[z].identifier])&&(vr(_),S("end",_,D[z]))}function k(_,D,E,z,S,w){var M=i.copy(),j=tt(w||E,D),T,F,m;if((m=r.call(_,new Tr("beforestart",{sourceEvent:E,target:u,identifier:S,active:s,x:j[0],y:j[1],dx:0,dy:0,dispatch:M}),z))!=null)return T=m.x-j[0]||0,F=m.y-j[1]||0,function C(y,b,W){var N=j,R;switch(y){case"start":n[S]=C,R=s++;break;case"end":delete n[S],--s;case"drag":j=tt(W||b,D),R=s;break}M.call(y,_,new Tr(y,{sourceEvent:b,subject:m,target:u,identifier:S,active:R,x:j[0]+T,y:j[1]+F,dx:j[0]-N[0],dy:j[1]-N[1],dispatch:M}),z)}}return u.filter=function(_){return arguments.length?(e=typeof _=="function"?_:Cn(!!_),u):e},u.container=function(_){return arguments.length?(t=typeof _=="function"?_:Cn(_),u):t},u.subject=function(_){return arguments.length?(r=typeof _=="function"?_:Cn(_),u):r},u.touchable=function(_){return arguments.length?(o=typeof _=="function"?_:Cn(!!_),u):o},u.on=function(){var _=i.on.apply(i,arguments);return _===i?u:_},u.clickDistance=function(_){return arguments.length?(c=(_=+_)*_,u):Math.sqrt(c)},u}function Kr(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Qi(e,t){var r=Object.create(e.prototype);for(var o in t)r[o]=t[o];return r}function wn(){}var fn=.7,Vn=1/fn,Vt="\\s*([+-]?\\d+)\\s*",hn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",at="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gu=/^#([0-9a-f]{3,8})$/,pu=new RegExp(`^rgb\\(${Vt},${Vt},${Vt}\\)$`),mu=new RegExp(`^rgb\\(${at},${at},${at}\\)$`),xu=new RegExp(`^rgba\\(${Vt},${Vt},${Vt},${hn}\\)$`),yu=new RegExp(`^rgba\\(${at},${at},${at},${hn}\\)$`),bu=new RegExp(`^hsl\\(${hn},${at},${at}\\)$`),vu=new RegExp(`^hsla\\(${hn},${at},${at},${hn}\\)$`),Io={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kr(wn,gn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ao,formatHex:Ao,formatHex8:wu,formatHsl:Su,formatRgb:ko,toString:ko});function Ao(){return this.rgb().formatHex()}function wu(){return this.rgb().formatHex8()}function Su(){return Ji(this).formatHsl()}function ko(){return this.rgb().formatRgb()}function gn(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=gu.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?No(t):r===3?new Ue(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?_n(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?_n(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=pu.exec(e))?new Ue(t[1],t[2],t[3],1):(t=mu.exec(e))?new Ue(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=xu.exec(e))?_n(t[1],t[2],t[3],t[4]):(t=yu.exec(e))?_n(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=bu.exec(e))?zo(t[1],t[2]/100,t[3]/100,1):(t=vu.exec(e))?zo(t[1],t[2]/100,t[3]/100,t[4]):Io.hasOwnProperty(e)?No(Io[e]):e==="transparent"?new Ue(NaN,NaN,NaN,0):null}function No(e){return new Ue(e>>16&255,e>>8&255,e&255,1)}function _n(e,t,r,o){return o<=0&&(e=t=r=NaN),new Ue(e,t,r,o)}function Eu(e){return e instanceof wn||(e=gn(e)),e?(e=e.rgb(),new Ue(e.r,e.g,e.b,e.opacity)):new Ue}function Dr(e,t,r,o){return arguments.length===1?Eu(e):new Ue(e,t,r,o??1)}function Ue(e,t,r,o){this.r=+e,this.g=+t,this.b=+r,this.opacity=+o}Kr(Ue,Dr,Qi(wn,{brighter(e){return e=e==null?Vn:Math.pow(Vn,e),new Ue(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?fn:Math.pow(fn,e),new Ue(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ue(Tt(this.r),Tt(this.g),Tt(this.b),Yn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:jo,formatHex:jo,formatHex8:Cu,formatRgb:Mo,toString:Mo}));function jo(){return`#${jt(this.r)}${jt(this.g)}${jt(this.b)}`}function Cu(){return`#${jt(this.r)}${jt(this.g)}${jt(this.b)}${jt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Mo(){const e=Yn(this.opacity);return`${e===1?"rgb(":"rgba("}${Tt(this.r)}, ${Tt(this.g)}, ${Tt(this.b)}${e===1?")":`, ${e})`}`}function Yn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Tt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function jt(e){return e=Tt(e),(e<16?"0":"")+e.toString(16)}function zo(e,t,r,o){return o<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new nt(e,t,r,o)}function Ji(e){if(e instanceof nt)return new nt(e.h,e.s,e.l,e.opacity);if(e instanceof wn||(e=gn(e)),!e)return new nt;if(e instanceof nt)return e;e=e.rgb();var t=e.r/255,r=e.g/255,o=e.b/255,n=Math.min(t,r,o),i=Math.max(t,r,o),s=NaN,l=i-n,d=(i+n)/2;return l?(t===i?s=(r-o)/l+(r<o)*6:r===i?s=(o-t)/l+2:s=(t-r)/l+4,l/=d<.5?i+n:2-i-n,s*=60):l=d>0&&d<1?0:s,new nt(s,l,d,e.opacity)}function _u(e,t,r,o){return arguments.length===1?Ji(e):new nt(e,t,r,o??1)}function nt(e,t,r,o){this.h=+e,this.s=+t,this.l=+r,this.opacity=+o}Kr(nt,_u,Qi(wn,{brighter(e){return e=e==null?Vn:Math.pow(Vn,e),new nt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?fn:Math.pow(fn,e),new nt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*t,n=2*r-o;return new Ue(wr(e>=240?e-240:e+120,n,o),wr(e,n,o),wr(e<120?e+240:e-120,n,o),this.opacity)},clamp(){return new nt(To(this.h),In(this.s),In(this.l),Yn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Yn(this.opacity);return`${e===1?"hsl(":"hsla("}${To(this.h)}, ${In(this.s)*100}%, ${In(this.l)*100}%${e===1?")":`, ${e})`}`}}));function To(e){return e=(e||0)%360,e<0?e+360:e}function In(e){return Math.max(0,Math.min(1,e||0))}function wr(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const es=e=>()=>e;function Iu(e,t){return function(r){return e+r*t}}function Au(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(o){return Math.pow(e+o*t,r)}}function ku(e){return(e=+e)==1?ts:function(t,r){return r-t?Au(t,r,e):es(isNaN(t)?r:t)}}function ts(e,t){var r=t-e;return r?Iu(e,r):es(isNaN(e)?t:e)}const Do=function e(t){var r=ku(t);function o(n,i){var s=r((n=Dr(n)).r,(i=Dr(i)).r),l=r(n.g,i.g),d=r(n.b,i.b),f=ts(n.opacity,i.opacity);return function(a){return n.r=s(a),n.g=l(a),n.b=d(a),n.opacity=f(a),n+""}}return o.gamma=e,o}(1);function vt(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var $r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sr=new RegExp($r.source,"g");function Nu(e){return function(){return e}}function ju(e){return function(t){return e(t)+""}}function Mu(e,t){var r=$r.lastIndex=Sr.lastIndex=0,o,n,i,s=-1,l=[],d=[];for(e=e+"",t=t+"";(o=$r.exec(e))&&(n=Sr.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(o=o[0])===(n=n[0])?l[s]?l[s]+=n:l[++s]=n:(l[++s]=null,d.push({i:s,x:vt(o,n)})),r=Sr.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?d[0]?ju(d[0].x):Nu(t):(t=d.length,function(f){for(var a=0,c;a<t;++a)l[(c=d[a]).i]=c.x(f);return l.join("")})}var $o=180/Math.PI,Fr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ns(e,t,r,o,n,i){var s,l,d;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(d=e*r+t*o)&&(r-=e*d,o-=t*d),(l=Math.sqrt(r*r+o*o))&&(r/=l,o/=l,d/=l),e*o<t*r&&(e=-e,t=-t,d=-d,s=-s),{translateX:n,translateY:i,rotate:Math.atan2(t,e)*$o,skewX:Math.atan(d)*$o,scaleX:s,scaleY:l}}var An;function zu(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Fr:ns(t.a,t.b,t.c,t.d,t.e,t.f)}function Tu(e){return e==null||(An||(An=document.createElementNS("http://www.w3.org/2000/svg","g")),An.setAttribute("transform",e),!(e=An.transform.baseVal.consolidate()))?Fr:(e=e.matrix,ns(e.a,e.b,e.c,e.d,e.e,e.f))}function rs(e,t,r,o){function n(f){return f.length?f.pop()+" ":""}function i(f,a,c,u,h,x){if(f!==c||a!==u){var v=h.push("translate(",null,t,null,r);x.push({i:v-4,x:vt(f,c)},{i:v-2,x:vt(a,u)})}else(c||u)&&h.push("translate("+c+t+u+r)}function s(f,a,c,u){f!==a?(f-a>180?a+=360:a-f>180&&(f+=360),u.push({i:c.push(n(c)+"rotate(",null,o)-2,x:vt(f,a)})):a&&c.push(n(c)+"rotate("+a+o)}function l(f,a,c,u){f!==a?u.push({i:c.push(n(c)+"skewX(",null,o)-2,x:vt(f,a)}):a&&c.push(n(c)+"skewX("+a+o)}function d(f,a,c,u,h,x){if(f!==c||a!==u){var v=h.push(n(h)+"scale(",null,",",null,")");x.push({i:v-4,x:vt(f,c)},{i:v-2,x:vt(a,u)})}else(c!==1||u!==1)&&h.push(n(h)+"scale("+c+","+u+")")}return function(f,a){var c=[],u=[];return f=e(f),a=e(a),i(f.translateX,f.translateY,a.translateX,a.translateY,c,u),s(f.rotate,a.rotate,c,u),l(f.skewX,a.skewX,c,u),d(f.scaleX,f.scaleY,a.scaleX,a.scaleY,c,u),f=a=null,function(h){for(var x=-1,v=u.length,I;++x<v;)c[(I=u[x]).i]=I.x(h);return c.join("")}}}var Du=rs(zu,"px, ","px)","deg)"),$u=rs(Tu,", ",")",")"),Fu=1e-12;function Fo(e){return((e=Math.exp(e))+1/e)/2}function Ru(e){return((e=Math.exp(e))-1/e)/2}function Pu(e){return((e=Math.exp(2*e))-1)/(e+1)}const Wu=function e(t,r,o){function n(i,s){var l=i[0],d=i[1],f=i[2],a=s[0],c=s[1],u=s[2],h=a-l,x=c-d,v=h*h+x*x,I,p;if(v<Fu)p=Math.log(u/f)/t,I=function(z){return[l+z*h,d+z*x,f*Math.exp(t*z*p)]};else{var A=Math.sqrt(v),k=(u*u-f*f+o*v)/(2*f*r*A),_=(u*u-f*f-o*v)/(2*u*r*A),D=Math.log(Math.sqrt(k*k+1)-k),E=Math.log(Math.sqrt(_*_+1)-_);p=(E-D)/t,I=function(z){var S=z*p,w=Fo(D),M=f/(r*A)*(w*Pu(t*S+D)-Ru(D));return[l+M*h,d+M*x,f*w/Fo(t*S+D)]}}return I.duration=p*1e3*t/Math.SQRT2,I}return n.rho=function(i){var s=Math.max(.001,+i),l=s*s,d=l*l;return e(s,l,d)},n}(Math.SQRT2,2,4);var Zt=0,an=0,tn=0,os=1e3,Xn,ln,qn=0,$t=0,ar=0,pn=typeof performance=="object"&&performance.now?performance:Date,is=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Qr(){return $t||(is(Hu),$t=pn.now()+ar)}function Hu(){$t=0}function Gn(){this._call=this._time=this._next=null}Gn.prototype=ss.prototype={constructor:Gn,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Qr():+r)+(t==null?0:+t),!this._next&&ln!==this&&(ln?ln._next=this:Xn=this,ln=this),this._call=e,this._time=r,Rr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Rr())}};function ss(e,t,r){var o=new Gn;return o.restart(e,t,r),o}function Uu(){Qr(),++Zt;for(var e=Xn,t;e;)(t=$t-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Zt}function Ro(){$t=(qn=pn.now())+ar,Zt=an=0;try{Uu()}finally{Zt=0,Lu(),$t=0}}function Bu(){var e=pn.now(),t=e-qn;t>os&&(ar-=t,qn=e)}function Lu(){for(var e,t=Xn,r,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:Xn=r);ln=e,Rr(o)}function Rr(e){if(!Zt){an&&(an=clearTimeout(an));var t=e-$t;t>24?(e<1/0&&(an=setTimeout(Ro,e-pn.now()-ar)),tn&&(tn=clearInterval(tn))):(tn||(qn=pn.now(),tn=setInterval(Bu,os)),Zt=1,is(Ro))}}function Po(e,t,r){var o=new Gn;return t=t==null?0:+t,o.restart(n=>{o.stop(),e(n+t)},t,r),o}var Ou=ir("start","end","cancel","interrupt"),Vu=[],as=0,Wo=1,Pr=2,Dn=3,Ho=4,Wr=5,$n=6;function lr(e,t,r,o,n,i){var s=e.__transition;if(!s)e.__transition={};else if(r in s)return;Yu(e,r,{name:t,index:o,group:n,on:Ou,tween:Vu,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:as})}function Jr(e,t){var r=it(e,t);if(r.state>as)throw new Error("too late; already scheduled");return r}function ct(e,t){var r=it(e,t);if(r.state>Dn)throw new Error("too late; already running");return r}function it(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function Yu(e,t,r){var o=e.__transition,n;o[t]=r,r.timer=ss(i,0,r.time);function i(f){r.state=Wo,r.timer.restart(s,r.delay,r.time),r.delay<=f&&s(f-r.delay)}function s(f){var a,c,u,h;if(r.state!==Wo)return d();for(a in o)if(h=o[a],h.name===r.name){if(h.state===Dn)return Po(s);h.state===Ho?(h.state=$n,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[a]):+a<t&&(h.state=$n,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete o[a])}if(Po(function(){r.state===Dn&&(r.state=Ho,r.timer.restart(l,r.delay,r.time),l(f))}),r.state=Pr,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Pr){for(r.state=Dn,n=new Array(u=r.tween.length),a=0,c=-1;a<u;++a)(h=r.tween[a].value.call(e,e.__data__,r.index,r.group))&&(n[++c]=h);n.length=c+1}}function l(f){for(var a=f<r.duration?r.ease.call(null,f/r.duration):(r.timer.restart(d),r.state=Wr,1),c=-1,u=n.length;++c<u;)n[c].call(e,a);r.state===Wr&&(r.on.call("end",e,e.__data__,r.index,r.group),d())}function d(){r.state=$n,r.timer.stop(),delete o[t];for(var f in o)return;delete e.__transition}}function Fn(e,t){var r=e.__transition,o,n,i=!0,s;if(r){t=t==null?null:t+"";for(s in r){if((o=r[s]).name!==t){i=!1;continue}n=o.state>Pr&&o.state<Wr,o.state=$n,o.timer.stop(),o.on.call(n?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete r[s]}i&&delete e.__transition}}function Xu(e){return this.each(function(){Fn(this,e)})}function qu(e,t){var r,o;return function(){var n=ct(this,e),i=n.tween;if(i!==r){o=r=i;for(var s=0,l=o.length;s<l;++s)if(o[s].name===t){o=o.slice(),o.splice(s,1);break}}n.tween=o}}function Gu(e,t,r){var o,n;if(typeof r!="function")throw new Error;return function(){var i=ct(this,e),s=i.tween;if(s!==o){n=(o=s).slice();for(var l={name:t,value:r},d=0,f=n.length;d<f;++d)if(n[d].name===t){n[d]=l;break}d===f&&n.push(l)}i.tween=n}}function Zu(e,t){var r=this._id;if(e+="",arguments.length<2){for(var o=it(this.node(),r).tween,n=0,i=o.length,s;n<i;++n)if((s=o[n]).name===e)return s.value;return null}return this.each((t==null?qu:Gu)(r,e,t))}function eo(e,t,r){var o=e._id;return e.each(function(){var n=ct(this,o);(n.value||(n.value={}))[t]=r.apply(this,arguments)}),function(n){return it(n,o).value[t]}}function ls(e,t){var r;return(typeof t=="number"?vt:t instanceof gn?Do:(r=gn(t))?(t=r,Do):Mu)(e,t)}function Ku(e){return function(){this.removeAttribute(e)}}function Qu(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ju(e,t,r){var o,n=r+"",i;return function(){var s=this.getAttribute(e);return s===n?null:s===o?i:i=t(o=s,r)}}function ed(e,t,r){var o,n=r+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===n?null:s===o?i:i=t(o=s,r)}}function td(e,t,r){var o,n,i;return function(){var s,l=r(this),d;return l==null?void this.removeAttribute(e):(s=this.getAttribute(e),d=l+"",s===d?null:s===o&&d===n?i:(n=d,i=t(o=s,l)))}}function nd(e,t,r){var o,n,i;return function(){var s,l=r(this),d;return l==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),d=l+"",s===d?null:s===o&&d===n?i:(n=d,i=t(o=s,l)))}}function rd(e,t){var r=sr(e),o=r==="transform"?$u:ls;return this.attrTween(e,typeof t=="function"?(r.local?nd:td)(r,o,eo(this,"attr."+e,t)):t==null?(r.local?Qu:Ku)(r):(r.local?ed:Ju)(r,o,t))}function od(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function id(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function sd(e,t){var r,o;function n(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&id(e,i)),r}return n._value=t,n}function ad(e,t){var r,o;function n(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&od(e,i)),r}return n._value=t,n}function ld(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var o=sr(e);return this.tween(r,(o.local?sd:ad)(o,t))}function cd(e,t){return function(){Jr(this,e).delay=+t.apply(this,arguments)}}function ud(e,t){return t=+t,function(){Jr(this,e).delay=t}}function dd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?cd:ud)(t,e)):it(this.node(),t).delay}function fd(e,t){return function(){ct(this,e).duration=+t.apply(this,arguments)}}function hd(e,t){return t=+t,function(){ct(this,e).duration=t}}function gd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fd:hd)(t,e)):it(this.node(),t).duration}function pd(e,t){if(typeof t!="function")throw new Error;return function(){ct(this,e).ease=t}}function md(e){var t=this._id;return arguments.length?this.each(pd(t,e)):it(this.node(),t).ease}function xd(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;ct(this,e).ease=r}}function yd(e){if(typeof e!="function")throw new Error;return this.each(xd(this._id,e))}function bd(e){typeof e!="function"&&(e=Hi(e));for(var t=this._groups,r=t.length,o=new Array(r),n=0;n<r;++n)for(var i=t[n],s=i.length,l=o[n]=[],d,f=0;f<s;++f)(d=i[f])&&e.call(d,d.__data__,f,i)&&l.push(d);return new mt(o,this._parents,this._name,this._id)}function vd(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,o=t.length,n=r.length,i=Math.min(o,n),s=new Array(o),l=0;l<i;++l)for(var d=t[l],f=r[l],a=d.length,c=s[l]=new Array(a),u,h=0;h<a;++h)(u=d[h]||f[h])&&(c[h]=u);for(;l<o;++l)s[l]=t[l];return new mt(s,this._parents,this._name,this._id)}function wd(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function Sd(e,t,r){var o,n,i=wd(t)?Jr:ct;return function(){var s=i(this,e),l=s.on;l!==o&&(n=(o=l).copy()).on(t,r),s.on=n}}function Ed(e,t){var r=this._id;return arguments.length<2?it(this.node(),r).on.on(e):this.each(Sd(r,e,t))}function Cd(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function _d(){return this.on("end.remove",Cd(this._id))}function Id(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Gr(e));for(var o=this._groups,n=o.length,i=new Array(n),s=0;s<n;++s)for(var l=o[s],d=l.length,f=i[s]=new Array(d),a,c,u=0;u<d;++u)(a=l[u])&&(c=e.call(a,a.__data__,u,l))&&("__data__"in a&&(c.__data__=a.__data__),f[u]=c,lr(f[u],t,r,u,f,it(a,r)));return new mt(i,this._parents,t,r)}function Ad(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Wi(e));for(var o=this._groups,n=o.length,i=[],s=[],l=0;l<n;++l)for(var d=o[l],f=d.length,a,c=0;c<f;++c)if(a=d[c]){for(var u=e.call(a,a.__data__,c,d),h,x=it(a,r),v=0,I=u.length;v<I;++v)(h=u[v])&&lr(h,t,r,v,u,x);i.push(u),s.push(a)}return new mt(i,s,t,r)}var kd=vn.prototype.constructor;function Nd(){return new kd(this._groups,this._parents)}function jd(e,t){var r,o,n;return function(){var i=Gt(this,e),s=(this.style.removeProperty(e),Gt(this,e));return i===s?null:i===r&&s===o?n:n=t(r=i,o=s)}}function cs(e){return function(){this.style.removeProperty(e)}}function Md(e,t,r){var o,n=r+"",i;return function(){var s=Gt(this,e);return s===n?null:s===o?i:i=t(o=s,r)}}function zd(e,t,r){var o,n,i;return function(){var s=Gt(this,e),l=r(this),d=l+"";return l==null&&(d=l=(this.style.removeProperty(e),Gt(this,e))),s===d?null:s===o&&d===n?i:(n=d,i=t(o=s,l))}}function Td(e,t){var r,o,n,i="style."+t,s="end."+i,l;return function(){var d=ct(this,e),f=d.on,a=d.value[i]==null?l||(l=cs(t)):void 0;(f!==r||n!==a)&&(o=(r=f).copy()).on(s,n=a),d.on=o}}function Dd(e,t,r){var o=(e+="")=="transform"?Du:ls;return t==null?this.styleTween(e,jd(e,o)).on("end.style."+e,cs(e)):typeof t=="function"?this.styleTween(e,zd(e,o,eo(this,"style."+e,t))).each(Td(this._id,e)):this.styleTween(e,Md(e,o,t),r).on("end.style."+e,null)}function $d(e,t,r){return function(o){this.style.setProperty(e,t.call(this,o),r)}}function Fd(e,t,r){var o,n;function i(){var s=t.apply(this,arguments);return s!==n&&(o=(n=s)&&$d(e,s,r)),o}return i._value=t,i}function Rd(e,t,r){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,Fd(e,t,r??""))}function Pd(e){return function(){this.textContent=e}}function Wd(e){return function(){var t=e(this);this.textContent=t??""}}function Hd(e){return this.tween("text",typeof e=="function"?Wd(eo(this,"text",e)):Pd(e==null?"":e+""))}function Ud(e){return function(t){this.textContent=e.call(this,t)}}function Bd(e){var t,r;function o(){var n=e.apply(this,arguments);return n!==r&&(t=(r=n)&&Ud(n)),t}return o._value=e,o}function Ld(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Bd(e))}function Od(){for(var e=this._name,t=this._id,r=us(),o=this._groups,n=o.length,i=0;i<n;++i)for(var s=o[i],l=s.length,d,f=0;f<l;++f)if(d=s[f]){var a=it(d,t);lr(d,e,r,f,s,{time:a.time+a.delay+a.duration,delay:0,duration:a.duration,ease:a.ease})}return new mt(o,this._parents,e,r)}function Vd(){var e,t,r=this,o=r._id,n=r.size();return new Promise(function(i,s){var l={value:s},d={value:function(){--n===0&&i()}};r.each(function(){var f=ct(this,o),a=f.on;a!==e&&(t=(e=a).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(d)),f.on=t}),n===0&&i()})}var Yd=0;function mt(e,t,r,o){this._groups=e,this._parents=t,this._name=r,this._id=o}function us(){return++Yd}var ht=vn.prototype;mt.prototype={constructor:mt,select:Id,selectAll:Ad,selectChild:ht.selectChild,selectChildren:ht.selectChildren,filter:bd,merge:vd,selection:Nd,transition:Od,call:ht.call,nodes:ht.nodes,node:ht.node,size:ht.size,empty:ht.empty,each:ht.each,on:Ed,attr:rd,attrTween:ld,style:Dd,styleTween:Rd,text:Hd,textTween:Ld,remove:_d,tween:Zu,delay:dd,duration:gd,ease:md,easeVarying:yd,end:Vd,[Symbol.iterator]:ht[Symbol.iterator]};function Xd(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var qd={time:null,delay:0,duration:250,ease:Xd};function Gd(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function Zd(e){var t,r;e instanceof mt?(t=e._id,e=e._name):(t=us(),(r=qd).time=Qr(),e=e==null?null:e+"");for(var o=this._groups,n=o.length,i=0;i<n;++i)for(var s=o[i],l=s.length,d,f=0;f<l;++f)(d=s[f])&&lr(d,e,t,f,s,r||Gd(d,t));return new mt(o,this._parents,e,t)}vn.prototype.interrupt=Xu;vn.prototype.transition=Zd;const kn=e=>()=>e;function Kd(e,{sourceEvent:t,target:r,transform:o,dispatch:n}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:n}})}function gt(e,t,r){this.k=e,this.x=t,this.y=r}gt.prototype={constructor:gt,scale:function(e){return e===1?this:new gt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new gt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var pt=new gt(1,0,0);gt.prototype;function Er(e){e.stopImmediatePropagation()}function nn(e){e.preventDefault(),e.stopImmediatePropagation()}function Qd(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Jd(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Uo(){return this.__zoom||pt}function ef(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function tf(){return navigator.maxTouchPoints||"ontouchstart"in this}function nf(e,t,r){var o=e.invertX(t[0][0])-r[0][0],n=e.invertX(t[1][0])-r[1][0],i=e.invertY(t[0][1])-r[0][1],s=e.invertY(t[1][1])-r[1][1];return e.translate(n>o?(o+n)/2:Math.min(0,o)||Math.max(0,n),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function ds(){var e=Qd,t=Jd,r=nf,o=ef,n=tf,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],l=250,d=Wu,f=ir("start","zoom","end"),a,c,u,h=500,x=150,v=0,I=10;function p(m){m.property("__zoom",Uo).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",w).on("dblclick.zoom",M).filter(n).on("touchstart.zoom",j).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(m,C,y,b){var W=m.selection?m.selection():m;W.property("__zoom",Uo),m!==W?D(m,C,y,b):W.interrupt().each(function(){E(this,arguments).event(b).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},p.scaleBy=function(m,C,y,b){p.scaleTo(m,function(){var W=this.__zoom.k,N=typeof C=="function"?C.apply(this,arguments):C;return W*N},y,b)},p.scaleTo=function(m,C,y,b){p.transform(m,function(){var W=t.apply(this,arguments),N=this.__zoom,R=y==null?_(W):typeof y=="function"?y.apply(this,arguments):y,O=N.invert(R),U=typeof C=="function"?C.apply(this,arguments):C;return r(k(A(N,U),R,O),W,s)},y,b)},p.translateBy=function(m,C,y,b){p.transform(m,function(){return r(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof y=="function"?y.apply(this,arguments):y),t.apply(this,arguments),s)},null,b)},p.translateTo=function(m,C,y,b,W){p.transform(m,function(){var N=t.apply(this,arguments),R=this.__zoom,O=b==null?_(N):typeof b=="function"?b.apply(this,arguments):b;return r(pt.translate(O[0],O[1]).scale(R.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof y=="function"?-y.apply(this,arguments):-y),N,s)},b,W)};function A(m,C){return C=Math.max(i[0],Math.min(i[1],C)),C===m.k?m:new gt(C,m.x,m.y)}function k(m,C,y){var b=C[0]-y[0]*m.k,W=C[1]-y[1]*m.k;return b===m.x&&W===m.y?m:new gt(m.k,b,W)}function _(m){return[(+m[0][0]+ +m[1][0])/2,(+m[0][1]+ +m[1][1])/2]}function D(m,C,y,b){m.on("start.zoom",function(){E(this,arguments).event(b).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(b).end()}).tween("zoom",function(){var W=this,N=arguments,R=E(W,N).event(b),O=t.apply(W,N),U=y==null?_(O):typeof y=="function"?y.apply(W,N):y,X=Math.max(O[1][0]-O[0][0],O[1][1]-O[0][1]),L=W.__zoom,H=typeof C=="function"?C.apply(W,N):C,G=d(L.invert(U).concat(X/L.k),H.invert(U).concat(X/H.k));return function(ee){if(ee===1)ee=H;else{var ne=G(ee),J=X/ne[2];ee=new gt(J,U[0]-ne[0]*J,U[1]-ne[1]*J)}R.zoom(null,ee)}})}function E(m,C,y){return!y&&m.__zooming||new z(m,C)}function z(m,C){this.that=m,this.args=C,this.active=0,this.sourceEvent=null,this.extent=t.apply(m,C),this.taps=0}z.prototype={event:function(m){return m&&(this.sourceEvent=m),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(m,C){return this.mouse&&m!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&m!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&m!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(m){var C=qe(this.that).datum();f.call(m,this.that,new Kd(m,{sourceEvent:this.sourceEvent,target:p,transform:this.that.__zoom,dispatch:f}),C)}};function S(m,...C){if(!e.apply(this,arguments))return;var y=E(this,C).event(m),b=this.__zoom,W=Math.max(i[0],Math.min(i[1],b.k*Math.pow(2,o.apply(this,arguments)))),N=tt(m);if(y.wheel)(y.mouse[0][0]!==N[0]||y.mouse[0][1]!==N[1])&&(y.mouse[1]=b.invert(y.mouse[0]=N)),clearTimeout(y.wheel);else{if(b.k===W)return;y.mouse=[N,b.invert(N)],Fn(this),y.start()}nn(m),y.wheel=setTimeout(R,x),y.zoom("mouse",r(k(A(b,W),y.mouse[0],y.mouse[1]),y.extent,s));function R(){y.wheel=null,y.end()}}function w(m,...C){if(u||!e.apply(this,arguments))return;var y=m.currentTarget,b=E(this,C,!0).event(m),W=qe(m.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",X,!0),N=tt(m,y),R=m.clientX,O=m.clientY;Zi(m.view),Er(m),b.mouse=[N,this.__zoom.invert(N)],Fn(this),b.start();function U(L){if(nn(L),!b.moved){var H=L.clientX-R,G=L.clientY-O;b.moved=H*H+G*G>v}b.event(L).zoom("mouse",r(k(b.that.__zoom,b.mouse[0]=tt(L,y),b.mouse[1]),b.extent,s))}function X(L){W.on("mousemove.zoom mouseup.zoom",null),Ki(L.view,b.moved),nn(L),b.event(L).end()}}function M(m,...C){if(e.apply(this,arguments)){var y=this.__zoom,b=tt(m.changedTouches?m.changedTouches[0]:m,this),W=y.invert(b),N=y.k*(m.shiftKey?.5:2),R=r(k(A(y,N),b,W),t.apply(this,C),s);nn(m),l>0?qe(this).transition().duration(l).call(D,R,b,m):qe(this).call(p.transform,R,b,m)}}function j(m,...C){if(e.apply(this,arguments)){var y=m.touches,b=y.length,W=E(this,C,m.changedTouches.length===b).event(m),N,R,O,U;for(Er(m),R=0;R<b;++R)O=y[R],U=tt(O,this),U=[U,this.__zoom.invert(U),O.identifier],W.touch0?!W.touch1&&W.touch0[2]!==U[2]&&(W.touch1=U,W.taps=0):(W.touch0=U,N=!0,W.taps=1+!!a);a&&(a=clearTimeout(a)),N&&(W.taps<2&&(c=U[0],a=setTimeout(function(){a=null},h)),Fn(this),W.start())}}function T(m,...C){if(this.__zooming){var y=E(this,C).event(m),b=m.changedTouches,W=b.length,N,R,O,U;for(nn(m),N=0;N<W;++N)R=b[N],O=tt(R,this),y.touch0&&y.touch0[2]===R.identifier?y.touch0[0]=O:y.touch1&&y.touch1[2]===R.identifier&&(y.touch1[0]=O);if(R=y.that.__zoom,y.touch1){var X=y.touch0[0],L=y.touch0[1],H=y.touch1[0],G=y.touch1[1],ee=(ee=H[0]-X[0])*ee+(ee=H[1]-X[1])*ee,ne=(ne=G[0]-L[0])*ne+(ne=G[1]-L[1])*ne;R=A(R,Math.sqrt(ee/ne)),O=[(X[0]+H[0])/2,(X[1]+H[1])/2],U=[(L[0]+G[0])/2,(L[1]+G[1])/2]}else if(y.touch0)O=y.touch0[0],U=y.touch0[1];else return;y.zoom("touch",r(k(R,O,U),y.extent,s))}}function F(m,...C){if(this.__zooming){var y=E(this,C).event(m),b=m.changedTouches,W=b.length,N,R;for(Er(m),u&&clearTimeout(u),u=setTimeout(function(){u=null},h),N=0;N<W;++N)R=b[N],y.touch0&&y.touch0[2]===R.identifier?delete y.touch0:y.touch1&&y.touch1[2]===R.identifier&&delete y.touch1;if(y.touch1&&!y.touch0&&(y.touch0=y.touch1,delete y.touch1),y.touch0)y.touch0[1]=this.__zoom.invert(y.touch0[0]);else if(y.end(),y.taps===2&&(R=tt(R,this),Math.hypot(c[0]-R[0],c[1]-R[1])<I)){var O=qe(this).on("dblclick.zoom");O&&O.apply(this,arguments)}}}return p.wheelDelta=function(m){return arguments.length?(o=typeof m=="function"?m:kn(+m),p):o},p.filter=function(m){return arguments.length?(e=typeof m=="function"?m:kn(!!m),p):e},p.touchable=function(m){return arguments.length?(n=typeof m=="function"?m:kn(!!m),p):n},p.extent=function(m){return arguments.length?(t=typeof m=="function"?m:kn([[+m[0][0],+m[0][1]],[+m[1][0],+m[1][1]]]),p):t},p.scaleExtent=function(m){return arguments.length?(i[0]=+m[0],i[1]=+m[1],p):[i[0],i[1]]},p.translateExtent=function(m){return arguments.length?(s[0][0]=+m[0][0],s[1][0]=+m[1][0],s[0][1]=+m[0][1],s[1][1]=+m[1][1],p):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},p.constrain=function(m){return arguments.length?(r=m,p):r},p.duration=function(m){return arguments.length?(l=+m,p):l},p.interpolate=function(m){return arguments.length?(d=m,p):d},p.on=function(){var m=f.on.apply(f,arguments);return m===f?p:m},p.clickDistance=function(m){return arguments.length?(v=(m=+m)*m,p):Math.sqrt(v)},p.tapDistance=function(m){return arguments.length?(I=+m,p):I},p}const cr=P.createContext(null),rf=cr.Provider,xt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},fs=xt.error001();function xe(e,t){const r=P.useContext(cr);if(r===null)throw new Error(fs);return Ri(r,e,t)}const ke=()=>{const e=P.useContext(cr);if(e===null)throw new Error(fs);return P.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},of=e=>e.userSelectionActive?"none":"all";function ur({position:e,children:t,className:r,style:o,...n}){const i=xe(of),s=`${e}`.split("-");return V.createElement("div",{className:De(["react-flow__panel",r,...s]),style:{...o,pointerEvents:i},...n},t)}function sf({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:V.createElement(ur,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},V.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const af=({x:e,y:t,label:r,labelStyle:o={},labelShowBg:n=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:l=2,children:d,className:f,...a})=>{const c=P.useRef(null),[u,h]=P.useState({x:0,y:0,width:0,height:0}),x=De(["react-flow__edge-textwrapper",f]);return P.useEffect(()=>{if(c.current){const v=c.current.getBBox();h({x:v.x,y:v.y,width:v.width,height:v.height})}},[r]),typeof r>"u"||!r?null:V.createElement("g",{transform:`translate(${e-u.width/2} ${t-u.height/2})`,className:x,visibility:u.width?"visible":"hidden",...a},n&&V.createElement("rect",{width:u.width+2*s[0],x:-s[0],y:-s[1],height:u.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:l,ry:l}),V.createElement("text",{className:"react-flow__edge-text",y:u.height/2,dy:"0.3em",ref:c,style:o},r),d)};var lf=P.memo(af);const to=e=>({width:e.offsetWidth,height:e.offsetHeight}),Kt=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),no=(e={x:0,y:0},t)=>({x:Kt(e.x,t[0][0],t[1][0]),y:Kt(e.y,t[0][1],t[1][1])}),Bo=(e,t,r)=>e<t?Kt(Math.abs(e-t),1,50)/50:e>r?-Kt(Math.abs(e-r),1,50)/50:0,hs=(e,t)=>{const r=Bo(e.x,35,t.width-35)*20,o=Bo(e.y,35,t.height-35)*20;return[r,o]},gs=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},ps=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),mn=({x:e,y:t,width:r,height:o})=>({x:e,y:t,x2:e+r,y2:t+o}),ms=({x:e,y:t,x2:r,y2:o})=>({x:e,y:t,width:r-e,height:o-t}),Lo=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),cf=(e,t)=>ms(ps(mn(e),mn(t))),Hr=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*o)},uf=e=>Ge(e.width)&&Ge(e.height)&&Ge(e.x)&&Ge(e.y),Ge=e=>!isNaN(e)&&isFinite(e),Ce=Symbol.for("internals"),xs=["Enter"," ","Escape"],df=(e,t)=>{},ff=e=>"nativeEvent"in e;function Ur(e){var n,i;const t=ff(e)?e.nativeEvent:e,r=((i=(n=t.composedPath)==null?void 0:n.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const ys=e=>"clientX"in e,Et=(e,t)=>{var i,s;const r=ys(e),o=r?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,n=r?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:n-((t==null?void 0:t.top)??0)}},Zn=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Sn=({id:e,path:t,labelX:r,labelY:o,label:n,labelStyle:i,labelShowBg:s,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:a,markerEnd:c,markerStart:u,interactionWidth:h=20})=>V.createElement(V.Fragment,null,V.createElement("path",{id:e,style:a,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:c,markerStart:u}),h&&V.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),n&&Ge(r)&&Ge(o)?V.createElement(lf,{x:r,y:o,label:n,labelStyle:i,labelShowBg:s,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f}):null);Sn.displayName="BaseEdge";function rn(e,t,r){return r===void 0?r:o=>{const n=t().edges.find(i=>i.id===e);n&&r(o,{...n})}}function bs({sourceX:e,sourceY:t,targetX:r,targetY:o}){const n=Math.abs(r-e)/2,i=r<e?r+n:r-n,s=Math.abs(o-t)/2,l=o<t?o+s:o-s;return[i,l,n,s]}function vs({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:n,sourceControlY:i,targetControlX:s,targetControlY:l}){const d=e*.125+n*.375+s*.375+r*.125,f=t*.125+i*.375+l*.375+o*.125,a=Math.abs(d-e),c=Math.abs(f-t);return[d,f,a,c]}var At;(function(e){e.Strict="strict",e.Loose="loose"})(At||(At={}));var Mt;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Mt||(Mt={}));var xn;(function(e){e.Partial="partial",e.Full="full"})(xn||(xn={}));var St;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(St||(St={}));var Kn;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Kn||(Kn={}));var re;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(re||(re={}));function Oo({pos:e,x1:t,y1:r,x2:o,y2:n}){return e===re.Left||e===re.Right?[.5*(t+o),r]:[t,.5*(r+n)]}function ws({sourceX:e,sourceY:t,sourcePosition:r=re.Bottom,targetX:o,targetY:n,targetPosition:i=re.Top}){const[s,l]=Oo({pos:r,x1:e,y1:t,x2:o,y2:n}),[d,f]=Oo({pos:i,x1:o,y1:n,x2:e,y2:t}),[a,c,u,h]=vs({sourceX:e,sourceY:t,targetX:o,targetY:n,sourceControlX:s,sourceControlY:l,targetControlX:d,targetControlY:f});return[`M${e},${t} C${s},${l} ${d},${f} ${o},${n}`,a,c,u,h]}const ro=P.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,sourcePosition:n=re.Bottom,targetPosition:i=re.Top,label:s,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:a,labelBgBorderRadius:c,style:u,markerEnd:h,markerStart:x,interactionWidth:v})=>{const[I,p,A]=ws({sourceX:e,sourceY:t,sourcePosition:n,targetX:r,targetY:o,targetPosition:i});return V.createElement(Sn,{path:I,labelX:p,labelY:A,label:s,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:a,labelBgBorderRadius:c,style:u,markerEnd:h,markerStart:x,interactionWidth:v})});ro.displayName="SimpleBezierEdge";const Vo={[re.Left]:{x:-1,y:0},[re.Right]:{x:1,y:0},[re.Top]:{x:0,y:-1},[re.Bottom]:{x:0,y:1}},hf=({source:e,sourcePosition:t=re.Bottom,target:r})=>t===re.Left||t===re.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Yo=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function gf({source:e,sourcePosition:t=re.Bottom,target:r,targetPosition:o=re.Top,center:n,offset:i}){const s=Vo[t],l=Vo[o],d={x:e.x+s.x*i,y:e.y+s.y*i},f={x:r.x+l.x*i,y:r.y+l.y*i},a=hf({source:d,sourcePosition:t,target:f}),c=a.x!==0?"x":"y",u=a[c];let h=[],x,v;const I={x:0,y:0},p={x:0,y:0},[A,k,_,D]=bs({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(s[c]*l[c]===-1){x=n.x??A,v=n.y??k;const z=[{x,y:d.y},{x,y:f.y}],S=[{x:d.x,y:v},{x:f.x,y:v}];s[c]===u?h=c==="x"?z:S:h=c==="x"?S:z}else{const z=[{x:d.x,y:f.y}],S=[{x:f.x,y:d.y}];if(c==="x"?h=s.x===u?S:z:h=s.y===u?z:S,t===o){const F=Math.abs(e[c]-r[c]);if(F<=i){const m=Math.min(i-1,i-F);s[c]===u?I[c]=(d[c]>e[c]?-1:1)*m:p[c]=(f[c]>r[c]?-1:1)*m}}if(t!==o){const F=c==="x"?"y":"x",m=s[c]===l[F],C=d[F]>f[F],y=d[F]<f[F];(s[c]===1&&(!m&&C||m&&y)||s[c]!==1&&(!m&&y||m&&C))&&(h=c==="x"?z:S)}const w={x:d.x+I.x,y:d.y+I.y},M={x:f.x+p.x,y:f.y+p.y},j=Math.max(Math.abs(w.x-h[0].x),Math.abs(M.x-h[0].x)),T=Math.max(Math.abs(w.y-h[0].y),Math.abs(M.y-h[0].y));j>=T?(x=(w.x+M.x)/2,v=h[0].y):(x=h[0].x,v=(w.y+M.y)/2)}return[[e,{x:d.x+I.x,y:d.y+I.y},...h,{x:f.x+p.x,y:f.y+p.y},r],x,v,_,D]}function pf(e,t,r,o){const n=Math.min(Yo(e,t)/2,Yo(t,r)/2,o),{x:i,y:s}=t;if(e.x===i&&i===r.x||e.y===s&&s===r.y)return`L${i} ${s}`;if(e.y===s){const f=e.x<r.x?-1:1,a=e.y<r.y?1:-1;return`L ${i+n*f},${s}Q ${i},${s} ${i},${s+n*a}`}const l=e.x<r.x?1:-1,d=e.y<r.y?-1:1;return`L ${i},${s+n*d}Q ${i},${s} ${i+n*l},${s}`}function Br({sourceX:e,sourceY:t,sourcePosition:r=re.Bottom,targetX:o,targetY:n,targetPosition:i=re.Top,borderRadius:s=5,centerX:l,centerY:d,offset:f=20}){const[a,c,u,h,x]=gf({source:{x:e,y:t},sourcePosition:r,target:{x:o,y:n},targetPosition:i,center:{x:l,y:d},offset:f});return[a.reduce((I,p,A)=>{let k="";return A>0&&A<a.length-1?k=pf(a[A-1],p,a[A+1],s):k=`${A===0?"M":"L"}${p.x} ${p.y}`,I+=k,I},""),c,u,h,x]}const dr=P.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,label:n,labelStyle:i,labelShowBg:s,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:a,sourcePosition:c=re.Bottom,targetPosition:u=re.Top,markerEnd:h,markerStart:x,pathOptions:v,interactionWidth:I})=>{const[p,A,k]=Br({sourceX:e,sourceY:t,sourcePosition:c,targetX:r,targetY:o,targetPosition:u,borderRadius:v==null?void 0:v.borderRadius,offset:v==null?void 0:v.offset});return V.createElement(Sn,{path:p,labelX:A,labelY:k,label:n,labelStyle:i,labelShowBg:s,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:a,markerEnd:h,markerStart:x,interactionWidth:I})});dr.displayName="SmoothStepEdge";const oo=P.memo(e=>{var t;return V.createElement(dr,{...e,pathOptions:P.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});oo.displayName="StepEdge";function mf({sourceX:e,sourceY:t,targetX:r,targetY:o}){const[n,i,s,l]=bs({sourceX:e,sourceY:t,targetX:r,targetY:o});return[`M ${e},${t}L ${r},${o}`,n,i,s,l]}const io=P.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,label:n,labelStyle:i,labelShowBg:s,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:a,markerEnd:c,markerStart:u,interactionWidth:h})=>{const[x,v,I]=mf({sourceX:e,sourceY:t,targetX:r,targetY:o});return V.createElement(Sn,{path:x,labelX:v,labelY:I,label:n,labelStyle:i,labelShowBg:s,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:a,markerEnd:c,markerStart:u,interactionWidth:h})});io.displayName="StraightEdge";function Nn(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Xo({pos:e,x1:t,y1:r,x2:o,y2:n,c:i}){switch(e){case re.Left:return[t-Nn(t-o,i),r];case re.Right:return[t+Nn(o-t,i),r];case re.Top:return[t,r-Nn(r-n,i)];case re.Bottom:return[t,r+Nn(n-r,i)]}}function Ss({sourceX:e,sourceY:t,sourcePosition:r=re.Bottom,targetX:o,targetY:n,targetPosition:i=re.Top,curvature:s=.25}){const[l,d]=Xo({pos:r,x1:e,y1:t,x2:o,y2:n,c:s}),[f,a]=Xo({pos:i,x1:o,y1:n,x2:e,y2:t,c:s}),[c,u,h,x]=vs({sourceX:e,sourceY:t,targetX:o,targetY:n,sourceControlX:l,sourceControlY:d,targetControlX:f,targetControlY:a});return[`M${e},${t} C${l},${d} ${f},${a} ${o},${n}`,c,u,h,x]}const Qn=P.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,sourcePosition:n=re.Bottom,targetPosition:i=re.Top,label:s,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:a,labelBgBorderRadius:c,style:u,markerEnd:h,markerStart:x,pathOptions:v,interactionWidth:I})=>{const[p,A,k]=Ss({sourceX:e,sourceY:t,sourcePosition:n,targetX:r,targetY:o,targetPosition:i,curvature:v==null?void 0:v.curvature});return V.createElement(Sn,{path:p,labelX:A,labelY:k,label:s,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:a,labelBgBorderRadius:c,style:u,markerEnd:h,markerStart:x,interactionWidth:I})});Qn.displayName="BezierEdge";const so=P.createContext(null),xf=so.Provider;so.Consumer;const yf=()=>P.useContext(so),bf=e=>"id"in e&&"source"in e&&"target"in e,vf=({source:e,sourceHandle:t,target:r,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${r}${o||""}`,Lr=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,wf=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),Sf=(e,t)=>{if(!e.source||!e.target)return t;let r;return bf(e)?r={...e}:r={...e,id:vf(e)},wf(r,t)?t:t.concat(r)},Or=({x:e,y:t},[r,o,n],i,[s,l])=>{const d={x:(e-r)/n,y:(t-o)/n};return i?{x:s*Math.round(d.x/s),y:l*Math.round(d.y/l)}:d},Es=({x:e,y:t},[r,o,n])=>({x:e*n+r,y:t*n+o}),Dt=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],o=(e.height??0)*t[1],n={x:e.position.x-r,y:e.position.y-o};return{...n,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-o}:n}},fr=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((o,n)=>{const{x:i,y:s}=Dt(n,t).positionAbsolute;return ps(o,mn({x:i,y:s,width:n.width||0,height:n.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return ms(r)},Cs=(e,t,[r,o,n]=[0,0,1],i=!1,s=!1,l=[0,0])=>{const d={x:(t.x-r)/n,y:(t.y-o)/n,width:t.width/n,height:t.height/n},f=[];return e.forEach(a=>{const{width:c,height:u,selectable:h=!0,hidden:x=!1}=a;if(s&&!h||x)return!1;const{positionAbsolute:v}=Dt(a,l),I={x:v.x,y:v.y,width:c||0,height:u||0},p=Hr(d,I),A=typeof c>"u"||typeof u>"u"||c===null||u===null,k=i&&p>0,_=(c||0)*(u||0);(A||k||p>=_||a.dragging)&&f.push(a)}),f},_s=(e,t)=>{const r=e.map(o=>o.id);return t.filter(o=>r.includes(o.source)||r.includes(o.target))},Is=(e,t,r,o,n,i=.1)=>{const s=t/(e.width*(1+i)),l=r/(e.height*(1+i)),d=Math.min(s,l),f=Kt(d,o,n),a=e.x+e.width/2,c=e.y+e.height/2,u=t/2-a*f,h=r/2-c*f;return{x:u,y:h,zoom:f}},Nt=(e,t=0)=>e.transition().duration(t);function qo(e,t,r,o){return(t[r]||[]).reduce((n,i)=>{var s,l;return`${e.id}-${i.id}-${r}`!==o&&n.push({id:i.id||null,type:r,nodeId:e.id,x:(((s=e.positionAbsolute)==null?void 0:s.x)??0)+i.x+i.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+i.y+i.height/2}),n},[])}function Ef(e,t,r,o,n,i){const{x:s,y:l}=Et(e),f=t.elementsFromPoint(s,l).find(x=>x.classList.contains("react-flow__handle"));if(f){const x=f.getAttribute("data-nodeid");if(x){const v=ao(void 0,f),I=f.getAttribute("data-handleid"),p=i({nodeId:x,id:I,type:v});if(p){const A=n.find(k=>k.nodeId===x&&k.type===v&&k.id===I);return{handle:{id:I,type:v,nodeId:x,x:(A==null?void 0:A.x)||r.x,y:(A==null?void 0:A.y)||r.y},validHandleResult:p}}}}let a=[],c=1/0;if(n.forEach(x=>{const v=Math.sqrt((x.x-r.x)**2+(x.y-r.y)**2);if(v<=o){const I=i(x);v<=c&&(v<c?a=[{handle:x,validHandleResult:I}]:v===c&&a.push({handle:x,validHandleResult:I}),c=v)}}),!a.length)return{handle:null,validHandleResult:As()};if(a.length===1)return a[0];const u=a.some(({validHandleResult:x})=>x.isValid),h=a.some(({handle:x})=>x.type==="target");return a.find(({handle:x,validHandleResult:v})=>h?x.type==="target":u?v.isValid:!0)||a[0]}const Cf={source:null,target:null,sourceHandle:null,targetHandle:null},As=()=>({handleDomNode:null,isValid:!1,connection:Cf,endHandle:null});function ks(e,t,r,o,n,i,s){const l=n==="target",d=s.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),f={...As(),handleDomNode:d};if(d){const a=ao(void 0,d),c=d.getAttribute("data-nodeid"),u=d.getAttribute("data-handleid"),h=d.classList.contains("connectable"),x=d.classList.contains("connectableend"),v={source:l?c:r,sourceHandle:l?u:o,target:l?r:c,targetHandle:l?o:u};f.connection=v,h&&x&&(t===At.Strict?l&&a==="source"||!l&&a==="target":c!==r||u!==o)&&(f.endHandle={nodeId:c,handleId:u,type:a},f.isValid=i(v))}return f}function _f({nodes:e,nodeId:t,handleId:r,handleType:o}){return e.reduce((n,i)=>{if(i[Ce]){const{handleBounds:s}=i[Ce];let l=[],d=[];s&&(l=qo(i,s,"source",`${t}-${r}-${o}`),d=qo(i,s,"target",`${t}-${r}-${o}`)),n.push(...l,...d)}return n},[])}function ao(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Cr(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function If(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function Ns({event:e,handleId:t,nodeId:r,onConnect:o,isTarget:n,getState:i,setState:s,isValidConnection:l,edgeUpdaterType:d,onReconnectEnd:f}){const a=gs(e.target),{connectionMode:c,domNode:u,autoPanOnConnect:h,connectionRadius:x,onConnectStart:v,panBy:I,getNodes:p,cancelConnection:A}=i();let k=0,_;const{x:D,y:E}=Et(e),z=a==null?void 0:a.elementFromPoint(D,E),S=ao(d,z),w=u==null?void 0:u.getBoundingClientRect();if(!w||!S)return;let M,j=Et(e,w),T=!1,F=null,m=!1,C=null;const y=_f({nodes:p(),nodeId:r,handleId:t,handleType:S}),b=()=>{if(!h)return;const[R,O]=hs(j,w);I({x:R,y:O}),k=requestAnimationFrame(b)};s({connectionPosition:j,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:S,connectionStartHandle:{nodeId:r,handleId:t,type:S},connectionEndHandle:null}),v==null||v(e,{nodeId:r,handleId:t,handleType:S});function W(R){const{transform:O}=i();j=Et(R,w);const{handle:U,validHandleResult:X}=Ef(R,a,Or(j,O,!1,[1,1]),x,y,L=>ks(L,c,r,t,n?"target":"source",l,a));if(_=U,T||(b(),T=!0),C=X.handleDomNode,F=X.connection,m=X.isValid,s({connectionPosition:_&&m?Es({x:_.x,y:_.y},O):j,connectionStatus:If(!!_,m),connectionEndHandle:X.endHandle}),!_&&!m&&!C)return Cr(M);F.source!==F.target&&C&&(Cr(M),M=C,C.classList.add("connecting","react-flow__handle-connecting"),C.classList.toggle("valid",m),C.classList.toggle("react-flow__handle-valid",m))}function N(R){var O,U;(_||C)&&F&&m&&(o==null||o(F)),(U=(O=i()).onConnectEnd)==null||U.call(O,R),d&&(f==null||f(R)),Cr(M),A(),cancelAnimationFrame(k),T=!1,m=!1,F=null,C=null,a.removeEventListener("mousemove",W),a.removeEventListener("mouseup",N),a.removeEventListener("touchmove",W),a.removeEventListener("touchend",N)}a.addEventListener("mousemove",W),a.addEventListener("mouseup",N),a.addEventListener("touchmove",W),a.addEventListener("touchend",N)}const Go=()=>!0,Af=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),kf=(e,t,r)=>o=>{const{connectionStartHandle:n,connectionEndHandle:i,connectionClickStartHandle:s}=o;return{connecting:(n==null?void 0:n.nodeId)===e&&(n==null?void 0:n.handleId)===t&&(n==null?void 0:n.type)===r||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r}},js=P.forwardRef(({type:e="source",position:t=re.Top,isValidConnection:r,isConnectable:o=!0,isConnectableStart:n=!0,isConnectableEnd:i=!0,id:s,onConnect:l,children:d,className:f,onMouseDown:a,onTouchStart:c,...u},h)=>{var w,M;const x=s||null,v=e==="target",I=ke(),p=yf(),{connectOnClick:A,noPanClassName:k}=xe(Af,Le),{connecting:_,clickConnecting:D}=xe(kf(p,x,e),Le);p||(M=(w=I.getState()).onError)==null||M.call(w,"010",xt.error010());const E=j=>{const{defaultEdgeOptions:T,onConnect:F,hasDefaultEdges:m}=I.getState(),C={...T,...j};if(m){const{edges:y,setEdges:b}=I.getState();b(Sf(C,y))}F==null||F(C),l==null||l(C)},z=j=>{if(!p)return;const T=ys(j);n&&(T&&j.button===0||!T)&&Ns({event:j,handleId:x,nodeId:p,onConnect:E,isTarget:v,getState:I.getState,setState:I.setState,isValidConnection:r||I.getState().isValidConnection||Go}),T?a==null||a(j):c==null||c(j)},S=j=>{const{onClickConnectStart:T,onClickConnectEnd:F,connectionClickStartHandle:m,connectionMode:C,isValidConnection:y}=I.getState();if(!p||!m&&!n)return;if(!m){T==null||T(j,{nodeId:p,handleId:x,handleType:e}),I.setState({connectionClickStartHandle:{nodeId:p,type:e,handleId:x}});return}const b=gs(j.target),W=r||y||Go,{connection:N,isValid:R}=ks({nodeId:p,id:x,type:e},C,m.nodeId,m.handleId||null,m.type,W,b);R&&E(N),F==null||F(j),I.setState({connectionClickStartHandle:null})};return V.createElement("div",{"data-handleid":x,"data-nodeid":p,"data-handlepos":t,"data-id":`${p}-${x}-${e}`,className:De(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",k,f,{source:!v,target:v,connectable:o,connectablestart:n,connectableend:i,connecting:D,connectionindicator:o&&(n&&!_||i&&_)}]),onMouseDown:z,onTouchStart:z,onClick:A?S:void 0,ref:h,...u},d)});js.displayName="Handle";var Qt=P.memo(js);const Ms=({data:e,isConnectable:t,targetPosition:r=re.Top,sourcePosition:o=re.Bottom})=>V.createElement(V.Fragment,null,V.createElement(Qt,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,V.createElement(Qt,{type:"source",position:o,isConnectable:t}));Ms.displayName="DefaultNode";var Vr=P.memo(Ms);const zs=({data:e,isConnectable:t,sourcePosition:r=re.Bottom})=>V.createElement(V.Fragment,null,e==null?void 0:e.label,V.createElement(Qt,{type:"source",position:r,isConnectable:t}));zs.displayName="InputNode";var Ts=P.memo(zs);const Ds=({data:e,isConnectable:t,targetPosition:r=re.Top})=>V.createElement(V.Fragment,null,V.createElement(Qt,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);Ds.displayName="OutputNode";var $s=P.memo(Ds);const lo=()=>null;lo.displayName="GroupNode";const Nf=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),jn=e=>e.id;function jf(e,t){return Le(e.selectedNodes.map(jn),t.selectedNodes.map(jn))&&Le(e.selectedEdges.map(jn),t.selectedEdges.map(jn))}const Fs=P.memo(({onSelectionChange:e})=>{const t=ke(),{selectedNodes:r,selectedEdges:o}=xe(Nf,jf);return P.useEffect(()=>{const n={nodes:r,edges:o};e==null||e(n),t.getState().onSelectionChange.forEach(i=>i(n))},[r,o,e]),null});Fs.displayName="SelectionListener";const Mf=e=>!!e.onSelectionChange;function zf({onSelectionChange:e}){const t=xe(Mf);return e||t?V.createElement(Fs,{onSelectionChange:e}):null}const Tf=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Pt(e,t){P.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function le(e,t,r){P.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const Df=({nodes:e,edges:t,defaultNodes:r,defaultEdges:o,onConnect:n,onConnectStart:i,onConnectEnd:s,onClickConnectStart:l,onClickConnectEnd:d,nodesDraggable:f,nodesConnectable:a,nodesFocusable:c,edgesFocusable:u,edgesUpdatable:h,elevateNodesOnSelect:x,minZoom:v,maxZoom:I,nodeExtent:p,onNodesChange:A,onEdgesChange:k,elementsSelectable:_,connectionMode:D,snapGrid:E,snapToGrid:z,translateExtent:S,connectOnClick:w,defaultEdgeOptions:M,fitView:j,fitViewOptions:T,onNodesDelete:F,onEdgesDelete:m,onNodeDrag:C,onNodeDragStart:y,onNodeDragStop:b,onSelectionDrag:W,onSelectionDragStart:N,onSelectionDragStop:R,noPanClassName:O,nodeOrigin:U,rfId:X,autoPanOnConnect:L,autoPanOnNodeDrag:H,onError:G,connectionRadius:ee,isValidConnection:ne,nodeDragThreshold:J})=>{const{setNodes:te,setEdges:se,setDefaultNodesAndEdges:ae,setMinZoom:ve,setMaxZoom:he,setTranslateExtent:ie,setNodeExtent:de,reset:oe}=xe(Tf,Le),Z=ke();return P.useEffect(()=>{const ue=o==null?void 0:o.map(ye=>({...ye,...M}));return ae(r,ue),()=>{oe()}},[]),le("defaultEdgeOptions",M,Z.setState),le("connectionMode",D,Z.setState),le("onConnect",n,Z.setState),le("onConnectStart",i,Z.setState),le("onConnectEnd",s,Z.setState),le("onClickConnectStart",l,Z.setState),le("onClickConnectEnd",d,Z.setState),le("nodesDraggable",f,Z.setState),le("nodesConnectable",a,Z.setState),le("nodesFocusable",c,Z.setState),le("edgesFocusable",u,Z.setState),le("edgesUpdatable",h,Z.setState),le("elementsSelectable",_,Z.setState),le("elevateNodesOnSelect",x,Z.setState),le("snapToGrid",z,Z.setState),le("snapGrid",E,Z.setState),le("onNodesChange",A,Z.setState),le("onEdgesChange",k,Z.setState),le("connectOnClick",w,Z.setState),le("fitViewOnInit",j,Z.setState),le("fitViewOnInitOptions",T,Z.setState),le("onNodesDelete",F,Z.setState),le("onEdgesDelete",m,Z.setState),le("onNodeDrag",C,Z.setState),le("onNodeDragStart",y,Z.setState),le("onNodeDragStop",b,Z.setState),le("onSelectionDrag",W,Z.setState),le("onSelectionDragStart",N,Z.setState),le("onSelectionDragStop",R,Z.setState),le("noPanClassName",O,Z.setState),le("nodeOrigin",U,Z.setState),le("rfId",X,Z.setState),le("autoPanOnConnect",L,Z.setState),le("autoPanOnNodeDrag",H,Z.setState),le("onError",G,Z.setState),le("connectionRadius",ee,Z.setState),le("isValidConnection",ne,Z.setState),le("nodeDragThreshold",J,Z.setState),Pt(e,te),Pt(t,se),Pt(v,ve),Pt(I,he),Pt(S,ie),Pt(p,de),null},Zo={display:"none"},$f={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Rs="react-flow__node-desc",Ps="react-flow__edge-desc",Ff="react-flow__aria-live",Rf=e=>e.ariaLiveMessage;function Pf({rfId:e}){const t=xe(Rf);return V.createElement("div",{id:`${Ff}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:$f},t)}function Wf({rfId:e,disableKeyboardA11y:t}){return V.createElement(V.Fragment,null,V.createElement("div",{id:`${Rs}-${e}`,style:Zo},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),V.createElement("div",{id:`${Ps}-${e}`,style:Zo},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&V.createElement(Pf,{rfId:e}))}var yn=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,o]=P.useState(!1),n=P.useRef(!1),i=P.useRef(new Set([])),[s,l]=P.useMemo(()=>{if(e!==null){const f=(Array.isArray(e)?e:[e]).filter(c=>typeof c=="string").map(c=>c.split("+")),a=f.reduce((c,u)=>c.concat(...u),[]);return[f,a]}return[[],[]]},[e]);return P.useEffect(()=>{const d=typeof document<"u"?document:null,f=(t==null?void 0:t.target)||d;if(e!==null){const a=h=>{if(n.current=h.ctrlKey||h.metaKey||h.shiftKey,(!n.current||n.current&&!t.actInsideInputWithModifier)&&Ur(h))return!1;const v=Qo(h.code,l);i.current.add(h[v]),Ko(s,i.current,!1)&&(h.preventDefault(),o(!0))},c=h=>{if((!n.current||n.current&&!t.actInsideInputWithModifier)&&Ur(h))return!1;const v=Qo(h.code,l);Ko(s,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(h[v]),h.key==="Meta"&&i.current.clear(),n.current=!1},u=()=>{i.current.clear(),o(!1)};return f==null||f.addEventListener("keydown",a),f==null||f.addEventListener("keyup",c),window.addEventListener("blur",u),()=>{f==null||f.removeEventListener("keydown",a),f==null||f.removeEventListener("keyup",c),window.removeEventListener("blur",u)}}},[e,o]),r};function Ko(e,t,r){return e.filter(o=>r||o.length===t.size).some(o=>o.every(n=>t.has(n)))}function Qo(e,t){return t.includes(e)?"code":"key"}function Ws(e,t,r,o){var l,d;const n=e.parentNode||e.parentId;if(!n)return r;const i=t.get(n),s=Dt(i,o);return Ws(i,t,{x:(r.x??0)+s.x,y:(r.y??0)+s.y,z:(((l=i[Ce])==null?void 0:l.z)??0)>(r.z??0)?((d=i[Ce])==null?void 0:d.z)??0:r.z??0},o)}function Hs(e,t,r){e.forEach(o=>{var i;const n=o.parentNode||o.parentId;if(n&&!e.has(n))throw new Error(`Parent node ${n} not found`);if(n||r!=null&&r[o.id]){const{x:s,y:l,z:d}=Ws(o,e,{...o.position,z:((i=o[Ce])==null?void 0:i.z)??0},t);o.positionAbsolute={x:s,y:l},o[Ce].z=d,r!=null&&r[o.id]&&(o[Ce].isParent=!0)}})}function _r(e,t,r,o){const n=new Map,i={},s=o?1e3:0;return e.forEach(l=>{var h;const d=(Ge(l.zIndex)?l.zIndex:0)+(l.selected?s:0),f=t.get(l.id),a={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},c=l.parentNode||l.parentId;c&&(i[c]=!0);const u=(f==null?void 0:f.type)&&(f==null?void 0:f.type)!==l.type;Object.defineProperty(a,Ce,{enumerable:!1,value:{handleBounds:u||(h=f==null?void 0:f[Ce])==null?void 0:h.handleBounds,z:d}}),n.set(l.id,a)}),Hs(n,r,i),n}function Us(e,t={}){const{getNodes:r,width:o,height:n,minZoom:i,maxZoom:s,d3Zoom:l,d3Selection:d,fitViewOnInitDone:f,fitViewOnInit:a,nodeOrigin:c}=e(),u=t.initial&&!f&&a;if(l&&d&&(u||!t.initial)){const x=r().filter(I=>{var A;const p=t.includeHiddenNodes?I.width&&I.height:!I.hidden;return(A=t.nodes)!=null&&A.length?p&&t.nodes.some(k=>k.id===I.id):p}),v=x.every(I=>I.width&&I.height);if(x.length>0&&v){const I=fr(x,c),{x:p,y:A,zoom:k}=Is(I,o,n,t.minZoom??i,t.maxZoom??s,t.padding??.1),_=pt.translate(p,A).scale(k);return typeof t.duration=="number"&&t.duration>0?l.transform(Nt(d,t.duration),_):l.transform(d,_),!0}}return!1}function Hf(e,t){return e.forEach(r=>{const o=t.get(r.id);o&&t.set(o.id,{...o,[Ce]:o[Ce],selected:r.selected})}),new Map(t)}function Uf(e,t){return t.map(r=>{const o=e.find(n=>n.id===r.id);return o&&(r.selected=o.selected),r})}function Mn({changedNodes:e,changedEdges:t,get:r,set:o}){const{nodeInternals:n,edges:i,onNodesChange:s,onEdgesChange:l,hasDefaultNodes:d,hasDefaultEdges:f}=r();e!=null&&e.length&&(d&&o({nodeInternals:Hf(e,n)}),s==null||s(e)),t!=null&&t.length&&(f&&o({edges:Uf(t,i)}),l==null||l(t))}const Wt=()=>{},Bf={zoomIn:Wt,zoomOut:Wt,zoomTo:Wt,getZoom:()=>1,setViewport:Wt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Wt,fitBounds:Wt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Lf=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Of=()=>{const e=ke(),{d3Zoom:t,d3Selection:r}=xe(Lf,Le);return P.useMemo(()=>r&&t?{zoomIn:n=>t.scaleBy(Nt(r,n==null?void 0:n.duration),1.2),zoomOut:n=>t.scaleBy(Nt(r,n==null?void 0:n.duration),1/1.2),zoomTo:(n,i)=>t.scaleTo(Nt(r,i==null?void 0:i.duration),n),getZoom:()=>e.getState().transform[2],setViewport:(n,i)=>{const[s,l,d]=e.getState().transform,f=pt.translate(n.x??s,n.y??l).scale(n.zoom??d);t.transform(Nt(r,i==null?void 0:i.duration),f)},getViewport:()=>{const[n,i,s]=e.getState().transform;return{x:n,y:i,zoom:s}},fitView:n=>Us(e.getState,n),setCenter:(n,i,s)=>{const{width:l,height:d,maxZoom:f}=e.getState(),a=typeof(s==null?void 0:s.zoom)<"u"?s.zoom:f,c=l/2-n*a,u=d/2-i*a,h=pt.translate(c,u).scale(a);t.transform(Nt(r,s==null?void 0:s.duration),h)},fitBounds:(n,i)=>{const{width:s,height:l,minZoom:d,maxZoom:f}=e.getState(),{x:a,y:c,zoom:u}=Is(n,s,l,d,f,(i==null?void 0:i.padding)??.1),h=pt.translate(a,c).scale(u);t.transform(Nt(r,i==null?void 0:i.duration),h)},project:n=>{const{transform:i,snapToGrid:s,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Or(n,i,s,l)},screenToFlowPosition:n=>{const{transform:i,snapToGrid:s,snapGrid:l,domNode:d}=e.getState();if(!d)return n;const{x:f,y:a}=d.getBoundingClientRect(),c={x:n.x-f,y:n.y-a};return Or(c,i,s,l)},flowToScreenPosition:n=>{const{transform:i,domNode:s}=e.getState();if(!s)return n;const{x:l,y:d}=s.getBoundingClientRect(),f=Es(n,i);return{x:f.x+l,y:f.y+d}},viewportInitialized:!0}:Bf,[t,r])};function co(){const e=Of(),t=ke(),r=P.useCallback(()=>t.getState().getNodes().map(v=>({...v})),[]),o=P.useCallback(v=>t.getState().nodeInternals.get(v),[]),n=P.useCallback(()=>{const{edges:v=[]}=t.getState();return v.map(I=>({...I}))},[]),i=P.useCallback(v=>{const{edges:I=[]}=t.getState();return I.find(p=>p.id===v)},[]),s=P.useCallback(v=>{const{getNodes:I,setNodes:p,hasDefaultNodes:A,onNodesChange:k}=t.getState(),_=I(),D=typeof v=="function"?v(_):v;if(A)p(D);else if(k){const E=D.length===0?_.map(z=>({type:"remove",id:z.id})):D.map(z=>({item:z,type:"reset"}));k(E)}},[]),l=P.useCallback(v=>{const{edges:I=[],setEdges:p,hasDefaultEdges:A,onEdgesChange:k}=t.getState(),_=typeof v=="function"?v(I):v;if(A)p(_);else if(k){const D=_.length===0?I.map(E=>({type:"remove",id:E.id})):_.map(E=>({item:E,type:"reset"}));k(D)}},[]),d=P.useCallback(v=>{const I=Array.isArray(v)?v:[v],{getNodes:p,setNodes:A,hasDefaultNodes:k,onNodesChange:_}=t.getState();if(k){const E=[...p(),...I];A(E)}else if(_){const D=I.map(E=>({item:E,type:"add"}));_(D)}},[]),f=P.useCallback(v=>{const I=Array.isArray(v)?v:[v],{edges:p=[],setEdges:A,hasDefaultEdges:k,onEdgesChange:_}=t.getState();if(k)A([...p,...I]);else if(_){const D=I.map(E=>({item:E,type:"add"}));_(D)}},[]),a=P.useCallback(()=>{const{getNodes:v,edges:I=[],transform:p}=t.getState(),[A,k,_]=p;return{nodes:v().map(D=>({...D})),edges:I.map(D=>({...D})),viewport:{x:A,y:k,zoom:_}}},[]),c=P.useCallback(({nodes:v,edges:I})=>{const{nodeInternals:p,getNodes:A,edges:k,hasDefaultNodes:_,hasDefaultEdges:D,onNodesDelete:E,onEdgesDelete:z,onNodesChange:S,onEdgesChange:w}=t.getState(),M=(v||[]).map(C=>C.id),j=(I||[]).map(C=>C.id),T=A().reduce((C,y)=>{const b=y.parentNode||y.parentId,W=!M.includes(y.id)&&b&&C.find(R=>R.id===b);return(typeof y.deletable=="boolean"?y.deletable:!0)&&(M.includes(y.id)||W)&&C.push(y),C},[]),F=k.filter(C=>typeof C.deletable=="boolean"?C.deletable:!0),m=F.filter(C=>j.includes(C.id));if(T||m){const C=_s(T,F),y=[...m,...C],b=y.reduce((W,N)=>(W.includes(N.id)||W.push(N.id),W),[]);if((D||_)&&(D&&t.setState({edges:k.filter(W=>!b.includes(W.id))}),_&&(T.forEach(W=>{p.delete(W.id)}),t.setState({nodeInternals:new Map(p)}))),b.length>0&&(z==null||z(y),w&&w(b.map(W=>({id:W,type:"remove"})))),T.length>0&&(E==null||E(T),S)){const W=T.map(N=>({id:N.id,type:"remove"}));S(W)}}},[]),u=P.useCallback(v=>{const I=uf(v),p=I?null:t.getState().nodeInternals.get(v.id);return!I&&!p?[null,null,I]:[I?v:Lo(p),p,I]},[]),h=P.useCallback((v,I=!0,p)=>{const[A,k,_]=u(v);return A?(p||t.getState().getNodes()).filter(D=>{if(!_&&(D.id===k.id||!D.positionAbsolute))return!1;const E=Lo(D),z=Hr(E,A);return I&&z>0||z>=A.width*A.height}):[]},[]),x=P.useCallback((v,I,p=!0)=>{const[A]=u(v);if(!A)return!1;const k=Hr(A,I);return p&&k>0||k>=A.width*A.height},[]);return P.useMemo(()=>({...e,getNodes:r,getNode:o,getEdges:n,getEdge:i,setNodes:s,setEdges:l,addNodes:d,addEdges:f,toObject:a,deleteElements:c,getIntersectingNodes:h,isNodeIntersecting:x}),[e,r,o,n,i,s,l,d,f,a,c,h,x])}const Vf={actInsideInputWithModifier:!1};var Yf=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=ke(),{deleteElements:o}=co(),n=yn(e,Vf),i=yn(t);P.useEffect(()=>{if(n){const{edges:s,getNodes:l}=r.getState(),d=l().filter(a=>a.selected),f=s.filter(a=>a.selected);o({nodes:d,edges:f}),r.setState({nodesSelectionActive:!1})}},[n]),P.useEffect(()=>{r.setState({multiSelectionActive:i})},[i])};function Xf(e){const t=ke();P.useEffect(()=>{let r;const o=()=>{var i,s;if(!e.current)return;const n=to(e.current);(n.height===0||n.width===0)&&((s=(i=t.getState()).onError)==null||s.call(i,"004",xt.error004())),t.setState({width:n.width||500,height:n.height||500})};return o(),window.addEventListener("resize",o),e.current&&(r=new ResizeObserver(()=>o()),r.observe(e.current)),()=>{window.removeEventListener("resize",o),r&&e.current&&r.unobserve(e.current)}},[])}const uo={position:"absolute",width:"100%",height:"100%",top:0,left:0},qf=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,zn=e=>({x:e.x,y:e.y,zoom:e.k}),Ht=(e,t)=>e.target.closest(`.${t}`),Jo=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),ei=e=>{const t=e.ctrlKey&&Zn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Gf=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Zf=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:o,zoomOnScroll:n=!0,zoomOnPinch:i=!0,panOnScroll:s=!1,panOnScrollSpeed:l=.5,panOnScrollMode:d=Mt.Free,zoomOnDoubleClick:f=!0,elementsSelectable:a,panOnDrag:c=!0,defaultViewport:u,translateExtent:h,minZoom:x,maxZoom:v,zoomActivationKeyCode:I,preventScrolling:p=!0,children:A,noWheelClassName:k,noPanClassName:_})=>{const D=P.useRef(),E=ke(),z=P.useRef(!1),S=P.useRef(!1),w=P.useRef(null),M=P.useRef({x:0,y:0,zoom:0}),{d3Zoom:j,d3Selection:T,d3ZoomHandler:F,userSelectionActive:m}=xe(Gf,Le),C=yn(I),y=P.useRef(0),b=P.useRef(!1),W=P.useRef();return Xf(w),P.useEffect(()=>{if(w.current){const N=w.current.getBoundingClientRect(),R=ds().scaleExtent([x,v]).translateExtent(h),O=qe(w.current).call(R),U=pt.translate(u.x,u.y).scale(Kt(u.zoom,x,v)),X=[[0,0],[N.width,N.height]],L=R.constrain()(U,X,h);R.transform(O,L),R.wheelDelta(ei),E.setState({d3Zoom:R,d3Selection:O,d3ZoomHandler:O.on("wheel.zoom"),transform:[L.x,L.y,L.k],domNode:w.current.closest(".react-flow")})}},[]),P.useEffect(()=>{T&&j&&(s&&!C&&!m?T.on("wheel.zoom",N=>{if(Ht(N,k))return!1;N.preventDefault(),N.stopImmediatePropagation();const R=T.property("__zoom").k||1;if(N.ctrlKey&&i){const ne=tt(N),J=ei(N),te=R*Math.pow(2,J);j.scaleTo(T,te,ne,N);return}const O=N.deltaMode===1?20:1;let U=d===Mt.Vertical?0:N.deltaX*O,X=d===Mt.Horizontal?0:N.deltaY*O;!Zn()&&N.shiftKey&&d!==Mt.Vertical&&(U=N.deltaY*O,X=0),j.translateBy(T,-(U/R)*l,-(X/R)*l,{internal:!0});const L=zn(T.property("__zoom")),{onViewportChangeStart:H,onViewportChange:G,onViewportChangeEnd:ee}=E.getState();clearTimeout(W.current),b.current||(b.current=!0,t==null||t(N,L),H==null||H(L)),b.current&&(e==null||e(N,L),G==null||G(L),W.current=setTimeout(()=>{r==null||r(N,L),ee==null||ee(L),b.current=!1},150))},{passive:!1}):typeof F<"u"&&T.on("wheel.zoom",function(N,R){if(!p&&N.type==="wheel"&&!N.ctrlKey||Ht(N,k))return null;N.preventDefault(),F.call(this,N,R)},{passive:!1}))},[m,s,d,T,j,F,C,i,p,k,t,e,r]),P.useEffect(()=>{j&&j.on("start",N=>{var U,X;if(!N.sourceEvent||N.sourceEvent.internal)return null;y.current=(U=N.sourceEvent)==null?void 0:U.button;const{onViewportChangeStart:R}=E.getState(),O=zn(N.transform);z.current=!0,M.current=O,((X=N.sourceEvent)==null?void 0:X.type)==="mousedown"&&E.setState({paneDragging:!0}),R==null||R(O),t==null||t(N.sourceEvent,O)})},[j,t]),P.useEffect(()=>{j&&(m&&!z.current?j.on("zoom",null):m||j.on("zoom",N=>{var O;const{onViewportChange:R}=E.getState();if(E.setState({transform:[N.transform.x,N.transform.y,N.transform.k]}),S.current=!!(o&&Jo(c,y.current??0)),(e||R)&&!((O=N.sourceEvent)!=null&&O.internal)){const U=zn(N.transform);R==null||R(U),e==null||e(N.sourceEvent,U)}}))},[m,j,e,c,o]),P.useEffect(()=>{j&&j.on("end",N=>{if(!N.sourceEvent||N.sourceEvent.internal)return null;const{onViewportChangeEnd:R}=E.getState();if(z.current=!1,E.setState({paneDragging:!1}),o&&Jo(c,y.current??0)&&!S.current&&o(N.sourceEvent),S.current=!1,(r||R)&&qf(M.current,N.transform)){const O=zn(N.transform);M.current=O,clearTimeout(D.current),D.current=setTimeout(()=>{R==null||R(O),r==null||r(N.sourceEvent,O)},s?150:0)}})},[j,s,c,r,o]),P.useEffect(()=>{j&&j.filter(N=>{const R=C||n,O=i&&N.ctrlKey;if((c===!0||Array.isArray(c)&&c.includes(1))&&N.button===1&&N.type==="mousedown"&&(Ht(N,"react-flow__node")||Ht(N,"react-flow__edge")))return!0;if(!c&&!R&&!s&&!f&&!i||m||!f&&N.type==="dblclick"||Ht(N,k)&&N.type==="wheel"||Ht(N,_)&&(N.type!=="wheel"||s&&N.type==="wheel"&&!C)||!i&&N.ctrlKey&&N.type==="wheel"||!R&&!s&&!O&&N.type==="wheel"||!c&&(N.type==="mousedown"||N.type==="touchstart")||Array.isArray(c)&&!c.includes(N.button)&&N.type==="mousedown")return!1;const U=Array.isArray(c)&&c.includes(N.button)||!N.button||N.button<=1;return(!N.ctrlKey||N.type==="wheel")&&U})},[m,j,n,i,s,f,c,a,C]),V.createElement("div",{className:"react-flow__renderer",ref:w,style:uo},A)},Kf=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Qf(){const{userSelectionActive:e,userSelectionRect:t}=xe(Kf,Le);return e&&t?V.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function ti(e,t){const r=t.parentNode||t.parentId,o=e.find(n=>n.id===r);if(o){const n=t.position.x+t.width-o.width,i=t.position.y+t.height-o.height;if(n>0||i>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,n>0&&(o.style.width+=n),i>0&&(o.style.height+=i),t.position.x<0){const s=Math.abs(t.position.x);o.position.x=o.position.x-s,o.style.width+=s,t.position.x=0}if(t.position.y<0){const s=Math.abs(t.position.y);o.position.y=o.position.y-s,o.style.height+=s,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function Bs(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const r=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,n)=>{const i=e.filter(l=>l.id===n.id);if(i.length===0)return o.push(n),o;const s={...n};for(const l of i)if(l)switch(l.type){case"select":{s.selected=l.selected;break}case"position":{typeof l.position<"u"&&(s.position=l.position),typeof l.positionAbsolute<"u"&&(s.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(s.dragging=l.dragging),s.expandParent&&ti(o,s);break}case"dimensions":{typeof l.dimensions<"u"&&(s.width=l.dimensions.width,s.height=l.dimensions.height),typeof l.updateStyle<"u"&&(s.style={...s.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(s.resizing=l.resizing),s.expandParent&&ti(o,s);break}case"remove":return o}return o.push(s),o},r)}function Ls(e,t){return Bs(e,t)}function Jf(e,t){return Bs(e,t)}const wt=(e,t)=>({id:e,type:"select",selected:t});function Bt(e,t){return e.reduce((r,o)=>{const n=t.includes(o.id);return!o.selected&&n?(o.selected=!0,r.push(wt(o.id,!0))):o.selected&&!n&&(o.selected=!1,r.push(wt(o.id,!1))),r},[])}const Ir=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},eh=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Os=P.memo(({isSelecting:e,selectionMode:t=xn.Full,panOnDrag:r,onSelectionStart:o,onSelectionEnd:n,onPaneClick:i,onPaneContextMenu:s,onPaneScroll:l,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:a,children:c})=>{const u=P.useRef(null),h=ke(),x=P.useRef(0),v=P.useRef(0),I=P.useRef(),{userSelectionActive:p,elementsSelectable:A,dragging:k}=xe(eh,Le),_=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,v.current=0},D=F=>{i==null||i(F),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},E=F=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){F.preventDefault();return}s==null||s(F)},z=l?F=>l(F):void 0,S=F=>{const{resetSelectedElements:m,domNode:C}=h.getState();if(I.current=C==null?void 0:C.getBoundingClientRect(),!A||!e||F.button!==0||F.target!==u.current||!I.current)return;const{x:y,y:b}=Et(F,I.current);m(),h.setState({userSelectionRect:{width:0,height:0,startX:y,startY:b,x:y,y:b}}),o==null||o(F)},w=F=>{const{userSelectionRect:m,nodeInternals:C,edges:y,transform:b,onNodesChange:W,onEdgesChange:N,nodeOrigin:R,getNodes:O}=h.getState();if(!e||!I.current||!m)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const U=Et(F,I.current),X=m.startX??0,L=m.startY??0,H={...m,x:U.x<X?U.x:X,y:U.y<L?U.y:L,width:Math.abs(U.x-X),height:Math.abs(U.y-L)},G=O(),ee=Cs(C,H,b,t===xn.Partial,!0,R),ne=_s(ee,y).map(te=>te.id),J=ee.map(te=>te.id);if(x.current!==J.length){x.current=J.length;const te=Bt(G,J);te.length&&(W==null||W(te))}if(v.current!==ne.length){v.current=ne.length;const te=Bt(y,ne);te.length&&(N==null||N(te))}h.setState({userSelectionRect:H})},M=F=>{if(F.button!==0)return;const{userSelectionRect:m}=h.getState();!p&&m&&F.target===u.current&&(D==null||D(F)),h.setState({nodesSelectionActive:x.current>0}),_(),n==null||n(F)},j=F=>{p&&(h.setState({nodesSelectionActive:x.current>0}),n==null||n(F)),_()},T=A&&(e||p);return V.createElement("div",{className:De(["react-flow__pane",{dragging:k,selection:e}]),onClick:T?void 0:Ir(D,u),onContextMenu:Ir(E,u),onWheel:Ir(z,u),onMouseEnter:T?void 0:d,onMouseDown:T?S:void 0,onMouseMove:T?w:f,onMouseUp:T?M:void 0,onMouseLeave:T?j:a,ref:u,style:uo},c,V.createElement(Qf,null))});Os.displayName="Pane";function Vs(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const o=t.get(r);return o?o.selected?!0:Vs(o,t):!1}function ni(e,t,r){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===r.current)return!1;o=o.parentElement}while(o);return!1}function th(e,t,r,o){return Array.from(e.values()).filter(n=>(n.selected||n.id===o)&&(!n.parentNode||n.parentId||!Vs(n,e))&&(n.draggable||t&&typeof n.draggable>"u")).map(n=>{var i,s;return{id:n.id,position:n.position||{x:0,y:0},positionAbsolute:n.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((i=n.positionAbsolute)==null?void 0:i.x)??0),y:r.y-(((s=n.positionAbsolute)==null?void 0:s.y)??0)},delta:{x:0,y:0},extent:n.extent,parentNode:n.parentNode||n.parentId,parentId:n.parentNode||n.parentId,width:n.width,height:n.height,expandParent:n.expandParent}})}function nh(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Ys(e,t,r,o,n=[0,0],i){const s=nh(e,e.extent||o);let l=s;const d=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(d&&e.width&&e.height){const c=r.get(d),{x:u,y:h}=Dt(c,n).positionAbsolute;l=c&&Ge(u)&&Ge(h)&&Ge(c.width)&&Ge(c.height)?[[u+e.width*n[0],h+e.height*n[1]],[u+c.width-e.width+e.width*n[0],h+c.height-e.height+e.height*n[1]]]:l}else i==null||i("005",xt.error005()),l=s;else if(e.extent&&d&&e.extent!=="parent"){const c=r.get(d),{x:u,y:h}=Dt(c,n).positionAbsolute;l=[[e.extent[0][0]+u,e.extent[0][1]+h],[e.extent[1][0]+u,e.extent[1][1]+h]]}let f={x:0,y:0};if(d){const c=r.get(d);f=Dt(c,n).positionAbsolute}const a=l&&l!=="parent"?no(t,l):t;return{position:{x:a.x-f.x,y:a.y-f.y},positionAbsolute:a}}function Ar({nodeId:e,dragItems:t,nodeInternals:r}){const o=t.map(n=>({...r.get(n.id),position:n.position,positionAbsolute:n.positionAbsolute}));return[e?o.find(n=>n.id===e):o[0],o]}const ri=(e,t,r,o)=>{const n=t.querySelectorAll(e);if(!n||!n.length)return null;const i=Array.from(n),s=t.getBoundingClientRect(),l={x:s.width*o[0],y:s.height*o[1]};return i.map(d=>{const f=d.getBoundingClientRect();return{id:d.getAttribute("data-handleid"),position:d.getAttribute("data-handlepos"),x:(f.left-s.left-l.x)/r,y:(f.top-s.top-l.y)/r,...to(d)}})};function on(e,t,r){return r===void 0?r:o=>{const n=t().nodeInternals.get(e);n&&r(o,{...n})}}function Yr({id:e,store:t,unselect:r=!1,nodeRef:o}){const{addSelectedNodes:n,unselectNodesAndEdges:i,multiSelectionActive:s,nodeInternals:l,onError:d}=t.getState(),f=l.get(e);if(!f){d==null||d("012",xt.error012(e));return}t.setState({nodesSelectionActive:!1}),f.selected?(r||f.selected&&s)&&(i({nodes:[f],edges:[]}),requestAnimationFrame(()=>{var a;return(a=o==null?void 0:o.current)==null?void 0:a.blur()})):n([e])}function rh(){const e=ke();return P.useCallback(({sourceEvent:r})=>{const{transform:o,snapGrid:n,snapToGrid:i}=e.getState(),s=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,d={x:(s-o[0])/o[2],y:(l-o[1])/o[2]};return{xSnapped:i?n[0]*Math.round(d.x/n[0]):d.x,ySnapped:i?n[1]*Math.round(d.y/n[1]):d.y,...d}},[])}function kr(e){return(t,r,o)=>e==null?void 0:e(t,o)}function Xs({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:o,nodeId:n,isSelectable:i,selectNodesOnDrag:s}){const l=ke(),[d,f]=P.useState(!1),a=P.useRef([]),c=P.useRef({x:null,y:null}),u=P.useRef(0),h=P.useRef(null),x=P.useRef({x:0,y:0}),v=P.useRef(null),I=P.useRef(!1),p=P.useRef(!1),A=P.useRef(!1),k=rh();return P.useEffect(()=>{if(e!=null&&e.current){const _=qe(e.current),D=({x:S,y:w})=>{const{nodeInternals:M,onNodeDrag:j,onSelectionDrag:T,updateNodePositions:F,nodeExtent:m,snapGrid:C,snapToGrid:y,nodeOrigin:b,onError:W}=l.getState();c.current={x:S,y:w};let N=!1,R={x:0,y:0,x2:0,y2:0};if(a.current.length>1&&m){const U=fr(a.current,b);R=mn(U)}if(a.current=a.current.map(U=>{const X={x:S-U.distance.x,y:w-U.distance.y};y&&(X.x=C[0]*Math.round(X.x/C[0]),X.y=C[1]*Math.round(X.y/C[1]));const L=[[m[0][0],m[0][1]],[m[1][0],m[1][1]]];a.current.length>1&&m&&!U.extent&&(L[0][0]=U.positionAbsolute.x-R.x+m[0][0],L[1][0]=U.positionAbsolute.x+(U.width??0)-R.x2+m[1][0],L[0][1]=U.positionAbsolute.y-R.y+m[0][1],L[1][1]=U.positionAbsolute.y+(U.height??0)-R.y2+m[1][1]);const H=Ys(U,X,M,L,b,W);return N=N||U.position.x!==H.position.x||U.position.y!==H.position.y,U.position=H.position,U.positionAbsolute=H.positionAbsolute,U}),!N)return;F(a.current,!0,!0),f(!0);const O=n?j:kr(T);if(O&&v.current){const[U,X]=Ar({nodeId:n,dragItems:a.current,nodeInternals:M});O(v.current,U,X)}},E=()=>{if(!h.current)return;const[S,w]=hs(x.current,h.current);if(S!==0||w!==0){const{transform:M,panBy:j}=l.getState();c.current.x=(c.current.x??0)-S/M[2],c.current.y=(c.current.y??0)-w/M[2],j({x:S,y:w})&&D(c.current)}u.current=requestAnimationFrame(E)},z=S=>{var b;const{nodeInternals:w,multiSelectionActive:M,nodesDraggable:j,unselectNodesAndEdges:T,onNodeDragStart:F,onSelectionDragStart:m}=l.getState();p.current=!0;const C=n?F:kr(m);(!s||!i)&&!M&&n&&((b=w.get(n))!=null&&b.selected||T()),n&&i&&s&&Yr({id:n,store:l,nodeRef:e});const y=k(S);if(c.current=y,a.current=th(w,j,y,n),C&&a.current){const[W,N]=Ar({nodeId:n,dragItems:a.current,nodeInternals:w});C(S.sourceEvent,W,N)}};if(t)_.on(".drag",null);else{const S=hu().on("start",w=>{const{domNode:M,nodeDragThreshold:j}=l.getState();j===0&&z(w),A.current=!1;const T=k(w);c.current=T,h.current=(M==null?void 0:M.getBoundingClientRect())||null,x.current=Et(w.sourceEvent,h.current)}).on("drag",w=>{var F,m;const M=k(w),{autoPanOnNodeDrag:j,nodeDragThreshold:T}=l.getState();if(w.sourceEvent.type==="touchmove"&&w.sourceEvent.touches.length>1&&(A.current=!0),!A.current){if(!I.current&&p.current&&j&&(I.current=!0,E()),!p.current){const C=M.xSnapped-(((F=c==null?void 0:c.current)==null?void 0:F.x)??0),y=M.ySnapped-(((m=c==null?void 0:c.current)==null?void 0:m.y)??0);Math.sqrt(C*C+y*y)>T&&z(w)}(c.current.x!==M.xSnapped||c.current.y!==M.ySnapped)&&a.current&&p.current&&(v.current=w.sourceEvent,x.current=Et(w.sourceEvent,h.current),D(M))}}).on("end",w=>{if(!(!p.current||A.current)&&(f(!1),I.current=!1,p.current=!1,cancelAnimationFrame(u.current),a.current)){const{updateNodePositions:M,nodeInternals:j,onNodeDragStop:T,onSelectionDragStop:F}=l.getState(),m=n?T:kr(F);if(M(a.current,!1,!1),m){const[C,y]=Ar({nodeId:n,dragItems:a.current,nodeInternals:j});m(w.sourceEvent,C,y)}}}).filter(w=>{const M=w.target;return!w.button&&(!r||!ni(M,`.${r}`,e))&&(!o||ni(M,o,e))});return _.call(S),()=>{_.on(".drag",null)}}}},[e,t,r,o,i,l,n,s,k]),d}function qs(){const e=ke();return P.useCallback(r=>{const{nodeInternals:o,nodeExtent:n,updateNodePositions:i,getNodes:s,snapToGrid:l,snapGrid:d,onError:f,nodesDraggable:a}=e.getState(),c=s().filter(A=>A.selected&&(A.draggable||a&&typeof A.draggable>"u")),u=l?d[0]:5,h=l?d[1]:5,x=r.isShiftPressed?4:1,v=r.x*u*x,I=r.y*h*x,p=c.map(A=>{if(A.positionAbsolute){const k={x:A.positionAbsolute.x+v,y:A.positionAbsolute.y+I};l&&(k.x=d[0]*Math.round(k.x/d[0]),k.y=d[1]*Math.round(k.y/d[1]));const{positionAbsolute:_,position:D}=Ys(A,k,o,n,void 0,f);A.position=D,A.positionAbsolute=_}return A});i(p,!0,!1)},[])}const Yt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var sn=e=>{const t=({id:r,type:o,data:n,xPos:i,yPos:s,xPosOrigin:l,yPosOrigin:d,selected:f,onClick:a,onMouseEnter:c,onMouseMove:u,onMouseLeave:h,onContextMenu:x,onDoubleClick:v,style:I,className:p,isDraggable:A,isSelectable:k,isConnectable:_,isFocusable:D,selectNodesOnDrag:E,sourcePosition:z,targetPosition:S,hidden:w,resizeObserver:M,dragHandle:j,zIndex:T,isParent:F,noDragClassName:m,noPanClassName:C,initialized:y,disableKeyboardA11y:b,ariaLabel:W,rfId:N,hasHandleBounds:R})=>{const O=ke(),U=P.useRef(null),X=P.useRef(null),L=P.useRef(z),H=P.useRef(S),G=P.useRef(o),ee=k||A||a||c||u||h,ne=qs(),J=on(r,O.getState,c),te=on(r,O.getState,u),se=on(r,O.getState,h),ae=on(r,O.getState,x),ve=on(r,O.getState,v),he=oe=>{const{nodeDragThreshold:Z}=O.getState();if(k&&(!E||!A||Z>0)&&Yr({id:r,store:O,nodeRef:U}),a){const ue=O.getState().nodeInternals.get(r);ue&&a(oe,{...ue})}},ie=oe=>{if(!Ur(oe)&&!b)if(xs.includes(oe.key)&&k){const Z=oe.key==="Escape";Yr({id:r,store:O,unselect:Z,nodeRef:U})}else A&&f&&Object.prototype.hasOwnProperty.call(Yt,oe.key)&&(O.setState({ariaLiveMessage:`Moved selected node ${oe.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~s}`}),ne({x:Yt[oe.key].x,y:Yt[oe.key].y,isShiftPressed:oe.shiftKey}))};P.useEffect(()=>()=>{X.current&&(M==null||M.unobserve(X.current),X.current=null)},[]),P.useEffect(()=>{if(U.current&&!w){const oe=U.current;(!y||!R||X.current!==oe)&&(X.current&&(M==null||M.unobserve(X.current)),M==null||M.observe(oe),X.current=oe)}},[w,y,R]),P.useEffect(()=>{const oe=G.current!==o,Z=L.current!==z,ue=H.current!==S;U.current&&(oe||Z||ue)&&(oe&&(G.current=o),Z&&(L.current=z),ue&&(H.current=S),O.getState().updateNodeDimensions([{id:r,nodeElement:U.current,forceUpdate:!0}]))},[r,o,z,S]);const de=Xs({nodeRef:U,disabled:w||!A,noDragClassName:m,handleSelector:j,nodeId:r,isSelectable:k,selectNodesOnDrag:E});return w?null:V.createElement("div",{className:De(["react-flow__node",`react-flow__node-${o}`,{[C]:A},p,{selected:f,selectable:k,parent:F,dragging:de}]),ref:U,style:{zIndex:T,transform:`translate(${l}px,${d}px)`,pointerEvents:ee?"all":"none",visibility:y?"visible":"hidden",...I},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:J,onMouseMove:te,onMouseLeave:se,onContextMenu:ae,onClick:he,onDoubleClick:ve,onKeyDown:D?ie:void 0,tabIndex:D?0:void 0,role:D?"button":void 0,"aria-describedby":b?void 0:`${Rs}-${N}`,"aria-label":W},V.createElement(xf,{value:r},V.createElement(e,{id:r,data:n,type:o,xPos:i,yPos:s,selected:f,isConnectable:_,sourcePosition:z,targetPosition:S,dragging:de,dragHandle:j,zIndex:T})))};return t.displayName="NodeWrapper",P.memo(t)};const oh=e=>{const t=e.getNodes().filter(r=>r.selected);return{...fr(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function ih({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const o=ke(),{width:n,height:i,x:s,y:l,transformString:d,userSelectionActive:f}=xe(oh,Le),a=qs(),c=P.useRef(null);if(P.useEffect(()=>{var x;r||(x=c.current)==null||x.focus({preventScroll:!0})},[r]),Xs({nodeRef:c}),f||!n||!i)return null;const u=e?x=>{const v=o.getState().getNodes().filter(I=>I.selected);e(x,v)}:void 0,h=x=>{Object.prototype.hasOwnProperty.call(Yt,x.key)&&a({x:Yt[x.key].x,y:Yt[x.key].y,isShiftPressed:x.shiftKey})};return V.createElement("div",{className:De(["react-flow__nodesselection","react-flow__container",t]),style:{transform:d}},V.createElement("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:r?void 0:-1,onKeyDown:r?void 0:h,style:{width:n,height:i,top:l,left:s}}))}var sh=P.memo(ih);const ah=e=>e.nodesSelectionActive,Gs=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:o,onPaneMouseLeave:n,onPaneContextMenu:i,onPaneScroll:s,deleteKeyCode:l,onMove:d,onMoveStart:f,onMoveEnd:a,selectionKeyCode:c,selectionOnDrag:u,selectionMode:h,onSelectionStart:x,onSelectionEnd:v,multiSelectionKeyCode:I,panActivationKeyCode:p,zoomActivationKeyCode:A,elementsSelectable:k,zoomOnScroll:_,zoomOnPinch:D,panOnScroll:E,panOnScrollSpeed:z,panOnScrollMode:S,zoomOnDoubleClick:w,panOnDrag:M,defaultViewport:j,translateExtent:T,minZoom:F,maxZoom:m,preventScrolling:C,onSelectionContextMenu:y,noWheelClassName:b,noPanClassName:W,disableKeyboardA11y:N})=>{const R=xe(ah),O=yn(c),U=yn(p),X=U||M,L=U||E,H=O||u&&X!==!0;return Yf({deleteKeyCode:l,multiSelectionKeyCode:I}),V.createElement(Zf,{onMove:d,onMoveStart:f,onMoveEnd:a,onPaneContextMenu:i,elementsSelectable:k,zoomOnScroll:_,zoomOnPinch:D,panOnScroll:L,panOnScrollSpeed:z,panOnScrollMode:S,zoomOnDoubleClick:w,panOnDrag:!O&&X,defaultViewport:j,translateExtent:T,minZoom:F,maxZoom:m,zoomActivationKeyCode:A,preventScrolling:C,noWheelClassName:b,noPanClassName:W},V.createElement(Os,{onSelectionStart:x,onSelectionEnd:v,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:o,onPaneMouseLeave:n,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:X,isSelecting:!!H,selectionMode:h},e,R&&V.createElement(sh,{onSelectionContextMenu:y,noPanClassName:W,disableKeyboardA11y:N})))};Gs.displayName="FlowRenderer";var lh=P.memo(Gs);function ch(e){return xe(P.useCallback(r=>e?Cs(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function uh(e){const t={input:sn(e.input||Ts),default:sn(e.default||Vr),output:sn(e.output||$s),group:sn(e.group||lo)},r={},o=Object.keys(e).filter(n=>!["input","default","output","group"].includes(n)).reduce((n,i)=>(n[i]=sn(e[i]||Vr),n),r);return{...t,...o}}const dh=({x:e,y:t,width:r,height:o,origin:n})=>!r||!o?{x:e,y:t}:n[0]<0||n[1]<0||n[0]>1||n[1]>1?{x:e,y:t}:{x:e-r*n[0],y:t-o*n[1]},fh=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Zs=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:o,elementsSelectable:n,updateNodeDimensions:i,onError:s}=xe(fh,Le),l=ch(e.onlyRenderVisibleElements),d=P.useRef(),f=P.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const a=new ResizeObserver(c=>{const u=c.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));i(u)});return d.current=a,a},[]);return P.useEffect(()=>()=>{var a;(a=d==null?void 0:d.current)==null||a.disconnect()},[]),V.createElement("div",{className:"react-flow__nodes",style:uo},l.map(a=>{var D,E,z;let c=a.type||"default";e.nodeTypes[c]||(s==null||s("003",xt.error003(c)),c="default");const u=e.nodeTypes[c]||e.nodeTypes.default,h=!!(a.draggable||t&&typeof a.draggable>"u"),x=!!(a.selectable||n&&typeof a.selectable>"u"),v=!!(a.connectable||r&&typeof a.connectable>"u"),I=!!(a.focusable||o&&typeof a.focusable>"u"),p=e.nodeExtent?no(a.positionAbsolute,e.nodeExtent):a.positionAbsolute,A=(p==null?void 0:p.x)??0,k=(p==null?void 0:p.y)??0,_=dh({x:A,y:k,width:a.width??0,height:a.height??0,origin:e.nodeOrigin});return V.createElement(u,{key:a.id,id:a.id,className:a.className,style:a.style,type:c,data:a.data,sourcePosition:a.sourcePosition||re.Bottom,targetPosition:a.targetPosition||re.Top,hidden:a.hidden,xPos:A,yPos:k,xPosOrigin:_.x,yPosOrigin:_.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!a.selected,isDraggable:h,isSelectable:x,isConnectable:v,isFocusable:I,resizeObserver:f,dragHandle:a.dragHandle,zIndex:((D=a[Ce])==null?void 0:D.z)??0,isParent:!!((E=a[Ce])!=null&&E.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!a.width&&!!a.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:a.ariaLabel,hasHandleBounds:!!((z=a[Ce])!=null&&z.handleBounds)})}))};Zs.displayName="NodeRenderer";var hh=P.memo(Zs);const gh=(e,t,r)=>r===re.Left?e-t:r===re.Right?e+t:e,ph=(e,t,r)=>r===re.Top?e-t:r===re.Bottom?e+t:e,oi="react-flow__edgeupdater",ii=({position:e,centerX:t,centerY:r,radius:o=10,onMouseDown:n,onMouseEnter:i,onMouseOut:s,type:l})=>V.createElement("circle",{onMouseDown:n,onMouseEnter:i,onMouseOut:s,className:De([oi,`${oi}-${l}`]),cx:gh(t,o,e),cy:ph(r,o,e),r:o,stroke:"transparent",fill:"transparent"}),mh=()=>!0;var Ut=e=>{const t=({id:r,className:o,type:n,data:i,onClick:s,onEdgeDoubleClick:l,selected:d,animated:f,label:a,labelStyle:c,labelShowBg:u,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:v,style:I,source:p,target:A,sourceX:k,sourceY:_,targetX:D,targetY:E,sourcePosition:z,targetPosition:S,elementsSelectable:w,hidden:M,sourceHandleId:j,targetHandleId:T,onContextMenu:F,onMouseEnter:m,onMouseMove:C,onMouseLeave:y,reconnectRadius:b,onReconnect:W,onReconnectStart:N,onReconnectEnd:R,markerEnd:O,markerStart:U,rfId:X,ariaLabel:L,isFocusable:H,isReconnectable:G,pathOptions:ee,interactionWidth:ne,disableKeyboardA11y:J})=>{const te=P.useRef(null),[se,ae]=P.useState(!1),[ve,he]=P.useState(!1),ie=ke(),de=P.useMemo(()=>`url('#${Lr(U,X)}')`,[U,X]),oe=P.useMemo(()=>`url('#${Lr(O,X)}')`,[O,X]);if(M)return null;const Z=fe=>{var Xe;const{edges:be,addSelectedEdges:je,unselectNodesAndEdges:Ne,multiSelectionActive:Pe}=ie.getState(),Oe=be.find(ut=>ut.id===r);Oe&&(w&&(ie.setState({nodesSelectionActive:!1}),Oe.selected&&Pe?(Ne({nodes:[],edges:[Oe]}),(Xe=te.current)==null||Xe.blur()):je([r])),s&&s(fe,Oe))},ue=rn(r,ie.getState,l),ye=rn(r,ie.getState,F),pe=rn(r,ie.getState,m),Ie=rn(r,ie.getState,C),ge=rn(r,ie.getState,y),ce=(fe,be)=>{if(fe.button!==0)return;const{edges:je,isValidConnection:Ne}=ie.getState(),Pe=be?A:p,Oe=(be?T:j)||null,Xe=be?"target":"source",ut=Ne||mh,Rt=be,Qe=je.find(Fe=>Fe.id===r);he(!0),N==null||N(fe,Qe,Xe);const en=Fe=>{he(!1),R==null||R(Fe,Qe,Xe)};Ns({event:fe,handleId:Oe,nodeId:Pe,onConnect:Fe=>W==null?void 0:W(Qe,Fe),isTarget:Rt,getState:ie.getState,setState:ie.setState,isValidConnection:ut,edgeUpdaterType:Xe,onReconnectEnd:en})},Ae=fe=>ce(fe,!0),$e=fe=>ce(fe,!1),Ye=()=>ae(!0),we=()=>ae(!1),We=!w&&!s,_e=fe=>{var be;if(!J&&xs.includes(fe.key)&&w){const{unselectNodesAndEdges:je,addSelectedEdges:Ne,edges:Pe}=ie.getState();fe.key==="Escape"?((be=te.current)==null||be.blur(),je({edges:[Pe.find(Xe=>Xe.id===r)]})):Ne([r])}};return V.createElement("g",{className:De(["react-flow__edge",`react-flow__edge-${n}`,o,{selected:d,animated:f,inactive:We,updating:se}]),onClick:Z,onDoubleClick:ue,onContextMenu:ye,onMouseEnter:pe,onMouseMove:Ie,onMouseLeave:ge,onKeyDown:H?_e:void 0,tabIndex:H?0:void 0,role:H?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":L===null?void 0:L||`Edge from ${p} to ${A}`,"aria-describedby":H?`${Ps}-${X}`:void 0,ref:te},!ve&&V.createElement(e,{id:r,source:p,target:A,selected:d,animated:f,label:a,labelStyle:c,labelShowBg:u,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:v,data:i,style:I,sourceX:k,sourceY:_,targetX:D,targetY:E,sourcePosition:z,targetPosition:S,sourceHandleId:j,targetHandleId:T,markerStart:de,markerEnd:oe,pathOptions:ee,interactionWidth:ne}),G&&V.createElement(V.Fragment,null,(G==="source"||G===!0)&&V.createElement(ii,{position:z,centerX:k,centerY:_,radius:b,onMouseDown:Ae,onMouseEnter:Ye,onMouseOut:we,type:"source"}),(G==="target"||G===!0)&&V.createElement(ii,{position:S,centerX:D,centerY:E,radius:b,onMouseDown:$e,onMouseEnter:Ye,onMouseOut:we,type:"target"})))};return t.displayName="EdgeWrapper",P.memo(t)};function xh(e){const t={default:Ut(e.default||Qn),straight:Ut(e.bezier||io),step:Ut(e.step||oo),smoothstep:Ut(e.step||dr),simplebezier:Ut(e.simplebezier||ro)},r={},o=Object.keys(e).filter(n=>!["default","bezier"].includes(n)).reduce((n,i)=>(n[i]=Ut(e[i]||Qn),n),r);return{...t,...o}}function si(e,t,r=null){const o=((r==null?void 0:r.x)||0)+t.x,n=((r==null?void 0:r.y)||0)+t.y,i=(r==null?void 0:r.width)||t.width,s=(r==null?void 0:r.height)||t.height;switch(e){case re.Top:return{x:o+i/2,y:n};case re.Right:return{x:o+i,y:n+s/2};case re.Bottom:return{x:o+i/2,y:n+s};case re.Left:return{x:o,y:n+s/2}}}function ai(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const yh=(e,t,r,o,n,i)=>{const s=si(r,e,t),l=si(i,o,n);return{sourceX:s.x,sourceY:s.y,targetX:l.x,targetY:l.y}};function bh({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:o,targetWidth:n,targetHeight:i,width:s,height:l,transform:d}){const f={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+n),y2:Math.max(e.y+o,t.y+i)};f.x===f.x2&&(f.x2+=1),f.y===f.y2&&(f.y2+=1);const a=mn({x:(0-d[0])/d[2],y:(0-d[1])/d[2],width:s/d[2],height:l/d[2]}),c=Math.max(0,Math.min(a.x2,f.x2)-Math.max(a.x,f.x)),u=Math.max(0,Math.min(a.y2,f.y2)-Math.max(a.y,f.y));return Math.ceil(c*u)>0}function li(e){var o,n,i,s,l;const t=((o=e==null?void 0:e[Ce])==null?void 0:o.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((n=e==null?void 0:e.positionAbsolute)==null?void 0:n.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const vh=[{level:0,isMaxLevel:!0,edges:[]}];function wh(e,t,r=!1){let o=-1;const n=e.reduce((s,l)=>{var a,c;const d=Ge(l.zIndex);let f=d?l.zIndex:0;if(r){const u=t.get(l.target),h=t.get(l.source),x=l.selected||(u==null?void 0:u.selected)||(h==null?void 0:h.selected),v=Math.max(((a=h==null?void 0:h[Ce])==null?void 0:a.z)||0,((c=u==null?void 0:u[Ce])==null?void 0:c.z)||0,1e3);f=(d?l.zIndex:0)+(x?v:0)}return s[f]?s[f].push(l):s[f]=[l],o=f>o?f:o,s},{}),i=Object.entries(n).map(([s,l])=>{const d=+s;return{edges:l,level:d,isMaxLevel:d===o}});return i.length===0?vh:i}function Sh(e,t,r){const o=xe(P.useCallback(n=>e?n.edges.filter(i=>{const s=t.get(i.source),l=t.get(i.target);return(s==null?void 0:s.width)&&(s==null?void 0:s.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&bh({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:l.width,targetHeight:l.height,width:n.width,height:n.height,transform:n.transform})}):n.edges,[e,t]));return wh(o,t,r)}const Eh=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Ch=({color:e="none",strokeWidth:t=1})=>V.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),ci={[Kn.Arrow]:Eh,[Kn.ArrowClosed]:Ch};function _h(e){const t=ke();return P.useMemo(()=>{var n,i;return Object.prototype.hasOwnProperty.call(ci,e)?ci[e]:((i=(n=t.getState()).onError)==null||i.call(n,"009",xt.error009(e)),null)},[e])}const Ih=({id:e,type:t,color:r,width:o=12.5,height:n=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:l="auto-start-reverse"})=>{const d=_h(t);return d?V.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${n}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:l,refX:"0",refY:"0"},V.createElement(d,{color:r,strokeWidth:s})):null},Ah=({defaultColor:e,rfId:t})=>r=>{const o=[];return r.edges.reduce((n,i)=>([i.markerStart,i.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const l=Lr(s,t);o.includes(l)||(n.push({id:l,color:s.color||e,...s}),o.push(l))}}),n),[]).sort((n,i)=>n.id.localeCompare(i.id))},Ks=({defaultColor:e,rfId:t})=>{const r=xe(P.useCallback(Ah({defaultColor:e,rfId:t}),[e,t]),(o,n)=>!(o.length!==n.length||o.some((i,s)=>i.id!==n[s].id)));return V.createElement("defs",null,r.map(o=>V.createElement(Ih,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};Ks.displayName="MarkerDefinitions";var kh=P.memo(Ks);const Nh=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Qs=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:o,edgeTypes:n,noPanClassName:i,onEdgeContextMenu:s,onEdgeMouseEnter:l,onEdgeMouseMove:d,onEdgeMouseLeave:f,onEdgeClick:a,onEdgeDoubleClick:c,onReconnect:u,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:v,children:I,disableKeyboardA11y:p})=>{const{edgesFocusable:A,edgesUpdatable:k,elementsSelectable:_,width:D,height:E,connectionMode:z,nodeInternals:S,onError:w}=xe(Nh,Le),M=Sh(t,S,r);return D?V.createElement(V.Fragment,null,M.map(({level:j,edges:T,isMaxLevel:F})=>V.createElement("svg",{key:j,style:{zIndex:j},width:D,height:E,className:"react-flow__edges react-flow__container"},F&&V.createElement(kh,{defaultColor:e,rfId:o}),V.createElement("g",null,T.map(m=>{const[C,y,b]=li(S.get(m.source)),[W,N,R]=li(S.get(m.target));if(!b||!R)return null;let O=m.type||"default";n[O]||(w==null||w("011",xt.error011(O)),O="default");const U=n[O]||n.default,X=z===At.Strict?N.target:(N.target??[]).concat(N.source??[]),L=ai(y.source,m.sourceHandle),H=ai(X,m.targetHandle),G=(L==null?void 0:L.position)||re.Bottom,ee=(H==null?void 0:H.position)||re.Top,ne=!!(m.focusable||A&&typeof m.focusable>"u"),J=m.reconnectable||m.updatable,te=typeof u<"u"&&(J||k&&typeof J>"u");if(!L||!H)return w==null||w("008",xt.error008(L,m)),null;const{sourceX:se,sourceY:ae,targetX:ve,targetY:he}=yh(C,L,G,W,H,ee);return V.createElement(U,{key:m.id,id:m.id,className:De([m.className,i]),type:O,data:m.data,selected:!!m.selected,animated:!!m.animated,hidden:!!m.hidden,label:m.label,labelStyle:m.labelStyle,labelShowBg:m.labelShowBg,labelBgStyle:m.labelBgStyle,labelBgPadding:m.labelBgPadding,labelBgBorderRadius:m.labelBgBorderRadius,style:m.style,source:m.source,target:m.target,sourceHandleId:m.sourceHandle,targetHandleId:m.targetHandle,markerEnd:m.markerEnd,markerStart:m.markerStart,sourceX:se,sourceY:ae,targetX:ve,targetY:he,sourcePosition:G,targetPosition:ee,elementsSelectable:_,onContextMenu:s,onMouseEnter:l,onMouseMove:d,onMouseLeave:f,onClick:a,onEdgeDoubleClick:c,onReconnect:u,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:v,rfId:o,ariaLabel:m.ariaLabel,isFocusable:ne,isReconnectable:te,pathOptions:"pathOptions"in m?m.pathOptions:void 0,interactionWidth:m.interactionWidth,disableKeyboardA11y:p})})))),I):null};Qs.displayName="EdgeRenderer";var jh=P.memo(Qs);const Mh=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function zh({children:e}){const t=xe(Mh);return V.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function Th(e){const t=co(),r=P.useRef(!1);P.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const Dh={[re.Left]:re.Right,[re.Right]:re.Left,[re.Top]:re.Bottom,[re.Bottom]:re.Top},Js=({nodeId:e,handleType:t,style:r,type:o=St.Bezier,CustomComponent:n,connectionStatus:i})=>{var E,z,S;const{fromNode:s,handleId:l,toX:d,toY:f,connectionMode:a}=xe(P.useCallback(w=>({fromNode:w.nodeInternals.get(e),handleId:w.connectionHandleId,toX:(w.connectionPosition.x-w.transform[0])/w.transform[2],toY:(w.connectionPosition.y-w.transform[1])/w.transform[2],connectionMode:w.connectionMode}),[e]),Le),c=(E=s==null?void 0:s[Ce])==null?void 0:E.handleBounds;let u=c==null?void 0:c[t];if(a===At.Loose&&(u=u||(c==null?void 0:c[t==="source"?"target":"source"])),!s||!u)return null;const h=l?u.find(w=>w.id===l):u[0],x=h?h.x+h.width/2:(s.width??0)/2,v=h?h.y+h.height/2:s.height??0,I=(((z=s.positionAbsolute)==null?void 0:z.x)??0)+x,p=(((S=s.positionAbsolute)==null?void 0:S.y)??0)+v,A=h==null?void 0:h.position,k=A?Dh[A]:null;if(!A||!k)return null;if(n)return V.createElement(n,{connectionLineType:o,connectionLineStyle:r,fromNode:s,fromHandle:h,fromX:I,fromY:p,toX:d,toY:f,fromPosition:A,toPosition:k,connectionStatus:i});let _="";const D={sourceX:I,sourceY:p,sourcePosition:A,targetX:d,targetY:f,targetPosition:k};return o===St.Bezier?[_]=Ss(D):o===St.Step?[_]=Br({...D,borderRadius:0}):o===St.SmoothStep?[_]=Br(D):o===St.SimpleBezier?[_]=ws(D):_=`M${I},${p} ${d},${f}`,V.createElement("path",{d:_,fill:"none",className:"react-flow__connection-path",style:r})};Js.displayName="ConnectionLine";const $h=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Fh({containerStyle:e,style:t,type:r,component:o}){const{nodeId:n,handleType:i,nodesConnectable:s,width:l,height:d,connectionStatus:f}=xe($h,Le);return!(n&&i&&l&&s)?null:V.createElement("svg",{style:e,width:l,height:d,className:"react-flow__edges react-flow__connectionline react-flow__container"},V.createElement("g",{className:De(["react-flow__connection",f])},V.createElement(Js,{nodeId:n,handleType:i,style:t,type:r,CustomComponent:o,connectionStatus:f})))}function ui(e,t){return P.useRef(null),ke(),P.useMemo(()=>t(e),[e])}const ea=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:o,onMoveEnd:n,onInit:i,onNodeClick:s,onEdgeClick:l,onNodeDoubleClick:d,onEdgeDoubleClick:f,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:h,onSelectionContextMenu:x,onSelectionStart:v,onSelectionEnd:I,connectionLineType:p,connectionLineStyle:A,connectionLineComponent:k,connectionLineContainerStyle:_,selectionKeyCode:D,selectionOnDrag:E,selectionMode:z,multiSelectionKeyCode:S,panActivationKeyCode:w,zoomActivationKeyCode:M,deleteKeyCode:j,onlyRenderVisibleElements:T,elementsSelectable:F,selectNodesOnDrag:m,defaultViewport:C,translateExtent:y,minZoom:b,maxZoom:W,preventScrolling:N,defaultMarkerColor:R,zoomOnScroll:O,zoomOnPinch:U,panOnScroll:X,panOnScrollSpeed:L,panOnScrollMode:H,zoomOnDoubleClick:G,panOnDrag:ee,onPaneClick:ne,onPaneMouseEnter:J,onPaneMouseMove:te,onPaneMouseLeave:se,onPaneScroll:ae,onPaneContextMenu:ve,onEdgeContextMenu:he,onEdgeMouseEnter:ie,onEdgeMouseMove:de,onEdgeMouseLeave:oe,onReconnect:Z,onReconnectStart:ue,onReconnectEnd:ye,reconnectRadius:pe,noDragClassName:Ie,noWheelClassName:ge,noPanClassName:ce,elevateEdgesOnSelect:Ae,disableKeyboardA11y:$e,nodeOrigin:Ye,nodeExtent:we,rfId:We})=>{const _e=ui(e,uh),fe=ui(t,xh);return Th(i),V.createElement(lh,{onPaneClick:ne,onPaneMouseEnter:J,onPaneMouseMove:te,onPaneMouseLeave:se,onPaneContextMenu:ve,onPaneScroll:ae,deleteKeyCode:j,selectionKeyCode:D,selectionOnDrag:E,selectionMode:z,onSelectionStart:v,onSelectionEnd:I,multiSelectionKeyCode:S,panActivationKeyCode:w,zoomActivationKeyCode:M,elementsSelectable:F,onMove:r,onMoveStart:o,onMoveEnd:n,zoomOnScroll:O,zoomOnPinch:U,zoomOnDoubleClick:G,panOnScroll:X,panOnScrollSpeed:L,panOnScrollMode:H,panOnDrag:ee,defaultViewport:C,translateExtent:y,minZoom:b,maxZoom:W,onSelectionContextMenu:x,preventScrolling:N,noDragClassName:Ie,noWheelClassName:ge,noPanClassName:ce,disableKeyboardA11y:$e},V.createElement(zh,null,V.createElement(jh,{edgeTypes:fe,onEdgeClick:l,onEdgeDoubleClick:f,onlyRenderVisibleElements:T,onEdgeContextMenu:he,onEdgeMouseEnter:ie,onEdgeMouseMove:de,onEdgeMouseLeave:oe,onReconnect:Z,onReconnectStart:ue,onReconnectEnd:ye,reconnectRadius:pe,defaultMarkerColor:R,noPanClassName:ce,elevateEdgesOnSelect:!!Ae,disableKeyboardA11y:$e,rfId:We},V.createElement(Fh,{style:A,type:p,component:k,containerStyle:_})),V.createElement("div",{className:"react-flow__edgelabel-renderer"}),V.createElement(hh,{nodeTypes:_e,onNodeClick:s,onNodeDoubleClick:d,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:h,selectNodesOnDrag:m,onlyRenderVisibleElements:T,noPanClassName:ce,noDragClassName:Ie,disableKeyboardA11y:$e,nodeOrigin:Ye,nodeExtent:we,rfId:We})))};ea.displayName="GraphView";var Rh=P.memo(ea);const Xr=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],bt={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Xr,nodeExtent:Xr,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:At.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:df,isValidConnection:void 0},Ph=()=>_l((e,t)=>({...bt,setNodes:r=>{const{nodeInternals:o,nodeOrigin:n,elevateNodesOnSelect:i}=t();e({nodeInternals:_r(r,o,n,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:o={}}=t();e({edges:r.map(n=>({...o,...n}))})},setDefaultNodesAndEdges:(r,o)=>{const n=typeof r<"u",i=typeof o<"u",s=n?_r(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:i?o:[],hasDefaultNodes:n,hasDefaultEdges:i})},updateNodeDimensions:r=>{const{onNodesChange:o,nodeInternals:n,fitViewOnInit:i,fitViewOnInitDone:s,fitViewOnInitOptions:l,domNode:d,nodeOrigin:f}=t(),a=d==null?void 0:d.querySelector(".react-flow__viewport");if(!a)return;const c=window.getComputedStyle(a),{m22:u}=new window.DOMMatrixReadOnly(c.transform),h=r.reduce((v,I)=>{const p=n.get(I.id);if(p!=null&&p.hidden)n.set(p.id,{...p,[Ce]:{...p[Ce],handleBounds:void 0}});else if(p){const A=to(I.nodeElement);!!(A.width&&A.height&&(p.width!==A.width||p.height!==A.height||I.forceUpdate))&&(n.set(p.id,{...p,[Ce]:{...p[Ce],handleBounds:{source:ri(".source",I.nodeElement,u,f),target:ri(".target",I.nodeElement,u,f)}},...A}),v.push({id:p.id,type:"dimensions",dimensions:A}))}return v},[]);Hs(n,f);const x=s||i&&!s&&Us(t,{initial:!0,...l});e({nodeInternals:new Map(n),fitViewOnInitDone:x}),(h==null?void 0:h.length)>0&&(o==null||o(h))},updateNodePositions:(r,o=!0,n=!1)=>{const{triggerNodeChanges:i}=t(),s=r.map(l=>{const d={id:l.id,type:"position",dragging:n};return o&&(d.positionAbsolute=l.positionAbsolute,d.position=l.position),d});i(s)},triggerNodeChanges:r=>{const{onNodesChange:o,nodeInternals:n,hasDefaultNodes:i,nodeOrigin:s,getNodes:l,elevateNodesOnSelect:d}=t();if(r!=null&&r.length){if(i){const f=Ls(r,l()),a=_r(f,n,s,d);e({nodeInternals:a})}o==null||o(r)}},addSelectedNodes:r=>{const{multiSelectionActive:o,edges:n,getNodes:i}=t();let s,l=null;o?s=r.map(d=>wt(d,!0)):(s=Bt(i(),r),l=Bt(n,[])),Mn({changedNodes:s,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:o,edges:n,getNodes:i}=t();let s,l=null;o?s=r.map(d=>wt(d,!0)):(s=Bt(n,r),l=Bt(i(),[])),Mn({changedNodes:l,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:o}={})=>{const{edges:n,getNodes:i}=t(),s=r||i(),l=o||n,d=s.map(a=>(a.selected=!1,wt(a.id,!1))),f=l.map(a=>wt(a.id,!1));Mn({changedNodes:d,changedEdges:f,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:o,maxZoom:n}=t();o==null||o.scaleExtent([r,n]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:o,minZoom:n}=t();o==null||o.scaleExtent([n,r]),e({maxZoom:r})},setTranslateExtent:r=>{var o;(o=t().d3Zoom)==null||o.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:o}=t(),i=o().filter(l=>l.selected).map(l=>wt(l.id,!1)),s=r.filter(l=>l.selected).map(l=>wt(l.id,!1));Mn({changedNodes:i,changedEdges:s,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:o}=t();o.forEach(n=>{n.positionAbsolute=no(n.position,r)}),e({nodeExtent:r,nodeInternals:new Map(o)})},panBy:r=>{const{transform:o,width:n,height:i,d3Zoom:s,d3Selection:l,translateExtent:d}=t();if(!s||!l||!r.x&&!r.y)return!1;const f=pt.translate(o[0]+r.x,o[1]+r.y).scale(o[2]),a=[[0,0],[n,i]],c=s==null?void 0:s.constrain()(f,a,d);return s.transform(l,c),o[0]!==c.x||o[1]!==c.y||o[2]!==c.k},cancelConnection:()=>e({connectionNodeId:bt.connectionNodeId,connectionHandleId:bt.connectionHandleId,connectionHandleType:bt.connectionHandleType,connectionStatus:bt.connectionStatus,connectionStartHandle:bt.connectionStartHandle,connectionEndHandle:bt.connectionEndHandle}),reset:()=>e({...bt})}),Object.is),fo=({children:e})=>{const t=P.useRef(null);return t.current||(t.current=Ph()),V.createElement(rf,{value:t.current},e)};fo.displayName="ReactFlowProvider";const ta=({children:e})=>P.useContext(cr)?V.createElement(V.Fragment,null,e):V.createElement(fo,null,e);ta.displayName="ReactFlowWrapper";const Wh={input:Ts,default:Vr,output:$s,group:lo},Hh={default:Qn,straight:io,step:oo,smoothstep:dr,simplebezier:ro},Uh=[0,0],Bh=[15,15],Lh={x:0,y:0,zoom:1},Oh={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},na=P.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:o,className:n,nodeTypes:i=Wh,edgeTypes:s=Hh,onNodeClick:l,onEdgeClick:d,onInit:f,onMove:a,onMoveStart:c,onMoveEnd:u,onConnect:h,onConnectStart:x,onConnectEnd:v,onClickConnectStart:I,onClickConnectEnd:p,onNodeMouseEnter:A,onNodeMouseMove:k,onNodeMouseLeave:_,onNodeContextMenu:D,onNodeDoubleClick:E,onNodeDragStart:z,onNodeDrag:S,onNodeDragStop:w,onNodesDelete:M,onEdgesDelete:j,onSelectionChange:T,onSelectionDragStart:F,onSelectionDrag:m,onSelectionDragStop:C,onSelectionContextMenu:y,onSelectionStart:b,onSelectionEnd:W,connectionMode:N=At.Strict,connectionLineType:R=St.Bezier,connectionLineStyle:O,connectionLineComponent:U,connectionLineContainerStyle:X,deleteKeyCode:L="Backspace",selectionKeyCode:H="Shift",selectionOnDrag:G=!1,selectionMode:ee=xn.Full,panActivationKeyCode:ne="Space",multiSelectionKeyCode:J=Zn()?"Meta":"Control",zoomActivationKeyCode:te=Zn()?"Meta":"Control",snapToGrid:se=!1,snapGrid:ae=Bh,onlyRenderVisibleElements:ve=!1,selectNodesOnDrag:he=!0,nodesDraggable:ie,nodesConnectable:de,nodesFocusable:oe,nodeOrigin:Z=Uh,edgesFocusable:ue,edgesUpdatable:ye,elementsSelectable:pe,defaultViewport:Ie=Lh,minZoom:ge=.5,maxZoom:ce=2,translateExtent:Ae=Xr,preventScrolling:$e=!0,nodeExtent:Ye,defaultMarkerColor:we="#b1b1b7",zoomOnScroll:We=!0,zoomOnPinch:_e=!0,panOnScroll:fe=!1,panOnScrollSpeed:be=.5,panOnScrollMode:je=Mt.Free,zoomOnDoubleClick:Ne=!0,panOnDrag:Pe=!0,onPaneClick:Oe,onPaneMouseEnter:Xe,onPaneMouseMove:ut,onPaneMouseLeave:Rt,onPaneScroll:Qe,onPaneContextMenu:en,children:Je,onEdgeContextMenu:Fe,onEdgeDoubleClick:yt,onEdgeMouseEnter:kt,onEdgeMouseMove:En,onEdgeMouseLeave:dt,onEdgeUpdate:ft,onEdgeUpdateStart:Aa,onEdgeUpdateEnd:ka,onReconnect:Na,onReconnectStart:ja,onReconnectEnd:Ma,reconnectRadius:za=10,edgeUpdaterRadius:Ta=10,onNodesChange:Da,onEdgesChange:$a,noDragClassName:Fa="nodrag",noWheelClassName:Ra="nowheel",noPanClassName:po="nopan",fitView:Pa=!1,fitViewOptions:Wa,connectOnClick:Ha=!0,attributionPosition:Ua,proOptions:Ba,defaultEdgeOptions:La,elevateNodesOnSelect:Oa=!0,elevateEdgesOnSelect:Va=!1,disableKeyboardA11y:mo=!1,autoPanOnConnect:Ya=!0,autoPanOnNodeDrag:Xa=!0,connectionRadius:qa=20,isValidConnection:Ga,onError:Za,style:Ka,id:xo,nodeDragThreshold:Qa,...Ja},el)=>{const pr=xo||"1";return V.createElement("div",{...Ja,style:{...Ka,...Oh},ref:el,className:De(["react-flow",n]),"data-testid":"rf__wrapper",id:xo},V.createElement(ta,null,V.createElement(Rh,{onInit:f,onMove:a,onMoveStart:c,onMoveEnd:u,onNodeClick:l,onEdgeClick:d,onNodeMouseEnter:A,onNodeMouseMove:k,onNodeMouseLeave:_,onNodeContextMenu:D,onNodeDoubleClick:E,nodeTypes:i,edgeTypes:s,connectionLineType:R,connectionLineStyle:O,connectionLineComponent:U,connectionLineContainerStyle:X,selectionKeyCode:H,selectionOnDrag:G,selectionMode:ee,deleteKeyCode:L,multiSelectionKeyCode:J,panActivationKeyCode:ne,zoomActivationKeyCode:te,onlyRenderVisibleElements:ve,selectNodesOnDrag:he,defaultViewport:Ie,translateExtent:Ae,minZoom:ge,maxZoom:ce,preventScrolling:$e,zoomOnScroll:We,zoomOnPinch:_e,zoomOnDoubleClick:Ne,panOnScroll:fe,panOnScrollSpeed:be,panOnScrollMode:je,panOnDrag:Pe,onPaneClick:Oe,onPaneMouseEnter:Xe,onPaneMouseMove:ut,onPaneMouseLeave:Rt,onPaneScroll:Qe,onPaneContextMenu:en,onSelectionContextMenu:y,onSelectionStart:b,onSelectionEnd:W,onEdgeContextMenu:Fe,onEdgeDoubleClick:yt,onEdgeMouseEnter:kt,onEdgeMouseMove:En,onEdgeMouseLeave:dt,onReconnect:Na??ft,onReconnectStart:ja??Aa,onReconnectEnd:Ma??ka,reconnectRadius:za??Ta,defaultMarkerColor:we,noDragClassName:Fa,noWheelClassName:Ra,noPanClassName:po,elevateEdgesOnSelect:Va,rfId:pr,disableKeyboardA11y:mo,nodeOrigin:Z,nodeExtent:Ye}),V.createElement(Df,{nodes:e,edges:t,defaultNodes:r,defaultEdges:o,onConnect:h,onConnectStart:x,onConnectEnd:v,onClickConnectStart:I,onClickConnectEnd:p,nodesDraggable:ie,nodesConnectable:de,nodesFocusable:oe,edgesFocusable:ue,edgesUpdatable:ye,elementsSelectable:pe,elevateNodesOnSelect:Oa,minZoom:ge,maxZoom:ce,nodeExtent:Ye,onNodesChange:Da,onEdgesChange:$a,snapToGrid:se,snapGrid:ae,connectionMode:N,translateExtent:Ae,connectOnClick:Ha,defaultEdgeOptions:La,fitView:Pa,fitViewOptions:Wa,onNodesDelete:M,onEdgesDelete:j,onNodeDragStart:z,onNodeDrag:S,onNodeDragStop:w,onSelectionDrag:m,onSelectionDragStart:F,onSelectionDragStop:C,noPanClassName:po,nodeOrigin:Z,rfId:pr,autoPanOnConnect:Ya,autoPanOnNodeDrag:Xa,onError:Za,connectionRadius:qa,isValidConnection:Ga,nodeDragThreshold:Qa}),V.createElement(zf,{onSelectionChange:T}),Je,V.createElement(sf,{proOptions:Ba,position:Ua}),V.createElement(Wf,{rfId:pr,disableKeyboardA11y:mo})))});na.displayName="ReactFlow";function ra(e){return t=>{const[r,o]=P.useState(t),n=P.useCallback(i=>o(s=>e(i,s)),[]);return[r,o,n]}}const Vh=ra(Ls),Yh=ra(Jf);function oa(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,n]of e)if(!Object.is(n,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const o of r)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const ia=({id:e,x:t,y:r,width:o,height:n,style:i,color:s,strokeColor:l,strokeWidth:d,className:f,borderRadius:a,shapeRendering:c,onClick:u,selected:h})=>{const{background:x,backgroundColor:v}=i||{},I=s||x||v;return V.createElement("rect",{className:De(["react-flow__minimap-node",{selected:h},f]),x:t,y:r,rx:a,ry:a,width:o,height:n,fill:I,stroke:l,strokeWidth:d,shapeRendering:c,onClick:u?p=>u(p,e):void 0})};ia.displayName="MiniMapNode";var Xh=P.memo(ia);const qh=e=>e.nodeOrigin,Gh=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),Nr=e=>e instanceof Function?e:()=>e;function Zh({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:o=5,nodeStrokeWidth:n=2,nodeComponent:i=Xh,onClick:s}){const l=xe(Gh,oa),d=xe(qh),f=Nr(t),a=Nr(e),c=Nr(r),u=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return V.createElement(V.Fragment,null,l.map(h=>{const{x,y:v}=Dt(h,d).positionAbsolute;return V.createElement(i,{key:h.id,x,y:v,width:h.width,height:h.height,style:h.style,selected:h.selected,className:c(h),color:f(h),borderRadius:o,strokeColor:a(h),strokeWidth:n,shapeRendering:u,onClick:s,id:h.id})}))}var Kh=P.memo(Zh);const Qh=200,Jh=150,e0=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?cf(fr(t,e.nodeOrigin),r):r,rfId:e.rfId}},t0="react-flow__minimap-desc";function sa({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:o="#e2e2e2",nodeClassName:n="",nodeBorderRadius:i=5,nodeStrokeWidth:s=2,nodeComponent:l,maskColor:d="rgb(240, 240, 240, 0.6)",maskStrokeColor:f="none",maskStrokeWidth:a=1,position:c="bottom-right",onClick:u,onNodeClick:h,pannable:x=!1,zoomable:v=!1,ariaLabel:I="React Flow mini map",inversePan:p=!1,zoomStep:A=10,offsetScale:k=5}){const _=ke(),D=P.useRef(null),{boundingRect:E,viewBB:z,rfId:S}=xe(e0,oa),w=(e==null?void 0:e.width)??Qh,M=(e==null?void 0:e.height)??Jh,j=E.width/w,T=E.height/M,F=Math.max(j,T),m=F*w,C=F*M,y=k*F,b=E.x-(m-E.width)/2-y,W=E.y-(C-E.height)/2-y,N=m+y*2,R=C+y*2,O=`${t0}-${S}`,U=P.useRef(0);U.current=F,P.useEffect(()=>{if(D.current){const H=qe(D.current),G=J=>{const{transform:te,d3Selection:se,d3Zoom:ae}=_.getState();if(J.sourceEvent.type!=="wheel"||!se||!ae)return;const ve=-J.sourceEvent.deltaY*(J.sourceEvent.deltaMode===1?.05:J.sourceEvent.deltaMode?1:.002)*A,he=te[2]*Math.pow(2,ve);ae.scaleTo(se,he)},ee=J=>{const{transform:te,d3Selection:se,d3Zoom:ae,translateExtent:ve,width:he,height:ie}=_.getState();if(J.sourceEvent.type!=="mousemove"||!se||!ae)return;const de=U.current*Math.max(1,te[2])*(p?-1:1),oe={x:te[0]-J.sourceEvent.movementX*de,y:te[1]-J.sourceEvent.movementY*de},Z=[[0,0],[he,ie]],ue=pt.translate(oe.x,oe.y).scale(te[2]),ye=ae.constrain()(ue,Z,ve);ae.transform(se,ye)},ne=ds().on("zoom",x?ee:null).on("zoom.wheel",v?G:null);return H.call(ne),()=>{H.on("zoom",null)}}},[x,v,p,A]);const X=u?H=>{const G=tt(H);u(H,{x:G[0],y:G[1]})}:void 0,L=h?(H,G)=>{const ee=_.getState().nodeInternals.get(G);h(H,ee)}:void 0;return V.createElement(ur,{position:c,style:e,className:De(["react-flow__minimap",t]),"data-testid":"rf__minimap"},V.createElement("svg",{width:w,height:M,viewBox:`${b} ${W} ${N} ${R}`,role:"img","aria-labelledby":O,ref:D,onClick:X},I&&V.createElement("title",{id:O},I),V.createElement(Kh,{onClick:L,nodeColor:o,nodeStrokeColor:r,nodeBorderRadius:i,nodeClassName:n,nodeStrokeWidth:s,nodeComponent:l}),V.createElement("path",{className:"react-flow__minimap-mask",d:`M${b-y},${W-y}h${N+y*2}v${R+y*2}h${-N-y*2}z
        M${z.x},${z.y}h${z.width}v${z.height}h${-z.width}z`,fill:d,fillRule:"evenodd",stroke:f,strokeWidth:a,pointerEvents:"none"})))}sa.displayName="MiniMap";var n0=P.memo(sa);function r0(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,n]of e)if(!Object.is(n,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const o of r)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}function o0(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},V.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function i0(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},V.createElement("path",{d:"M0 0h32v4.2H0z"}))}function s0(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},V.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function a0(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},V.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function l0(){return V.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},V.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const cn=({children:e,className:t,...r})=>V.createElement("button",{type:"button",className:De(["react-flow__controls-button",t]),...r},e);cn.displayName="ControlButton";const c0=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),aa=({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:o=!0,fitViewOptions:n,onZoomIn:i,onZoomOut:s,onFitView:l,onInteractiveChange:d,className:f,children:a,position:c="bottom-left"})=>{const u=ke(),[h,x]=P.useState(!1),{isInteractive:v,minZoomReached:I,maxZoomReached:p}=xe(c0,r0),{zoomIn:A,zoomOut:k,fitView:_}=co();if(P.useEffect(()=>{x(!0)},[]),!h)return null;const D=()=>{A(),i==null||i()},E=()=>{k(),s==null||s()},z=()=>{_(n),l==null||l()},S=()=>{u.setState({nodesDraggable:!v,nodesConnectable:!v,elementsSelectable:!v}),d==null||d(!v)};return V.createElement(ur,{className:De(["react-flow__controls",f]),position:c,style:e,"data-testid":"rf__controls"},t&&V.createElement(V.Fragment,null,V.createElement(cn,{onClick:D,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:p},V.createElement(o0,null)),V.createElement(cn,{onClick:E,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:I},V.createElement(i0,null))),r&&V.createElement(cn,{className:"react-flow__controls-fitview",onClick:z,title:"fit view","aria-label":"fit view"},V.createElement(s0,null)),o&&V.createElement(cn,{className:"react-flow__controls-interactive",onClick:S,title:"toggle interactivity","aria-label":"toggle interactivity"},v?V.createElement(l0,null):V.createElement(a0,null)),a)};aa.displayName="Controls";var u0=P.memo(aa);function d0(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,n]of e)if(!Object.is(n,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const o of r)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var Ke;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ke||(Ke={}));function f0({color:e,dimensions:t,lineWidth:r}){return V.createElement("path",{stroke:e,strokeWidth:r,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function h0({color:e,radius:t}){return V.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const g0={[Ke.Dots]:"#91919a",[Ke.Lines]:"#eee",[Ke.Cross]:"#e2e2e2"},p0={[Ke.Dots]:1,[Ke.Lines]:1,[Ke.Cross]:6},m0=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function la({id:e,variant:t=Ke.Dots,gap:r=20,size:o,lineWidth:n=1,offset:i=2,color:s,style:l,className:d}){const f=P.useRef(null),{transform:a,patternId:c}=xe(m0,d0),u=s||g0[t],h=o||p0[t],x=t===Ke.Dots,v=t===Ke.Cross,I=Array.isArray(r)?r:[r,r],p=[I[0]*a[2]||1,I[1]*a[2]||1],A=h*a[2],k=v?[A,A]:p,_=x?[A/i,A/i]:[k[0]/i,k[1]/i];return V.createElement("svg",{className:De(["react-flow__background",d]),style:{...l,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:f,"data-testid":"rf__background"},V.createElement("pattern",{id:c+e,x:a[0]%p[0],y:a[1]%p[1],width:p[0],height:p[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${_[0]},-${_[1]})`},x?V.createElement(h0,{color:u,radius:A/i}):V.createElement(f0,{dimensions:k,color:u,lineWidth:n})),V.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${c+e})`}))}la.displayName="Background";var x0=P.memo(la);const hr=P.memo(({title:e,description:t,dateCreated:r,imageCount:o,fileCount:n,onView:i,onEdit:s,onDelete:l,nodeColor:d,showSourceHandle:f=!0,showTargetHandle:a=!0,badge:c,isSelected:u=!1})=>{const h=tl(),x=nl(h.breakpoints.down("sm")),v=r.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0});return g.jsxs(Y,{sx:{minWidth:x?220:280,maxWidth:x?220:280,backgroundColor:u?d.hover:d.bg,border:`2px solid ${u?d.border:$.neutral[300]}`,borderRadius:Ee.xl,padding:B[4],boxShadow:u?rt.lg:rt.md,transition:ll.transitions.fast,cursor:"pointer","&:hover":{backgroundColor:d.hover,boxShadow:rt.lg,transform:"translateY(-2px)"}},children:[a&&g.jsx(Qt,{type:"target",position:re.Left,style:{background:d.border,width:12,height:12,border:`2px solid ${$.background.primary}`}}),g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:B[2]},children:[g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.display,fontSize:x?q.fontSize.base:q.fontSize.lg,fontWeight:q.fontWeight.bold,color:d.text,lineHeight:q.lineHeight.tight,flex:1,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:e}),c&&g.jsx(rr,{label:c.label,size:"small",sx:{ml:B[2],backgroundColor:c.color,color:$.text.inverse,fontWeight:q.fontWeight.semibold,fontSize:q.fontSize.xs,height:20}})]}),g.jsx(K,{variant:"body2",sx:{color:$.text.secondary,fontSize:q.fontSize.sm,mb:B[3],overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:q.lineHeight.snug},children:t||"No description provided"}),g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:B[3],mb:B[3]},children:[g.jsx(K,{variant:"caption",sx:{color:$.text.tertiary,fontSize:q.fontSize.xs},children:v}),o>0&&g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:B[1]},children:[g.jsx(Pn,{sx:{fontSize:14,color:$.text.tertiary}}),g.jsx(K,{variant:"caption",sx:{color:$.text.tertiary,fontSize:q.fontSize.xs},children:o})]}),n>0&&g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:B[1]},children:[g.jsx(qt,{sx:{fontSize:14,color:$.text.tertiary}}),g.jsx(K,{variant:"caption",sx:{color:$.text.tertiary,fontSize:q.fontSize.xs},children:n})]})]}),g.jsxs(Y,{sx:{display:"flex",gap:B[1],justifyContent:"flex-end"},children:[i&&g.jsx(me,{size:"small",onClick:I=>{I.stopPropagation(),i()},sx:{color:d.border,"&:hover":{backgroundColor:d.hover}},children:g.jsx(rl,{sx:{fontSize:18}})}),s&&g.jsx(me,{size:"small",onClick:I=>{I.stopPropagation(),s()},sx:{color:$.primary[500],"&:hover":{backgroundColor:$.primary[50]}},children:g.jsx(qr,{sx:{fontSize:18}})}),l&&g.jsx(me,{size:"small",onClick:I=>{I.stopPropagation(),l()},sx:{color:$.error,"&:hover":{backgroundColor:"#FEE2E2"}},children:g.jsx(or,{sx:{fontSize:18}})})]}),f&&g.jsx(Qt,{type:"source",position:re.Right,style:{background:d.border,width:12,height:12,border:`2px solid ${$.background.primary}`}})]})});hr.displayName="NodeBase";const ca=P.memo(({id:e,data:t,selected:r})=>{var a,c;const o=Q(u=>u.selectNode),n=Q(u=>u.hoveredNodeId),i=Q(u=>u.setHoveredNode),s={bg:$.primary[50],border:$.primary[500],text:$.text.primary,hover:$.primary[100]},l=()=>{o(e)},d=()=>{o(e),Q.setState({activePanel:"edit"})},f=t.buildCount>0||t.testCount>0?{label:`${t.buildCount} builds, ${t.testCount} tests`,color:$.primary[500]}:void 0;return g.jsx("div",{onMouseEnter:()=>i(e),onMouseLeave:()=>i(null),children:g.jsx(hr,{id:e,title:t.title,description:t.description,dateCreated:t.dateCreated,imageCount:((a=t.images)==null?void 0:a.length)||0,fileCount:((c=t.files)==null?void 0:c.length)||0,onView:l,onEdit:d,nodeColor:s,showSourceHandle:!0,showTargetHandle:!1,badge:f,isSelected:r,isHovered:n===e})})});ca.displayName="DesignNode";const ua=P.memo(({id:e,data:t,selected:r})=>{var u,h;const o=Q(x=>x.selectNode),n=Q(x=>x.hoveredNodeId),i=Q(x=>x.setHoveredNode),s=Q(x=>x.openDeleteDialog),l={bg:$.secondary[50],border:$.secondary[500],text:$.text.primary,hover:$.secondary[100]},d=()=>{o(e)},f=()=>{o(e),Q.setState({activePanel:"edit"})},a=()=>{s(t.buildId,"build",t.title)},c=t.testCount>0?{label:`${t.testCount} test${t.testCount>1?"s":""}`,color:$.secondary[500]}:void 0;return g.jsx("div",{onMouseEnter:()=>i(e),onMouseLeave:()=>i(null),children:g.jsx(hr,{id:e,title:t.title,description:t.description,dateCreated:t.dateCreated,imageCount:((u=t.images)==null?void 0:u.length)||0,fileCount:((h=t.files)==null?void 0:h.length)||0,onView:d,onEdit:f,onDelete:a,nodeColor:l,showSourceHandle:!0,showTargetHandle:!0,badge:c,isSelected:r,isHovered:n===e})})});ua.displayName="BuildNode";const da=P.memo(({id:e,data:t,selected:r})=>{var c,u;const o=Q(h=>h.selectNode),n=Q(h=>h.hoveredNodeId),i=Q(h=>h.setHoveredNode),s=Q(h=>h.openDeleteDialog),l={bg:"#FFF7ED",border:$.warning,text:$.text.primary,hover:"#FFEDD5"},d=()=>{o(e)},f=()=>{o(e),Q.setState({activePanel:"edit"})},a=()=>{s(t.testId,"test",t.title)};return g.jsx("div",{onMouseEnter:()=>i(e),onMouseLeave:()=>i(null),children:g.jsx(hr,{id:e,title:t.title,description:t.description,dateCreated:t.dateCreated,imageCount:((c=t.images)==null?void 0:c.length)||0,fileCount:((u=t.files)==null?void 0:u.length)||0,onView:d,onEdit:f,onDelete:a,nodeColor:l,showSourceHandle:!1,showTargetHandle:!0,isSelected:r,isHovered:n===e})})});da.displayName="TestNode";const y0={designNode:ca,buildNode:ua,testNode:da},b0=({designIdFilter:e})=>{const t=Q(p=>p.nodes),r=Q(p=>p.edges),o=V.useMemo(()=>e?t.filter(p=>p.type==="designNode"||p.type==="buildNode"||p.type==="testNode"?p.data.designId===e:!1):t,[t,e]),n=V.useMemo(()=>{if(!e)return r;const p=new Set(o.map(A=>A.id));return r.filter(A=>p.has(A.source)&&p.has(A.target))},[r,o,e]),i=Q(p=>p.updateNodePosition),s=Q(p=>p.selectNode);Q(p=>p.selectedNodeId);const[l,d,f]=Vh(o),[a,c,u]=Yh(n);P.useEffect(()=>{d(o)},[o,d]),P.useEffect(()=>{c(n)},[n,c]);const h=P.useCallback(p=>{f(p),p.forEach(A=>{A.type==="position"&&A.dragging===!1&&A.position&&i(A.id,A.position)})},[f,i]),x=P.useCallback((p,A)=>{s(A.id)},[s]),v=P.useCallback(()=>{s(null)},[s]),I=P.useCallback(p=>{console.log("Connection attempted (not allowed):",p)},[]);return g.jsx(Y,{sx:{width:"100%",height:"100%",position:"relative"},children:g.jsxs(na,{nodes:l,edges:a,onNodesChange:h,onEdgesChange:u,onConnect:I,onNodeClick:x,onPaneClick:v,nodeTypes:y0,connectionMode:At.Loose,fitView:!0,fitViewOptions:{padding:.2,includeHiddenNodes:!1},minZoom:.1,maxZoom:2,defaultEdgeOptions:{type:"smoothstep",animated:!1,style:{stroke:$.neutral[300],strokeWidth:2}},style:{backgroundColor:$.background.secondary},children:[g.jsx(x0,{variant:Ke.Dots,gap:16,size:1,color:$.neutral[300]}),g.jsx(u0,{showInteractive:!1,style:{backgroundColor:$.background.primary,border:`1px solid ${$.neutral[300]}`}}),g.jsx(n0,{nodeColor:p=>p.type==="designNode"?$.primary[500]:p.type==="buildNode"?$.secondary[500]:$.warning,nodeBorderRadius:12,style:{backgroundColor:$.background.primary,border:`1px solid ${$.neutral[300]}`}}),g.jsx(ur,{position:"top-left",style:{margin:16},children:g.jsx(Y,{sx:{backgroundColor:$.background.primary,padding:"12px 16px",borderRadius:"12px",border:`1px solid ${$.neutral[300]}`,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:g.jsxs(Y,{sx:{display:"flex",gap:2,alignItems:"center"},children:[g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:1},children:[g.jsx(Y,{sx:{width:12,height:12,borderRadius:"50%",backgroundColor:$.primary[500]}}),g.jsxs(Y,{sx:{fontSize:14,color:$.text.secondary},children:[l.filter(p=>p.type==="designNode").length," Designs"]})]}),g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:1},children:[g.jsx(Y,{sx:{width:12,height:12,borderRadius:"50%",backgroundColor:$.secondary[500]}}),g.jsxs(Y,{sx:{fontSize:14,color:$.text.secondary},children:[l.filter(p=>p.type==="buildNode").length," Builds"]})]}),g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:1},children:[g.jsx(Y,{sx:{width:12,height:12,borderRadius:"50%",backgroundColor:$.warning}}),g.jsxs(Y,{sx:{fontSize:14,color:$.text.secondary},children:[l.filter(p=>p.type==="testNode").length," Tests"]})]})]})})})]})})};function Te(e){return e.data.type==="design"}function Me(e){return e.data.type==="build"}function ze(e){return e.data.type==="test"}const fa=({images:e})=>{const[t,r]=P.useState(null);return!e||e.length===0?g.jsxs(Y,{sx:{border:`2px dashed ${$.neutral[300]}`,borderRadius:Ee.lg,p:B[4],textAlign:"center",backgroundColor:$.background.secondary},children:[g.jsx(Pn,{sx:{fontSize:36,color:$.text.tertiary,mb:B[1]}}),g.jsx(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm},children:"No images"})]}):g.jsxs(Y,{children:[g.jsx(Wn,{container:!0,spacing:B[2],children:e.map((o,n)=>g.jsx(Wn,{item:!0,xs:12,sm:6,md:4,children:g.jsxs(fi,{sx:{borderRadius:Ee.lg,boxShadow:rt.sm,transition:"all 0.2s",cursor:"pointer","&:hover":{boxShadow:rt.md,transform:"translateY(-2px)"}},onClick:()=>r(o),children:[g.jsx(hi,{component:"img",height:"140",image:o.url,alt:o.title,sx:{objectFit:"cover"}}),o.title&&g.jsx(gi,{sx:{p:B[2]},children:g.jsx(K,{variant:"body2",sx:{color:$.text.secondary,fontSize:q.fontSize.sm,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:o.title})})]})},n))}),g.jsx(Jt,{open:!!t,onClose:()=>r(null),maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{backgroundColor:$.background.primary,borderRadius:Ee.xl}},children:g.jsx(pi,{sx:{p:0,position:"relative"},children:t&&g.jsxs(g.Fragment,{children:[g.jsx(me,{onClick:()=>r(null),sx:{position:"absolute",top:B[2],right:B[2],backgroundColor:"rgba(0, 0, 0, 0.5)",color:"#fff","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"},zIndex:1},children:g.jsx(lt,{})}),g.jsx("img",{src:t.url,alt:t.title,style:{width:"100%",height:"auto",display:"block"}}),t.title&&g.jsx(Y,{sx:{p:B[3],backgroundColor:$.background.secondary},children:g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.display,color:$.text.primary},children:t.title})})]})})})]})},v0=e=>{var r;switch((r=e.split(".").pop())==null?void 0:r.toLowerCase()){case"pdf":return g.jsx(Ci,{sx:{color:"#D32F2F"}});case"doc":case"docx":return g.jsx(Un,{sx:{color:"#1976D2"}});case"xls":case"xlsx":case"csv":return g.jsx(Ei,{sx:{color:"#2E7D32"}});case"txt":case"md":return g.jsx(Un,{sx:{color:$.text.secondary}});case"json":case"xml":case"html":case"css":case"js":case"ts":return g.jsx(Si,{sx:{color:"#F57C00"}});case"zip":case"rar":case"7z":return g.jsx(wi,{sx:{color:"#5E35B1"}});default:return g.jsx(qt,{sx:{color:$.text.tertiary}})}},ha=({files:e})=>{const t=o=>{window.open(o.url,"_blank")},r=o=>{window.open(o.url,"_blank")};return!e||e.length===0?g.jsxs(Y,{sx:{border:`2px dashed ${$.neutral[300]}`,borderRadius:Ee.lg,p:B[4],textAlign:"center",backgroundColor:$.background.secondary},children:[g.jsx(qt,{sx:{fontSize:36,color:$.text.tertiary,mb:B[1]}}),g.jsx(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm},children:"No files attached"})]}):g.jsx(mi,{sx:{border:`1px solid ${$.neutral[200]}`,borderRadius:Ee.lg,backgroundColor:$.background.secondary,overflow:"hidden"},children:e.map((o,n)=>{var i;return g.jsxs(xi,{sx:{borderBottom:n<e.length-1?`1px solid ${$.neutral[200]}`:"none",cursor:"pointer",transition:"all 0.2s","&:hover":{backgroundColor:$.neutral[50]}},onClick:()=>r(o),children:[g.jsx(yi,{children:v0(o.name)}),g.jsx(bi,{primary:g.jsx(K,{variant:"body2",sx:{fontWeight:q.fontWeight.medium,color:$.text.primary,"&:hover":{color:$.primary[600]}},children:o.name}),secondary:g.jsxs(K,{variant:"caption",sx:{color:$.text.tertiary},children:[(i=o.name.split(".").pop())==null?void 0:i.toUpperCase()," file  Click to open"]})}),g.jsx(vi,{children:g.jsxs(Y,{sx:{display:"flex",gap:B[1]},children:[g.jsx(Hn,{title:"Open in new tab",children:g.jsx(me,{edge:"end",size:"small",onClick:s=>{s.stopPropagation(),r(o)},sx:{color:$.primary[500],"&:hover":{backgroundColor:$.primary[50]}},children:g.jsx(ol,{fontSize:"small"})})}),g.jsx(Hn,{title:"Download",children:g.jsx(me,{edge:"end",size:"small",onClick:s=>{s.stopPropagation(),t(o)},sx:{color:$.secondary[500],"&:hover":{backgroundColor:$.secondary[50]}},children:g.jsx(il,{fontSize:"small"})})})]})})]},o.id||n)})})},Xt=({content:e,maxLines:t})=>{const r=hl.sanitize(e||"");return g.jsx(Y,{sx:{"& p":{margin:0,marginBottom:B[2],color:$.text.primary,fontSize:q.fontSize.base,lineHeight:1.6},"& p:last-child":{marginBottom:0},"& h1, & h2, & h3":{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary,marginTop:B[3],marginBottom:B[2]},"& h1":{fontSize:q.fontSize["2xl"]},"& h2":{fontSize:q.fontSize.xl},"& h3":{fontSize:q.fontSize.lg},"& strong":{fontWeight:q.fontWeight.semibold},"& em":{fontStyle:"italic"},"& u":{textDecoration:"underline"},"& s":{textDecoration:"line-through"},"& a":{color:$.primary[500],textDecoration:"none","&:hover":{textDecoration:"underline"}},"& ul, & ol":{paddingLeft:B[6],marginBottom:B[2]},"& li":{marginBottom:B[1]},"& blockquote":{borderLeft:`4px solid ${$.primary[500]}`,paddingLeft:B[4],marginLeft:0,marginBottom:B[2],fontStyle:"italic",color:$.text.secondary},"& code":{backgroundColor:$.background.secondary,padding:`${B[.5]} ${B[1.5]}`,borderRadius:"4px",fontSize:q.fontSize.sm,fontFamily:"monospace"},"& pre":{backgroundColor:$.background.secondary,padding:B[3],borderRadius:"8px",overflow:"auto",marginBottom:B[2],"& code":{backgroundColor:"transparent",padding:0}},...t&&{display:"-webkit-box",WebkitLineClamp:t,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"}},dangerouslySetInnerHTML:{__html:r}})},w0=()=>{var E,z;const e=Q(S=>S.selectedNodeId),t=Q(S=>S.getNodeById),r=Q(S=>S.selectNode),o=Q(S=>S.setActivePanel),n=Q(S=>S.setIsExpanded),i=Q(S=>S.fetchAllData),[s,l]=P.useState(!1),[d,f]=P.useState(!1),a=e?t(e):null;if(!a)return null;const c=()=>{r(null),o(null)},u=()=>{o("edit")},h=()=>{l(!0)},x=async()=>{f(!0);try{Me(a)?await Ze.deleteBuild(a.data.buildId,a.data.userId):ze(a)&&await Ze.deleteTest(a.data.testId,a.data.userId),l(!1),c(),await i(a.data.userId,!1,[])}catch(S){console.error("Error deleting:",S),alert("Failed to delete. Please try again.")}finally{f(!1)}},v=()=>{l(!1)},I=()=>{o("addBuild")},p=()=>{o("addTest")},A=()=>{n(!0)},_=Te(a)?{type:"Design",color:$.primary[500],bgColor:$.primary[50]}:Me(a)?{type:"Build",color:$.secondary[500],bgColor:$.secondary[50]}:ze(a)?{type:"Test",color:$.warning,bgColor:"#FFF7ED"}:{type:"Unknown",color:$.neutral[500],bgColor:$.neutral[50]},D=a.data.dateCreated.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0});return g.jsxs(Y,{sx:{position:"absolute",right:0,top:0,bottom:0,width:480,backgroundColor:$.background.primary,boxShadow:rt["2xl"],zIndex:1300,display:"flex",flexDirection:"column",animation:"slideInRight 0.3s ease-out","@keyframes slideInRight":{from:{transform:"translateX(100%)"},to:{transform:"translateX(0)"}}},children:[g.jsxs(Y,{sx:{p:B[4],borderBottom:`1px solid ${$.neutral[200]}`,backgroundColor:_.bgColor},children:[g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:B[2]},children:[g.jsx(rr,{label:_.type,size:"small",sx:{backgroundColor:_.color,color:$.text.inverse,fontWeight:q.fontWeight.semibold}}),g.jsxs(Y,{sx:{display:"flex",gap:B[.5]},children:[g.jsx(me,{size:"small",onClick:A,children:g.jsx(bn,{})}),g.jsx(me,{size:"small",onClick:c,children:g.jsx(lt,{})})]})]}),g.jsx(K,{variant:"h4",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary,mb:B[1]},children:a.data.title}),g.jsxs(Y,{children:[g.jsxs(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm},children:["Created ",D]}),a.data.dateModified&&g.jsxs(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm,mt:B[.5]},children:["Last Modified ",a.data.dateModified.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]})]})]}),g.jsxs(Y,{sx:{flex:1,overflowY:"auto",p:B[4]},children:[g.jsxs(Y,{sx:{mb:B[4]},children:[g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[2]},children:"Description"}),g.jsx(Xt,{content:a.data.description||"<p>No description provided</p>"})]}),g.jsx(Ct,{sx:{my:B[4]}}),ze(a)&&g.jsxs(g.Fragment,{children:[g.jsxs(Y,{sx:{mb:B[4]},children:[g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[2]},children:"Results"}),g.jsx(Xt,{content:a.data.results||"<p>No results provided</p>"})]}),g.jsxs(Y,{sx:{mb:B[4]},children:[g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[2]},children:"Conclusions"}),g.jsx(Xt,{content:a.data.conclusions||"<p>No conclusions provided</p>"})]}),g.jsx(Ct,{sx:{my:B[4]}})]}),g.jsxs(Y,{sx:{mb:B[4]},children:[g.jsxs(K,{variant:"h6",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[2]},children:["Images (",((E=a.data.images)==null?void 0:E.length)||0,")"]}),g.jsx(fa,{images:a.data.images||[]})]}),g.jsxs(Y,{sx:{mb:B[4]},children:[g.jsxs(K,{variant:"h6",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[2]},children:["Files (",((z=a.data.files)==null?void 0:z.length)||0,")"]}),g.jsx(ha,{files:a.data.files||[]})]}),Te(a)&&g.jsxs(Y,{children:[g.jsxs(K,{variant:"body2",sx:{color:$.text.secondary,mb:B[1]},children:[a.data.buildCount," build",a.data.buildCount!==1?"s":""]}),g.jsxs(K,{variant:"body2",sx:{color:$.text.secondary},children:[a.data.testCount," test",a.data.testCount!==1?"s":""]})]})]}),g.jsxs(Y,{sx:{p:B[4],borderTop:`1px solid ${$.neutral[200]}`},children:[(Te(a)||Me(a))&&g.jsxs(Y,{sx:{mb:B[3],display:"flex",gap:B[2]},children:[Te(a)&&g.jsx(Se,{variant:"outlined",startIcon:g.jsx(_t,{}),onClick:I,fullWidth:!0,sx:{borderColor:$.secondary[500],color:$.secondary[600],fontWeight:q.fontWeight.semibold,"&:hover":{borderColor:$.secondary[600],backgroundColor:$.secondary[50]}},children:"Add Build"}),Me(a)&&g.jsx(Se,{variant:"outlined",startIcon:g.jsx(_t,{}),onClick:p,fullWidth:!0,sx:{borderColor:$.warning,color:"#B45309",fontWeight:q.fontWeight.semibold,"&:hover":{borderColor:"#B45309",backgroundColor:"#FFF7ED"}},children:"Add Test"})]}),g.jsxs(Y,{sx:{display:"flex",gap:B[2]},children:[g.jsx(Se,{variant:"contained",startIcon:g.jsx(qr,{}),onClick:u,fullWidth:!0,sx:{backgroundColor:$.primary[500],"&:hover":{backgroundColor:$.primary[600]}},children:"Edit"}),!Te(a)&&g.jsx(Se,{variant:"outlined",startIcon:g.jsx(or,{}),onClick:h,sx:{borderColor:$.error,color:$.error,"&:hover":{borderColor:$.error,backgroundColor:"#FEE2E2"}},children:"Delete"})]})]}),g.jsx(zi,{open:s,title:`Delete ${Me(a)?"Build":"Test"}?`,message:`Are you sure you want to delete "${a.data.title}"? ${Me(a)?"This will also delete all associated tests. ":""}This action cannot be undone.`,confirmLabel:d?"Deleting...":"Delete",cancelLabel:"Cancel",onConfirm:x,onCancel:v,isDestructive:!0})]})},S0=()=>{var x,v;const e=Q(I=>I.selectedNodeId),t=Q(I=>I.getNodeById),r=Q(I=>I.selectNode),o=Q(I=>I.setActivePanel),n=Q(I=>I.setIsExpanded),i=e?t(e):null;if(!i)return null;const s=()=>{r(null),o(null),n(!1)},l=()=>{n(!1)},d=()=>{o("edit")},f=()=>{o("addBuild")},a=()=>{o("addTest")},u=Te(i)?{type:"Design",color:$.primary[500],bgColor:$.primary[50]}:Me(i)?{type:"Build",color:$.secondary[500],bgColor:$.secondary[50]}:ze(i)?{type:"Test",color:$.warning,bgColor:"#FFF7ED"}:{type:"Unknown",color:$.neutral[500],bgColor:$.neutral[50]},h=i.data.dateCreated.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0});return g.jsxs(Jt,{open:!0,onClose:s,fullScreen:!0,PaperProps:{sx:{backgroundColor:$.background.secondary}},children:[g.jsxs(Y,{sx:{position:"sticky",top:0,zIndex:10,p:B[4],backgroundColor:u.bgColor,borderBottom:`1px solid ${$.neutral[200]}`},children:[g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:B[2]},children:[g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:B[2]},children:[g.jsx(rr,{label:u.type,size:"medium",sx:{backgroundColor:u.color,color:$.text.inverse,fontWeight:q.fontWeight.semibold}}),g.jsx(K,{variant:"h3",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary},children:i.data.title})]}),g.jsxs(Y,{sx:{display:"flex",gap:B[1]},children:[g.jsx(me,{size:"medium",onClick:l,children:g.jsx(sl,{})}),g.jsx(me,{size:"medium",onClick:s,children:g.jsx(lt,{})})]})]}),g.jsxs(Y,{children:[g.jsxs(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm},children:["Created ",h]}),i.data.dateModified&&g.jsxs(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm,mt:B[.5]},children:["Last Modified ",i.data.dateModified.toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})]})]})]}),g.jsxs(Y,{sx:{flex:1,overflowY:"auto",p:B[6],maxWidth:1200,mx:"auto",width:"100%"},children:[g.jsxs(Y,{sx:{mb:B[6]},children:[g.jsx(K,{variant:"h5",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[3]},children:"Description"}),g.jsx(Xt,{content:i.data.description||"<p>No description provided</p>"})]}),g.jsx(Ct,{sx:{my:B[6]}}),ze(i)&&g.jsxs(g.Fragment,{children:[g.jsxs(Y,{sx:{mb:B[6]},children:[g.jsx(K,{variant:"h5",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[3]},children:"Results"}),g.jsx(Xt,{content:i.data.results||"<p>No results provided</p>"})]}),g.jsxs(Y,{sx:{mb:B[6]},children:[g.jsx(K,{variant:"h5",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[3]},children:"Conclusions"}),g.jsx(Xt,{content:i.data.conclusions||"<p>No conclusions provided</p>"})]}),g.jsx(Ct,{sx:{my:B[6]}})]}),g.jsxs(Y,{sx:{mb:B[6]},children:[g.jsxs(K,{variant:"h5",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[3]},children:["Images (",((x=i.data.images)==null?void 0:x.length)||0,")"]}),g.jsx(fa,{images:i.data.images||[]})]}),g.jsxs(Y,{sx:{mb:B[6]},children:[g.jsxs(K,{variant:"h5",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[3]},children:["Files (",((v=i.data.files)==null?void 0:v.length)||0,")"]}),g.jsx(ha,{files:i.data.files||[]})]}),Te(i)&&g.jsxs(Y,{sx:{mb:B[6]},children:[g.jsx(K,{variant:"h5",sx:{fontFamily:q.fontFamily.secondary,fontWeight:q.fontWeight.semibold,color:$.text.primary,mb:B[3]},children:"Progress"}),g.jsxs(Y,{sx:{display:"flex",gap:B[4]},children:[g.jsxs(Y,{children:[g.jsx(K,{variant:"h4",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.secondary[600]},children:i.data.buildCount}),g.jsxs(K,{variant:"body2",sx:{color:$.text.secondary},children:["Build",i.data.buildCount!==1?"s":""]})]}),g.jsxs(Y,{children:[g.jsx(K,{variant:"h4",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.warning},children:i.data.testCount}),g.jsxs(K,{variant:"body2",sx:{color:$.text.secondary},children:["Test",i.data.testCount!==1?"s":""]})]})]})]})]}),g.jsx(Y,{sx:{position:"sticky",bottom:0,p:B[4],backgroundColor:$.background.primary,borderTop:`1px solid ${$.neutral[200]}`,boxShadow:"0 -4px 6px -1px rgba(0, 0, 0, 0.1)"},children:g.jsxs(Y,{sx:{maxWidth:1200,mx:"auto",width:"100%"},children:[(Te(i)||Me(i))&&g.jsxs(Y,{sx:{mb:B[3],display:"flex",gap:B[2]},children:[Te(i)&&g.jsx(Se,{variant:"outlined",startIcon:g.jsx(_t,{}),onClick:f,sx:{borderColor:$.secondary[500],color:$.secondary[600],fontWeight:q.fontWeight.semibold,"&:hover":{borderColor:$.secondary[600],backgroundColor:$.secondary[50]}},children:"Add Build"}),Me(i)&&g.jsx(Se,{variant:"outlined",startIcon:g.jsx(_t,{}),onClick:a,sx:{borderColor:$.warning,color:"#B45309",fontWeight:q.fontWeight.semibold,"&:hover":{borderColor:"#B45309",backgroundColor:"#FFF7ED"}},children:"Add Test"})]}),g.jsx(Se,{variant:"contained",startIcon:g.jsx(qr,{}),onClick:d,fullWidth:!0,size:"large",sx:{backgroundColor:$.primary[500],"&:hover":{backgroundColor:$.primary[600]}},children:"Edit"})]})})]})};function E0(e,t){return t.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(o){if(o!=="default"&&!(o in e)){var n=Object.getOwnPropertyDescriptor(r,o);Object.defineProperty(e,o,n.get?n:{enumerable:!0,get:function(){return r[o]}})}})}),Object.freeze(e)}function ga(e,t){return new Promise(function(r,o){let n;return C0(e).then(function(i){try{return n=i,r(new Blob([t.slice(0,2),n,t.slice(2)],{type:"image/jpeg"}))}catch(s){return o(s)}},o)})}const C0=e=>new Promise((t,r)=>{const o=new FileReader;o.addEventListener("load",({target:{result:n}})=>{const i=new DataView(n);let s=0;if(i.getUint16(s)!==65496)return r("not a valid JPEG");for(s+=2;;){const l=i.getUint16(s);if(l===65498)break;const d=i.getUint16(s+2);if(l===65505&&i.getUint32(s+4)===1165519206){const f=s+10;let a;switch(i.getUint16(f)){case 18761:a=!0;break;case 19789:a=!1;break;default:return r("TIFF header contains invalid endian")}if(i.getUint16(f+2,a)!==42)return r("TIFF header contains invalid version");const c=i.getUint32(f+4,a),u=f+c+2+12*i.getUint16(f+c,a);for(let h=f+c+2;h<u;h+=12)if(i.getUint16(h,a)==274){if(i.getUint16(h+2,a)!==3)return r("Orientation data type is invalid");if(i.getUint32(h+4,a)!==1)return r("Orientation data count is invalid");i.setUint16(h+8,1,a);break}return t(n.slice(s,s+2+d))}s+=2+d}return t(new Blob)}),o.readAsArrayBuffer(e)});var Jn={},_0={get exports(){return Jn},set exports(e){Jn=e}};(function(e){var t,r,o={};_0.exports=o,o.parse=function(n,i){for(var s=o.bin.readUshort,l=o.bin.readUint,d=0,f={},a=new Uint8Array(n),c=a.length-4;l(a,c)!=101010256;)c--;d=c,d+=4;var u=s(a,d+=4);s(a,d+=2);var h=l(a,d+=2),x=l(a,d+=4);d+=4,d=x;for(var v=0;v<u;v++){l(a,d),d+=4,d+=4,d+=4,l(a,d+=4),h=l(a,d+=4);var I=l(a,d+=4),p=s(a,d+=4),A=s(a,d+2),k=s(a,d+4);d+=6;var _=l(a,d+=8);d+=4,d+=p+A+k,o._readLocal(a,_,f,h,I,i)}return f},o._readLocal=function(n,i,s,l,d,f){var a=o.bin.readUshort,c=o.bin.readUint;c(n,i),a(n,i+=4),a(n,i+=2);var u=a(n,i+=2);c(n,i+=2),c(n,i+=4),i+=4;var h=a(n,i+=8),x=a(n,i+=2);i+=2;var v=o.bin.readUTF8(n,i,h);if(i+=h,i+=x,f)s[v]={size:d,csize:l};else{var I=new Uint8Array(n.buffer,i);if(u==0)s[v]=new Uint8Array(I.buffer.slice(i,i+l));else{if(u!=8)throw"unknown compression method: "+u;var p=new Uint8Array(d);o.inflateRaw(I,p),s[v]=p}}},o.inflateRaw=function(n,i){return o.F.inflate(n,i)},o.inflate=function(n,i){return n[0],n[1],o.inflateRaw(new Uint8Array(n.buffer,n.byteOffset+2,n.length-6),i)},o.deflate=function(n,i){i==null&&(i={level:6});var s=0,l=new Uint8Array(50+Math.floor(1.1*n.length));l[s]=120,l[s+1]=156,s+=2,s=o.F.deflateRaw(n,l,s,i.level);var d=o.adler(n,0,n.length);return l[s+0]=d>>>24&255,l[s+1]=d>>>16&255,l[s+2]=d>>>8&255,l[s+3]=d>>>0&255,new Uint8Array(l.buffer,0,s+4)},o.deflateRaw=function(n,i){i==null&&(i={level:6});var s=new Uint8Array(50+Math.floor(1.1*n.length)),l=o.F.deflateRaw(n,s,l,i.level);return new Uint8Array(s.buffer,0,l)},o.encode=function(n,i){i==null&&(i=!1);var s=0,l=o.bin.writeUint,d=o.bin.writeUshort,f={};for(var a in n){var c=!o._noNeed(a)&&!i,u=n[a],h=o.crc.crc(u,0,u.length);f[a]={cpr:c,usize:u.length,crc:h,file:c?o.deflateRaw(u):u}}for(var a in f)s+=f[a].file.length+30+46+2*o.bin.sizeUTF8(a);s+=22;var x=new Uint8Array(s),v=0,I=[];for(var a in f){var p=f[a];I.push(v),v=o._writeHeader(x,v,a,p,0)}var A=0,k=v;for(var a in f)p=f[a],I.push(v),v=o._writeHeader(x,v,a,p,1,I[A++]);var _=v-k;return l(x,v,101010256),v+=4,d(x,v+=4,A),d(x,v+=2,A),l(x,v+=2,_),l(x,v+=4,k),v+=4,v+=2,x.buffer},o._noNeed=function(n){var i=n.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(i)!=-1},o._writeHeader=function(n,i,s,l,d,f){var a=o.bin.writeUint,c=o.bin.writeUshort,u=l.file;return a(n,i,d==0?67324752:33639248),i+=4,d==1&&(i+=2),c(n,i,20),c(n,i+=2,0),c(n,i+=2,l.cpr?8:0),a(n,i+=2,0),a(n,i+=4,l.crc),a(n,i+=4,u.length),a(n,i+=4,l.usize),c(n,i+=4,o.bin.sizeUTF8(s)),c(n,i+=2,0),i+=2,d==1&&(i+=2,i+=2,a(n,i+=6,f),i+=4),i+=o.bin.writeUTF8(n,i,s),d==0&&(n.set(u,i),i+=u.length),i},o.crc={table:function(){for(var n=new Uint32Array(256),i=0;i<256;i++){for(var s=i,l=0;l<8;l++)1&s?s=3988292384^s>>>1:s>>>=1;n[i]=s}return n}(),update:function(n,i,s,l){for(var d=0;d<l;d++)n=o.crc.table[255&(n^i[s+d])]^n>>>8;return n},crc:function(n,i,s){return 4294967295^o.crc.update(4294967295,n,i,s)}},o.adler=function(n,i,s){for(var l=1,d=0,f=i,a=i+s;f<a;){for(var c=Math.min(f+5552,a);f<c;)d+=l+=n[f++];l%=65521,d%=65521}return d<<16|l},o.bin={readUshort:function(n,i){return n[i]|n[i+1]<<8},writeUshort:function(n,i,s){n[i]=255&s,n[i+1]=s>>8&255},readUint:function(n,i){return 16777216*n[i+3]+(n[i+2]<<16|n[i+1]<<8|n[i])},writeUint:function(n,i,s){n[i]=255&s,n[i+1]=s>>8&255,n[i+2]=s>>16&255,n[i+3]=s>>24&255},readASCII:function(n,i,s){for(var l="",d=0;d<s;d++)l+=String.fromCharCode(n[i+d]);return l},writeASCII:function(n,i,s){for(var l=0;l<s.length;l++)n[i+l]=s.charCodeAt(l)},pad:function(n){return n.length<2?"0"+n:n},readUTF8:function(n,i,s){for(var l,d="",f=0;f<s;f++)d+="%"+o.bin.pad(n[i+f].toString(16));try{l=decodeURIComponent(d)}catch{return o.bin.readASCII(n,i,s)}return l},writeUTF8:function(n,i,s){for(var l=s.length,d=0,f=0;f<l;f++){var a=s.charCodeAt(f);if((4294967168&a)==0)n[i+d]=a,d++;else if((4294965248&a)==0)n[i+d]=192|a>>6,n[i+d+1]=128|a>>0&63,d+=2;else if((4294901760&a)==0)n[i+d]=224|a>>12,n[i+d+1]=128|a>>6&63,n[i+d+2]=128|a>>0&63,d+=3;else{if((4292870144&a)!=0)throw"e";n[i+d]=240|a>>18,n[i+d+1]=128|a>>12&63,n[i+d+2]=128|a>>6&63,n[i+d+3]=128|a>>0&63,d+=4}}return d},sizeUTF8:function(n){for(var i=n.length,s=0,l=0;l<i;l++){var d=n.charCodeAt(l);if((4294967168&d)==0)s++;else if((4294965248&d)==0)s+=2;else if((4294901760&d)==0)s+=3;else{if((4292870144&d)!=0)throw"e";s+=4}}return s}},o.F={},o.F.deflateRaw=function(n,i,s,l){var d=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][l],f=o.F.U,a=o.F._goodIndex;o.F._hash;var c=o.F._putsE,u=0,h=s<<3,x=0,v=n.length;if(l==0){for(;u<v;)c(i,h,u+(j=Math.min(65535,v-u))==v?1:0),h=o.F._copyExact(n,u,j,i,h+8),u+=j;return h>>>3}var I=f.lits,p=f.strt,A=f.prev,k=0,_=0,D=0,E=0,z=0,S=0;for(v>2&&(p[S=o.F._hash(n,0)]=0),u=0;u<v;u++){if(z=S,u+1<v-2){S=o.F._hash(n,u+1);var w=u+1&32767;A[w]=p[S],p[S]=w}if(x<=u){(k>14e3||_>26697)&&v-u>100&&(x<u&&(I[k]=u-x,k+=2,x=u),h=o.F._writeBlock(u==v-1||x==v?1:0,I,k,E,n,D,u-D,i,h),k=_=E=0,D=u);var M=0;u<v-2&&(M=o.F._bestMatch(n,u,A,z,Math.min(d[2],v-u),d[3]));var j=M>>>16,T=65535&M;if(M!=0){T=65535&M;var F=a(j=M>>>16,f.of0);f.lhst[257+F]++;var m=a(T,f.df0);f.dhst[m]++,E+=f.exb[F]+f.dxb[m],I[k]=j<<23|u-x,I[k+1]=T<<16|F<<8|m,k+=2,x=u+j}else f.lhst[n[u]]++;_++}}for(D==u&&n.length!=0||(x<u&&(I[k]=u-x,k+=2,x=u),h=o.F._writeBlock(1,I,k,E,n,D,u-D,i,h),k=0,_=0,k=_=E=0,D=u);(7&h)!=0;)h++;return h>>>3},o.F._bestMatch=function(n,i,s,l,d,f){var a=32767&i,c=s[a],u=a-c+32768&32767;if(c==a||l!=o.F._hash(n,i-u))return 0;for(var h=0,x=0,v=Math.min(32767,i);u<=v&&--f!=0&&c!=a;){if(h==0||n[i+h]==n[i+h-u]){var I=o.F._howLong(n,i,u);if(I>h){if(x=u,(h=I)>=d)break;u+2<I&&(I=u+2);for(var p=0,A=0;A<I-2;A++){var k=i-u+A+32768&32767,_=k-s[k]+32768&32767;_>p&&(p=_,c=k)}}}u+=(a=c)-(c=s[a])+32768&32767}return h<<16|x},o.F._howLong=function(n,i,s){if(n[i]!=n[i-s]||n[i+1]!=n[i+1-s]||n[i+2]!=n[i+2-s])return 0;var l=i,d=Math.min(n.length,i+258);for(i+=3;i<d&&n[i]==n[i-s];)i++;return i-l},o.F._hash=function(n,i){return(n[i]<<8|n[i+1])+(n[i+2]<<4)&65535},o.saved=0,o.F._writeBlock=function(n,i,s,l,d,f,a,c,u){var h,x,v,I,p,A,k,_,D,E=o.F.U,z=o.F._putsF,S=o.F._putsE;E.lhst[256]++,x=(h=o.F.getTrees())[0],v=h[1],I=h[2],p=h[3],A=h[4],k=h[5],_=h[6],D=h[7];var w=32+((u+3&7)==0?0:8-(u+3&7))+(a<<3),M=l+o.F.contSize(E.fltree,E.lhst)+o.F.contSize(E.fdtree,E.dhst),j=l+o.F.contSize(E.ltree,E.lhst)+o.F.contSize(E.dtree,E.dhst);j+=14+3*k+o.F.contSize(E.itree,E.ihst)+(2*E.ihst[16]+3*E.ihst[17]+7*E.ihst[18]);for(var T=0;T<286;T++)E.lhst[T]=0;for(T=0;T<30;T++)E.dhst[T]=0;for(T=0;T<19;T++)E.ihst[T]=0;var F=w<M&&w<j?0:M<j?1:2;if(z(c,u,n),z(c,u+1,F),u+=3,F==0){for(;(7&u)!=0;)u++;u=o.F._copyExact(d,f,a,c,u)}else{var m,C;if(F==1&&(m=E.fltree,C=E.fdtree),F==2){o.F.makeCodes(E.ltree,x),o.F.revCodes(E.ltree,x),o.F.makeCodes(E.dtree,v),o.F.revCodes(E.dtree,v),o.F.makeCodes(E.itree,I),o.F.revCodes(E.itree,I),m=E.ltree,C=E.dtree,S(c,u,p-257),S(c,u+=5,A-1),S(c,u+=5,k-4),u+=4;for(var y=0;y<k;y++)S(c,u+3*y,E.itree[1+(E.ordr[y]<<1)]);u+=3*k,u=o.F._codeTiny(_,E.itree,c,u),u=o.F._codeTiny(D,E.itree,c,u)}for(var b=f,W=0;W<s;W+=2){for(var N=i[W],R=N>>>23,O=b+(8388607&N);b<O;)u=o.F._writeLit(d[b++],m,c,u);if(R!=0){var U=i[W+1],X=U>>16,L=U>>8&255,H=255&U;S(c,u=o.F._writeLit(257+L,m,c,u),R-E.of0[L]),u+=E.exb[L],z(c,u=o.F._writeLit(H,C,c,u),X-E.df0[H]),u+=E.dxb[H],b+=R}}u=o.F._writeLit(256,m,c,u)}return u},o.F._copyExact=function(n,i,s,l,d){var f=d>>>3;return l[f]=s,l[f+1]=s>>>8,l[f+2]=255-l[f],l[f+3]=255-l[f+1],f+=4,l.set(new Uint8Array(n.buffer,i,s),f),d+(s+4<<3)},o.F.getTrees=function(){for(var n=o.F.U,i=o.F._hufTree(n.lhst,n.ltree,15),s=o.F._hufTree(n.dhst,n.dtree,15),l=[],d=o.F._lenCodes(n.ltree,l),f=[],a=o.F._lenCodes(n.dtree,f),c=0;c<l.length;c+=2)n.ihst[l[c]]++;for(c=0;c<f.length;c+=2)n.ihst[f[c]]++;for(var u=o.F._hufTree(n.ihst,n.itree,7),h=19;h>4&&n.itree[1+(n.ordr[h-1]<<1)]==0;)h--;return[i,s,u,d,a,h,l,f]},o.F.getSecond=function(n){for(var i=[],s=0;s<n.length;s+=2)i.push(n[s+1]);return i},o.F.nonZero=function(n){for(var i="",s=0;s<n.length;s+=2)n[s+1]!=0&&(i+=(s>>1)+",");return i},o.F.contSize=function(n,i){for(var s=0,l=0;l<i.length;l++)s+=i[l]*n[1+(l<<1)];return s},o.F._codeTiny=function(n,i,s,l){for(var d=0;d<n.length;d+=2){var f=n[d],a=n[d+1];l=o.F._writeLit(f,i,s,l);var c=f==16?2:f==17?3:7;f>15&&(o.F._putsE(s,l,a,c),l+=c)}return l},o.F._lenCodes=function(n,i){for(var s=n.length;s!=2&&n[s-1]==0;)s-=2;for(var l=0;l<s;l+=2){var d=n[l+1],f=l+3<s?n[l+3]:-1,a=l+5<s?n[l+5]:-1,c=l==0?-1:n[l-1];if(d==0&&f==d&&a==d){for(var u=l+5;u+2<s&&n[u+2]==d;)u+=2;(h=Math.min(u+1-l>>>1,138))<11?i.push(17,h-3):i.push(18,h-11),l+=2*h-2}else if(d==c&&f==d&&a==d){for(u=l+5;u+2<s&&n[u+2]==d;)u+=2;var h=Math.min(u+1-l>>>1,6);i.push(16,h-3),l+=2*h-2}else i.push(d,0)}return s>>>1},o.F._hufTree=function(n,i,s){var l=[],d=n.length,f=i.length,a=0;for(a=0;a<f;a+=2)i[a]=0,i[a+1]=0;for(a=0;a<d;a++)n[a]!=0&&l.push({lit:a,f:n[a]});var c=l.length,u=l.slice(0);if(c==0)return 0;if(c==1){var h=l[0].lit;return u=h==0?1:0,i[1+(h<<1)]=1,i[1+(u<<1)]=1,1}l.sort(function(_,D){return _.f-D.f});var x=l[0],v=l[1],I=0,p=1,A=2;for(l[0]={lit:-1,f:x.f+v.f,l:x,r:v,d:0};p!=c-1;)x=I!=p&&(A==c||l[I].f<l[A].f)?l[I++]:l[A++],v=I!=p&&(A==c||l[I].f<l[A].f)?l[I++]:l[A++],l[p++]={lit:-1,f:x.f+v.f,l:x,r:v};var k=o.F.setDepth(l[p-1],0);for(k>s&&(o.F.restrictDepth(u,s,k),k=s),a=0;a<c;a++)i[1+(u[a].lit<<1)]=u[a].d;return k},o.F.setDepth=function(n,i){return n.lit!=-1?(n.d=i,i):Math.max(o.F.setDepth(n.l,i+1),o.F.setDepth(n.r,i+1))},o.F.restrictDepth=function(n,i,s){var l=0,d=1<<s-i,f=0;for(n.sort(function(c,u){return u.d==c.d?c.f-u.f:u.d-c.d}),l=0;l<n.length&&n[l].d>i;l++){var a=n[l].d;n[l].d=i,f+=d-(1<<s-a)}for(f>>>=s-i;f>0;)(a=n[l].d)<i?(n[l].d++,f-=1<<i-a-1):l++;for(;l>=0;l--)n[l].d==i&&f<0&&(n[l].d--,f++);f!=0&&console.log("debt left")},o.F._goodIndex=function(n,i){var s=0;return i[16|s]<=n&&(s|=16),i[8|s]<=n&&(s|=8),i[4|s]<=n&&(s|=4),i[2|s]<=n&&(s|=2),i[1|s]<=n&&(s|=1),s},o.F._writeLit=function(n,i,s,l){return o.F._putsF(s,l,i[n<<1]),l+i[1+(n<<1)]},o.F.inflate=function(n,i){var s=Uint8Array;if(n[0]==3&&n[1]==0)return i||new s(0);var l=o.F,d=l._bitsF,f=l._bitsE,a=l._decodeTiny,c=l.makeCodes,u=l.codes2map,h=l._get17,x=l.U,v=i==null;v&&(i=new s(n.length>>>2<<3));for(var I,p,A=0,k=0,_=0,D=0,E=0,z=0,S=0,w=0,M=0;A==0;)if(A=d(n,M,1),k=d(n,M+1,2),M+=3,k!=0){if(v&&(i=o.F._check(i,w+(1<<17))),k==1&&(I=x.flmap,p=x.fdmap,z=511,S=31),k==2){_=f(n,M,5)+257,D=f(n,M+5,5)+1,E=f(n,M+10,4)+4,M+=14;for(var j=0;j<38;j+=2)x.itree[j]=0,x.itree[j+1]=0;var T=1;for(j=0;j<E;j++){var F=f(n,M+3*j,3);x.itree[1+(x.ordr[j]<<1)]=F,F>T&&(T=F)}M+=3*E,c(x.itree,T),u(x.itree,T,x.imap),I=x.lmap,p=x.dmap,M=a(x.imap,(1<<T)-1,_+D,n,M,x.ttree);var m=l._copyOut(x.ttree,0,_,x.ltree);z=(1<<m)-1;var C=l._copyOut(x.ttree,_,D,x.dtree);S=(1<<C)-1,c(x.ltree,m),u(x.ltree,m,I),c(x.dtree,C),u(x.dtree,C,p)}for(;;){var y=I[h(n,M)&z];M+=15&y;var b=y>>>4;if(!(b>>>8))i[w++]=b;else{if(b==256)break;var W=w+b-254;if(b>264){var N=x.ldef[b-257];W=w+(N>>>3)+f(n,M,7&N),M+=7&N}var R=p[h(n,M)&S];M+=15&R;var O=R>>>4,U=x.ddef[O],X=(U>>>4)+d(n,M,15&U);for(M+=15&U,v&&(i=o.F._check(i,w+(1<<17)));w<W;)i[w]=i[w++-X],i[w]=i[w++-X],i[w]=i[w++-X],i[w]=i[w++-X];w=W}}}else{(7&M)!=0&&(M+=8-(7&M));var L=4+(M>>>3),H=n[L-4]|n[L-3]<<8;v&&(i=o.F._check(i,w+H)),i.set(new s(n.buffer,n.byteOffset+L,H),w),M=L+H<<3,w+=H}return i.length==w?i:i.slice(0,w)},o.F._check=function(n,i){var s=n.length;if(i<=s)return n;var l=new Uint8Array(Math.max(s<<1,i));return l.set(n,0),l},o.F._decodeTiny=function(n,i,s,l,d,f){for(var a=o.F._bitsE,c=o.F._get17,u=0;u<s;){var h=n[c(l,d)&i];d+=15&h;var x=h>>>4;if(x<=15)f[u]=x,u++;else{var v=0,I=0;x==16?(I=3+a(l,d,2),d+=2,v=f[u-1]):x==17?(I=3+a(l,d,3),d+=3):x==18&&(I=11+a(l,d,7),d+=7);for(var p=u+I;u<p;)f[u]=v,u++}}return d},o.F._copyOut=function(n,i,s,l){for(var d=0,f=0,a=l.length>>>1;f<s;){var c=n[f+i];l[f<<1]=0,l[1+(f<<1)]=c,c>d&&(d=c),f++}for(;f<a;)l[f<<1]=0,l[1+(f<<1)]=0,f++;return d},o.F.makeCodes=function(n,i){for(var s,l,d,f,a=o.F.U,c=n.length,u=a.bl_count,h=0;h<=i;h++)u[h]=0;for(h=1;h<c;h+=2)u[n[h]]++;var x=a.next_code;for(s=0,u[0]=0,l=1;l<=i;l++)s=s+u[l-1]<<1,x[l]=s;for(d=0;d<c;d+=2)(f=n[d+1])!=0&&(n[d]=x[f],x[f]++)},o.F.codes2map=function(n,i,s){for(var l=n.length,d=o.F.U.rev15,f=0;f<l;f+=2)if(n[f+1]!=0)for(var a=f>>1,c=n[f+1],u=a<<4|c,h=i-c,x=n[f]<<h,v=x+(1<<h);x!=v;)s[d[x]>>>15-i]=u,x++},o.F.revCodes=function(n,i){for(var s=o.F.U.rev15,l=15-i,d=0;d<n.length;d+=2){var f=n[d]<<i-n[d+1];n[d]=s[f]>>>l}},o.F._putsE=function(n,i,s){s<<=7&i;var l=i>>>3;n[l]|=s,n[l+1]|=s>>>8},o.F._putsF=function(n,i,s){s<<=7&i;var l=i>>>3;n[l]|=s,n[l+1]|=s>>>8,n[l+2]|=s>>>16},o.F._bitsE=function(n,i,s){return(n[i>>>3]|n[1+(i>>>3)]<<8)>>>(7&i)&(1<<s)-1},o.F._bitsF=function(n,i,s){return(n[i>>>3]|n[1+(i>>>3)]<<8|n[2+(i>>>3)]<<16)>>>(7&i)&(1<<s)-1},o.F._get17=function(n,i){return(n[i>>>3]|n[1+(i>>>3)]<<8|n[2+(i>>>3)]<<16)>>>(7&i)},o.F._get25=function(n,i){return(n[i>>>3]|n[1+(i>>>3)]<<8|n[2+(i>>>3)]<<16|n[3+(i>>>3)]<<24)>>>(7&i)},o.F.U=(t=Uint16Array,r=Uint32Array,{next_code:new t(16),bl_count:new t(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new t(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new r(32),flmap:new t(512),fltree:[],fdmap:new t(32),fdtree:[],lmap:new t(32768),ltree:[],ttree:[],dmap:new t(32768),dtree:[],imap:new t(512),itree:[],rev15:new t(32768),lhst:new r(286),dhst:new r(30),ihst:new r(19),lits:new r(15e3),strt:new t(65536),prev:new t(32768)}),function(){for(var n=o.F.U,i=0;i<32768;i++){var s=i;s=(4278255360&(s=(4042322160&(s=(3435973836&(s=(2863311530&s)>>>1|(1431655765&s)<<1))>>>2|(858993459&s)<<2))>>>4|(252645135&s)<<4))>>>8|(16711935&s)<<8,n.rev15[i]=(s>>>16|s<<16)>>>17}function l(d,f,a){for(;f--!=0;)d.push(0,a)}for(i=0;i<32;i++)n.ldef[i]=n.of0[i]<<3|n.exb[i],n.ddef[i]=n.df0[i]<<4|n.dxb[i];l(n.fltree,144,8),l(n.fltree,112,9),l(n.fltree,24,7),l(n.fltree,8,8),o.F.makeCodes(n.fltree,9),o.F.codes2map(n.fltree,9,n.flmap),o.F.revCodes(n.fltree,9),l(n.fdtree,32,5),o.F.makeCodes(n.fdtree,5),o.F.codes2map(n.fdtree,5,n.fdmap),o.F.revCodes(n.fdtree,5),l(n.itree,19,0),l(n.ltree,286,0),l(n.dtree,30,0),l(n.ttree,320,0)}()})();var I0=E0({__proto__:null,default:Jn},[Jn]);const et=function(){var e={nextZero(a,c){for(;a[c]!=0;)c++;return c},readUshort:(a,c)=>a[c]<<8|a[c+1],writeUshort(a,c,u){a[c]=u>>8&255,a[c+1]=255&u},readUint:(a,c)=>16777216*a[c]+(a[c+1]<<16|a[c+2]<<8|a[c+3]),writeUint(a,c,u){a[c]=u>>24&255,a[c+1]=u>>16&255,a[c+2]=u>>8&255,a[c+3]=255&u},readASCII(a,c,u){let h="";for(let x=0;x<u;x++)h+=String.fromCharCode(a[c+x]);return h},writeASCII(a,c,u){for(let h=0;h<u.length;h++)a[c+h]=u.charCodeAt(h)},readBytes(a,c,u){const h=[];for(let x=0;x<u;x++)h.push(a[c+x]);return h},pad:a=>a.length<2?`0${a}`:a,readUTF8(a,c,u){let h,x="";for(let v=0;v<u;v++)x+=`%${e.pad(a[c+v].toString(16))}`;try{h=decodeURIComponent(x)}catch{return e.readASCII(a,c,u)}return h}};function t(a,c,u,h){const x=c*u,v=i(h),I=Math.ceil(c*v/8),p=new Uint8Array(4*x),A=new Uint32Array(p.buffer),{ctype:k}=h,{depth:_}=h,D=e.readUshort;if(k==6){const N=x<<2;if(_==8)for(var E=0;E<N;E+=4)p[E]=a[E],p[E+1]=a[E+1],p[E+2]=a[E+2],p[E+3]=a[E+3];if(_==16)for(E=0;E<N;E++)p[E]=a[E<<1]}else if(k==2){const N=h.tabs.tRNS;if(N==null){if(_==8)for(E=0;E<x;E++){var z=3*E;A[E]=255<<24|a[z+2]<<16|a[z+1]<<8|a[z]}if(_==16)for(E=0;E<x;E++)z=6*E,A[E]=255<<24|a[z+4]<<16|a[z+2]<<8|a[z]}else{var S=N[0];const R=N[1],O=N[2];if(_==8)for(E=0;E<x;E++){var w=E<<2;z=3*E,A[E]=255<<24|a[z+2]<<16|a[z+1]<<8|a[z],a[z]==S&&a[z+1]==R&&a[z+2]==O&&(p[w+3]=0)}if(_==16)for(E=0;E<x;E++)w=E<<2,z=6*E,A[E]=255<<24|a[z+4]<<16|a[z+2]<<8|a[z],D(a,z)==S&&D(a,z+2)==R&&D(a,z+4)==O&&(p[w+3]=0)}}else if(k==3){const N=h.tabs.PLTE,R=h.tabs.tRNS,O=R?R.length:0;if(_==1)for(var M=0;M<u;M++){var j=M*I,T=M*c;for(E=0;E<c;E++){w=T+E<<2;var F=3*(m=a[j+(E>>3)]>>7-((7&E)<<0)&1);p[w]=N[F],p[w+1]=N[F+1],p[w+2]=N[F+2],p[w+3]=m<O?R[m]:255}}if(_==2)for(M=0;M<u;M++)for(j=M*I,T=M*c,E=0;E<c;E++)w=T+E<<2,F=3*(m=a[j+(E>>2)]>>6-((3&E)<<1)&3),p[w]=N[F],p[w+1]=N[F+1],p[w+2]=N[F+2],p[w+3]=m<O?R[m]:255;if(_==4)for(M=0;M<u;M++)for(j=M*I,T=M*c,E=0;E<c;E++)w=T+E<<2,F=3*(m=a[j+(E>>1)]>>4-((1&E)<<2)&15),p[w]=N[F],p[w+1]=N[F+1],p[w+2]=N[F+2],p[w+3]=m<O?R[m]:255;if(_==8)for(E=0;E<x;E++){var m;w=E<<2,F=3*(m=a[E]),p[w]=N[F],p[w+1]=N[F+1],p[w+2]=N[F+2],p[w+3]=m<O?R[m]:255}}else if(k==4){if(_==8)for(E=0;E<x;E++){w=E<<2;var C=a[y=E<<1];p[w]=C,p[w+1]=C,p[w+2]=C,p[w+3]=a[y+1]}if(_==16)for(E=0;E<x;E++){var y;w=E<<2,C=a[y=E<<2],p[w]=C,p[w+1]=C,p[w+2]=C,p[w+3]=a[y+2]}}else if(k==0)for(S=h.tabs.tRNS?h.tabs.tRNS:-1,M=0;M<u;M++){const N=M*I,R=M*c;if(_==1)for(var b=0;b<c;b++){var W=(C=255*(a[N+(b>>>3)]>>>7-(7&b)&1))==255*S?0:255;A[R+b]=W<<24|C<<16|C<<8|C}else if(_==2)for(b=0;b<c;b++)W=(C=85*(a[N+(b>>>2)]>>>6-((3&b)<<1)&3))==85*S?0:255,A[R+b]=W<<24|C<<16|C<<8|C;else if(_==4)for(b=0;b<c;b++)W=(C=17*(a[N+(b>>>1)]>>>4-((1&b)<<2)&15))==17*S?0:255,A[R+b]=W<<24|C<<16|C<<8|C;else if(_==8)for(b=0;b<c;b++)W=(C=a[N+b])==S?0:255,A[R+b]=W<<24|C<<16|C<<8|C;else if(_==16)for(b=0;b<c;b++)C=a[N+(b<<1)],W=D(a,N+(b<<1))==S?0:255,A[R+b]=W<<24|C<<16|C<<8|C}return p}function r(a,c,u,h){const x=i(a),v=Math.ceil(u*x/8),I=new Uint8Array((v+1+a.interlace)*h);return c=a.tabs.CgBI?n(c,I):o(c,I),a.interlace==0?c=s(c,a,0,u,h):a.interlace==1&&(c=function(A,k){const _=k.width,D=k.height,E=i(k),z=E>>3,S=Math.ceil(_*E/8),w=new Uint8Array(D*S);let M=0;const j=[0,0,4,0,2,0,1],T=[0,4,0,2,0,1,0],F=[8,8,8,4,4,2,2],m=[8,8,4,4,2,2,1];let C=0;for(;C<7;){const b=F[C],W=m[C];let N=0,R=0,O=j[C];for(;O<D;)O+=b,R++;let U=T[C];for(;U<_;)U+=W,N++;const X=Math.ceil(N*E/8);s(A,k,M,N,R);let L=0,H=j[C];for(;H<D;){let G=T[C],ee=M+L*X<<3;for(;G<_;){var y;if(E==1&&(y=(y=A[ee>>3])>>7-(7&ee)&1,w[H*S+(G>>3)]|=y<<7-((7&G)<<0)),E==2&&(y=(y=A[ee>>3])>>6-(7&ee)&3,w[H*S+(G>>2)]|=y<<6-((3&G)<<1)),E==4&&(y=(y=A[ee>>3])>>4-(7&ee)&15,w[H*S+(G>>1)]|=y<<4-((1&G)<<2)),E>=8){const ne=H*S+G*z;for(let J=0;J<z;J++)w[ne+J]=A[(ee>>3)+J]}ee+=E,G+=W}L++,H+=b}N*R!=0&&(M+=R*(1+X)),C+=1}return w}(c,a)),c}function o(a,c){return n(new Uint8Array(a.buffer,2,a.length-6),c)}var n=function(){const a={H:{}};return a.H.N=function(c,u){const h=Uint8Array;let x,v,I=0,p=0,A=0,k=0,_=0,D=0,E=0,z=0,S=0;if(c[0]==3&&c[1]==0)return u||new h(0);const w=a.H,M=w.b,j=w.e,T=w.R,F=w.n,m=w.A,C=w.Z,y=w.m,b=u==null;for(b&&(u=new h(c.length>>>2<<5));I==0;)if(I=M(c,S,1),p=M(c,S+1,2),S+=3,p!=0){if(b&&(u=a.H.W(u,z+(1<<17))),p==1&&(x=y.J,v=y.h,D=511,E=31),p==2){A=j(c,S,5)+257,k=j(c,S+5,5)+1,_=j(c,S+10,4)+4,S+=14;let N=1;for(var W=0;W<38;W+=2)y.Q[W]=0,y.Q[W+1]=0;for(W=0;W<_;W++){const U=j(c,S+3*W,3);y.Q[1+(y.X[W]<<1)]=U,U>N&&(N=U)}S+=3*_,F(y.Q,N),m(y.Q,N,y.u),x=y.w,v=y.d,S=T(y.u,(1<<N)-1,A+k,c,S,y.v);const R=w.V(y.v,0,A,y.C);D=(1<<R)-1;const O=w.V(y.v,A,k,y.D);E=(1<<O)-1,F(y.C,R),m(y.C,R,x),F(y.D,O),m(y.D,O,v)}for(;;){const N=x[C(c,S)&D];S+=15&N;const R=N>>>4;if(!(R>>>8))u[z++]=R;else{if(R==256)break;{let O=z+R-254;if(R>264){const G=y.q[R-257];O=z+(G>>>3)+j(c,S,7&G),S+=7&G}const U=v[C(c,S)&E];S+=15&U;const X=U>>>4,L=y.c[X],H=(L>>>4)+M(c,S,15&L);for(S+=15&L;z<O;)u[z]=u[z++-H],u[z]=u[z++-H],u[z]=u[z++-H],u[z]=u[z++-H];z=O}}}}else{(7&S)!=0&&(S+=8-(7&S));const N=4+(S>>>3),R=c[N-4]|c[N-3]<<8;b&&(u=a.H.W(u,z+R)),u.set(new h(c.buffer,c.byteOffset+N,R),z),S=N+R<<3,z+=R}return u.length==z?u:u.slice(0,z)},a.H.W=function(c,u){const h=c.length;if(u<=h)return c;const x=new Uint8Array(h<<1);return x.set(c,0),x},a.H.R=function(c,u,h,x,v,I){const p=a.H.e,A=a.H.Z;let k=0;for(;k<h;){const _=c[A(x,v)&u];v+=15&_;const D=_>>>4;if(D<=15)I[k]=D,k++;else{let E=0,z=0;D==16?(z=3+p(x,v,2),v+=2,E=I[k-1]):D==17?(z=3+p(x,v,3),v+=3):D==18&&(z=11+p(x,v,7),v+=7);const S=k+z;for(;k<S;)I[k]=E,k++}}return v},a.H.V=function(c,u,h,x){let v=0,I=0;const p=x.length>>>1;for(;I<h;){const A=c[I+u];x[I<<1]=0,x[1+(I<<1)]=A,A>v&&(v=A),I++}for(;I<p;)x[I<<1]=0,x[1+(I<<1)]=0,I++;return v},a.H.n=function(c,u){const h=a.H.m,x=c.length;let v,I,p,A;const k=h.j;for(var _=0;_<=u;_++)k[_]=0;for(_=1;_<x;_+=2)k[c[_]]++;const D=h.K;for(v=0,k[0]=0,I=1;I<=u;I++)v=v+k[I-1]<<1,D[I]=v;for(p=0;p<x;p+=2)A=c[p+1],A!=0&&(c[p]=D[A],D[A]++)},a.H.A=function(c,u,h){const x=c.length,v=a.H.m.r;for(let I=0;I<x;I+=2)if(c[I+1]!=0){const p=I>>1,A=c[I+1],k=p<<4|A,_=u-A;let D=c[I]<<_;const E=D+(1<<_);for(;D!=E;)h[v[D]>>>15-u]=k,D++}},a.H.l=function(c,u){const h=a.H.m.r,x=15-u;for(let v=0;v<c.length;v+=2){const I=c[v]<<u-c[v+1];c[v]=h[I]>>>x}},a.H.M=function(c,u,h){h<<=7&u;const x=u>>>3;c[x]|=h,c[x+1]|=h>>>8},a.H.I=function(c,u,h){h<<=7&u;const x=u>>>3;c[x]|=h,c[x+1]|=h>>>8,c[x+2]|=h>>>16},a.H.e=function(c,u,h){return(c[u>>>3]|c[1+(u>>>3)]<<8)>>>(7&u)&(1<<h)-1},a.H.b=function(c,u,h){return(c[u>>>3]|c[1+(u>>>3)]<<8|c[2+(u>>>3)]<<16)>>>(7&u)&(1<<h)-1},a.H.Z=function(c,u){return(c[u>>>3]|c[1+(u>>>3)]<<8|c[2+(u>>>3)]<<16)>>>(7&u)},a.H.i=function(c,u){return(c[u>>>3]|c[1+(u>>>3)]<<8|c[2+(u>>>3)]<<16|c[3+(u>>>3)]<<24)>>>(7&u)},a.H.m=function(){const c=Uint16Array,u=Uint32Array;return{K:new c(16),j:new c(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new c(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new u(32),J:new c(512),_:[],h:new c(32),$:[],w:new c(32768),C:[],v:[],d:new c(32768),D:[],u:new c(512),Q:[],r:new c(32768),s:new u(286),Y:new u(30),a:new u(19),t:new u(15e3),k:new c(65536),g:new c(32768)}}(),function(){const c=a.H.m;for(var u=0;u<32768;u++){let x=u;x=(2863311530&x)>>>1|(1431655765&x)<<1,x=(3435973836&x)>>>2|(858993459&x)<<2,x=(4042322160&x)>>>4|(252645135&x)<<4,x=(4278255360&x)>>>8|(16711935&x)<<8,c.r[u]=(x>>>16|x<<16)>>>17}function h(x,v,I){for(;v--!=0;)x.push(0,I)}for(u=0;u<32;u++)c.q[u]=c.S[u]<<3|c.T[u],c.c[u]=c.p[u]<<4|c.z[u];h(c._,144,8),h(c._,112,9),h(c._,24,7),h(c._,8,8),a.H.n(c._,9),a.H.A(c._,9,c.J),a.H.l(c._,9),h(c.$,32,5),a.H.n(c.$,5),a.H.A(c.$,5,c.h),a.H.l(c.$,5),h(c.Q,19,0),h(c.C,286,0),h(c.D,30,0),h(c.v,320,0)}(),a.H.N}();function i(a){return[1,null,3,1,2,null,4][a.ctype]*a.depth}function s(a,c,u,h,x){let v=i(c);const I=Math.ceil(h*v/8);let p,A;v=Math.ceil(v/8);let k=a[u],_=0;if(k>1&&(a[u]=[0,0,1][k-2]),k==3)for(_=v;_<I;_++)a[_+1]=a[_+1]+(a[_+1-v]>>>1)&255;for(let D=0;D<x;D++)if(p=u+D*I,A=p+D+1,k=a[A-1],_=0,k==0)for(;_<I;_++)a[p+_]=a[A+_];else if(k==1){for(;_<v;_++)a[p+_]=a[A+_];for(;_<I;_++)a[p+_]=a[A+_]+a[p+_-v]}else if(k==2)for(;_<I;_++)a[p+_]=a[A+_]+a[p+_-I];else if(k==3){for(;_<v;_++)a[p+_]=a[A+_]+(a[p+_-I]>>>1);for(;_<I;_++)a[p+_]=a[A+_]+(a[p+_-I]+a[p+_-v]>>>1)}else{for(;_<v;_++)a[p+_]=a[A+_]+l(0,a[p+_-I],0);for(;_<I;_++)a[p+_]=a[A+_]+l(a[p+_-v],a[p+_-I],a[p+_-v-I])}return a}function l(a,c,u){const h=a+c-u,x=h-a,v=h-c,I=h-u;return x*x<=v*v&&x*x<=I*I?a:v*v<=I*I?c:u}function d(a,c,u){u.width=e.readUint(a,c),c+=4,u.height=e.readUint(a,c),c+=4,u.depth=a[c],c++,u.ctype=a[c],c++,u.compress=a[c],c++,u.filter=a[c],c++,u.interlace=a[c],c++}function f(a,c,u,h,x,v,I,p,A){const k=Math.min(c,x),_=Math.min(u,v);let D=0,E=0;for(let C=0;C<_;C++)for(let y=0;y<k;y++)if(I>=0&&p>=0?(D=C*c+y<<2,E=(p+C)*x+I+y<<2):(D=(-p+C)*c-I+y<<2,E=C*x+y<<2),A==0)h[E]=a[D],h[E+1]=a[D+1],h[E+2]=a[D+2],h[E+3]=a[D+3];else if(A==1){var z=a[D+3]*.00392156862745098,S=a[D]*z,w=a[D+1]*z,M=a[D+2]*z,j=h[E+3]*(1/255),T=h[E]*j,F=h[E+1]*j,m=h[E+2]*j;const b=1-z,W=z+j*b,N=W==0?0:1/W;h[E+3]=255*W,h[E+0]=(S+T*b)*N,h[E+1]=(w+F*b)*N,h[E+2]=(M+m*b)*N}else if(A==2)z=a[D+3],S=a[D],w=a[D+1],M=a[D+2],j=h[E+3],T=h[E],F=h[E+1],m=h[E+2],z==j&&S==T&&w==F&&M==m?(h[E]=0,h[E+1]=0,h[E+2]=0,h[E+3]=0):(h[E]=S,h[E+1]=w,h[E+2]=M,h[E+3]=z);else if(A==3){if(z=a[D+3],S=a[D],w=a[D+1],M=a[D+2],j=h[E+3],T=h[E],F=h[E+1],m=h[E+2],z==j&&S==T&&w==F&&M==m)continue;if(z<220&&j>20)return!1}return!0}return{decode:function(c){const u=new Uint8Array(c);let h=8;const x=e,v=x.readUshort,I=x.readUint,p={tabs:{},frames:[]},A=new Uint8Array(u.length);let k,_=0,D=0;const E=[137,80,78,71,13,10,26,10];for(var z=0;z<8;z++)if(u[z]!=E[z])throw"The input is not a PNG file!";for(;h<u.length;){const C=x.readUint(u,h);h+=4;const y=x.readASCII(u,h,4);if(h+=4,y=="IHDR")d(u,h,p);else if(y=="iCCP"){for(var S=h;u[S]!=0;)S++;x.readASCII(u,h,S-h),u[S+1];const b=u.slice(S+2,h+C);let W=null;try{W=o(b)}catch{W=n(b)}p.tabs[y]=W}else if(y=="CgBI")p.tabs[y]=u.slice(h,h+4);else if(y=="IDAT"){for(z=0;z<C;z++)A[_+z]=u[h+z];_+=C}else if(y=="acTL")p.tabs[y]={num_frames:I(u,h),num_plays:I(u,h+4)},k=new Uint8Array(u.length);else if(y=="fcTL"){D!=0&&((m=p.frames[p.frames.length-1]).data=r(p,k.slice(0,D),m.rect.width,m.rect.height),D=0);const b={x:I(u,h+12),y:I(u,h+16),width:I(u,h+4),height:I(u,h+8)};let W=v(u,h+22);W=v(u,h+20)/(W==0?100:W);const N={rect:b,delay:Math.round(1e3*W),dispose:u[h+24],blend:u[h+25]};p.frames.push(N)}else if(y=="fdAT"){for(z=0;z<C-4;z++)k[D+z]=u[h+z+4];D+=C-4}else if(y=="pHYs")p.tabs[y]=[x.readUint(u,h),x.readUint(u,h+4),u[h+8]];else if(y=="cHRM")for(p.tabs[y]=[],z=0;z<8;z++)p.tabs[y].push(x.readUint(u,h+4*z));else if(y=="tEXt"||y=="zTXt"){p.tabs[y]==null&&(p.tabs[y]={});var w=x.nextZero(u,h),M=x.readASCII(u,h,w-h),j=h+C-w-1;if(y=="tEXt")F=x.readASCII(u,w+1,j);else{var T=o(u.slice(w+2,w+2+j));F=x.readUTF8(T,0,T.length)}p.tabs[y][M]=F}else if(y=="iTXt"){p.tabs[y]==null&&(p.tabs[y]={}),w=0,S=h,w=x.nextZero(u,S),M=x.readASCII(u,S,w-S);const b=u[S=w+1];var F;u[S+1],S+=2,w=x.nextZero(u,S),x.readASCII(u,S,w-S),S=w+1,w=x.nextZero(u,S),x.readUTF8(u,S,w-S),j=C-((S=w+1)-h),b==0?F=x.readUTF8(u,S,j):(T=o(u.slice(S,S+j)),F=x.readUTF8(T,0,T.length)),p.tabs[y][M]=F}else if(y=="PLTE")p.tabs[y]=x.readBytes(u,h,C);else if(y=="hIST"){const b=p.tabs.PLTE.length/3;for(p.tabs[y]=[],z=0;z<b;z++)p.tabs[y].push(v(u,h+2*z))}else if(y=="tRNS")p.ctype==3?p.tabs[y]=x.readBytes(u,h,C):p.ctype==0?p.tabs[y]=v(u,h):p.ctype==2&&(p.tabs[y]=[v(u,h),v(u,h+2),v(u,h+4)]);else if(y=="gAMA")p.tabs[y]=x.readUint(u,h)/1e5;else if(y=="sRGB")p.tabs[y]=u[h];else if(y=="bKGD")p.ctype==0||p.ctype==4?p.tabs[y]=[v(u,h)]:p.ctype==2||p.ctype==6?p.tabs[y]=[v(u,h),v(u,h+2),v(u,h+4)]:p.ctype==3&&(p.tabs[y]=u[h]);else if(y=="IEND")break;h+=C,x.readUint(u,h),h+=4}var m;return D!=0&&((m=p.frames[p.frames.length-1]).data=r(p,k.slice(0,D),m.rect.width,m.rect.height)),p.data=r(p,A,p.width,p.height),delete p.compress,delete p.interlace,delete p.filter,p},toRGBA8:function(c){const u=c.width,h=c.height;if(c.tabs.acTL==null)return[t(c.data,u,h,c).buffer];const x=[];c.frames[0].data==null&&(c.frames[0].data=c.data);const v=u*h*4,I=new Uint8Array(v),p=new Uint8Array(v),A=new Uint8Array(v);for(let _=0;_<c.frames.length;_++){const D=c.frames[_],E=D.rect.x,z=D.rect.y,S=D.rect.width,w=D.rect.height,M=t(D.data,S,w,c);if(_!=0)for(var k=0;k<v;k++)A[k]=I[k];if(D.blend==0?f(M,S,w,I,u,h,E,z,0):D.blend==1&&f(M,S,w,I,u,h,E,z,1),x.push(I.buffer.slice(0)),D.dispose!=0){if(D.dispose==1)f(p,S,w,I,u,h,E,z,0);else if(D.dispose==2)for(k=0;k<v;k++)I[k]=A[k]}}return x},_paeth:l,_copyTile:f,_bin:e}}();(function(){const{_copyTile:e}=et,{_bin:t}=et,r=et._paeth;var o={table:function(){const S=new Uint32Array(256);for(let w=0;w<256;w++){let M=w;for(let j=0;j<8;j++)1&M?M=3988292384^M>>>1:M>>>=1;S[w]=M}return S}(),update(S,w,M,j){for(let T=0;T<j;T++)S=o.table[255&(S^w[M+T])]^S>>>8;return S},crc:(S,w,M)=>4294967295^o.update(4294967295,S,w,M)};function n(S,w,M,j){w[M]+=S[0]*j>>4,w[M+1]+=S[1]*j>>4,w[M+2]+=S[2]*j>>4,w[M+3]+=S[3]*j>>4}function i(S){return Math.max(0,Math.min(255,S))}function s(S,w){const M=S[0]-w[0],j=S[1]-w[1],T=S[2]-w[2],F=S[3]-w[3];return M*M+j*j+T*T+F*F}function l(S,w,M,j,T,F,m){m==null&&(m=1);const C=j.length,y=[];for(var b=0;b<C;b++){const H=j[b];y.push([H>>>0&255,H>>>8&255,H>>>16&255,H>>>24&255])}for(b=0;b<C;b++){let H=4294967295;for(var W=0,N=0;N<C;N++){var R=s(y[b],y[N]);N!=b&&R<H&&(H=R,W=N)}}const O=new Uint32Array(T.buffer),U=new Int16Array(w*M*4),X=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(b=0;b<X.length;b++)X[b]=255*((X[b]+.5)/16-.5);for(let H=0;H<M;H++)for(let G=0;G<w;G++){var L;b=4*(H*w+G),m!=2?L=[i(S[b]+U[b]),i(S[b+1]+U[b+1]),i(S[b+2]+U[b+2]),i(S[b+3]+U[b+3])]:(R=X[4*(3&H)+(3&G)],L=[i(S[b]+R),i(S[b+1]+R),i(S[b+2]+R),i(S[b+3]+R)]),W=0;let ee=16777215;for(N=0;N<C;N++){const te=s(L,y[N]);te<ee&&(ee=te,W=N)}const ne=y[W],J=[L[0]-ne[0],L[1]-ne[1],L[2]-ne[2],L[3]-ne[3]];m==1&&(G!=w-1&&n(J,U,b+4,7),H!=M-1&&(G!=0&&n(J,U,b+4*w-4,3),n(J,U,b+4*w,5),G!=w-1&&n(J,U,b+4*w+4,1))),F[b>>2]=W,O[b>>2]=j[W]}}function d(S,w,M,j,T){T==null&&(T={});const{crc:F}=o,m=t.writeUint,C=t.writeUshort,y=t.writeASCII;let b=8;const W=S.frames.length>1;let N,R=!1,O=33+(W?20:0);if(T.sRGB!=null&&(O+=13),T.pHYs!=null&&(O+=21),T.iCCP!=null&&(N=pako.deflate(T.iCCP),O+=21+N.length+4),S.ctype==3){for(var U=S.plte.length,X=0;X<U;X++)S.plte[X]>>>24!=255&&(R=!0);O+=8+3*U+4+(R?8+1*U+4:0)}for(var L=0;L<S.frames.length;L++)W&&(O+=38),O+=(ne=S.frames[L]).cimg.length+12,L!=0&&(O+=4);O+=12;const H=new Uint8Array(O),G=[137,80,78,71,13,10,26,10];for(X=0;X<8;X++)H[X]=G[X];if(m(H,b,13),b+=4,y(H,b,"IHDR"),b+=4,m(H,b,w),b+=4,m(H,b,M),b+=4,H[b]=S.depth,b++,H[b]=S.ctype,b++,H[b]=0,b++,H[b]=0,b++,H[b]=0,b++,m(H,b,F(H,b-17,17)),b+=4,T.sRGB!=null&&(m(H,b,1),b+=4,y(H,b,"sRGB"),b+=4,H[b]=T.sRGB,b++,m(H,b,F(H,b-5,5)),b+=4),T.iCCP!=null){const J=13+N.length;m(H,b,J),b+=4,y(H,b,"iCCP"),b+=4,y(H,b,"ICC profile"),b+=11,b+=2,H.set(N,b),b+=N.length,m(H,b,F(H,b-(J+4),J+4)),b+=4}if(T.pHYs!=null&&(m(H,b,9),b+=4,y(H,b,"pHYs"),b+=4,m(H,b,T.pHYs[0]),b+=4,m(H,b,T.pHYs[1]),b+=4,H[b]=T.pHYs[2],b++,m(H,b,F(H,b-13,13)),b+=4),W&&(m(H,b,8),b+=4,y(H,b,"acTL"),b+=4,m(H,b,S.frames.length),b+=4,m(H,b,T.loop!=null?T.loop:0),b+=4,m(H,b,F(H,b-12,12)),b+=4),S.ctype==3){for(m(H,b,3*(U=S.plte.length)),b+=4,y(H,b,"PLTE"),b+=4,X=0;X<U;X++){const J=3*X,te=S.plte[X],se=255&te,ae=te>>>8&255,ve=te>>>16&255;H[b+J+0]=se,H[b+J+1]=ae,H[b+J+2]=ve}if(b+=3*U,m(H,b,F(H,b-3*U-4,3*U+4)),b+=4,R){for(m(H,b,U),b+=4,y(H,b,"tRNS"),b+=4,X=0;X<U;X++)H[b+X]=S.plte[X]>>>24&255;b+=U,m(H,b,F(H,b-U-4,U+4)),b+=4}}let ee=0;for(L=0;L<S.frames.length;L++){var ne=S.frames[L];W&&(m(H,b,26),b+=4,y(H,b,"fcTL"),b+=4,m(H,b,ee++),b+=4,m(H,b,ne.rect.width),b+=4,m(H,b,ne.rect.height),b+=4,m(H,b,ne.rect.x),b+=4,m(H,b,ne.rect.y),b+=4,C(H,b,j[L]),b+=2,C(H,b,1e3),b+=2,H[b]=ne.dispose,b++,H[b]=ne.blend,b++,m(H,b,F(H,b-30,30)),b+=4);const J=ne.cimg;m(H,b,(U=J.length)+(L==0?0:4)),b+=4;const te=b;y(H,b,L==0?"IDAT":"fdAT"),b+=4,L!=0&&(m(H,b,ee++),b+=4),H.set(J,b),b+=U,m(H,b,F(H,te,b-te)),b+=4}return m(H,b,0),b+=4,y(H,b,"IEND"),b+=4,m(H,b,F(H,b-4,4)),b+=4,H.buffer}function f(S,w,M){for(let j=0;j<S.frames.length;j++){const T=S.frames[j];T.rect.width;const F=T.rect.height,m=new Uint8Array(F*T.bpl+F);T.cimg=h(T.img,F,T.bpp,T.bpl,m,w,M)}}function a(S,w,M,j,T){const F=T[0],m=T[1],C=T[2],y=T[3],b=T[4],W=T[5];let N=6,R=8,O=255;for(var U=0;U<S.length;U++){const de=new Uint8Array(S[U]);for(var X=de.length,L=0;L<X;L+=4)O&=de[L+3]}const H=O!=255,G=function(oe,Z,ue,ye,pe,Ie){const ge=[];for(var ce=0;ce<oe.length;ce++){const _e=new Uint8Array(oe[ce]),fe=new Uint32Array(_e.buffer);var Ae;let be=0,je=0,Ne=Z,Pe=ue,Oe=ye?1:0;if(ce!=0){const Xe=Ie||ye||ce==1||ge[ce-2].dispose!=0?1:2;let ut=0,Rt=1e9;for(let Qe=0;Qe<Xe;Qe++){var $e=new Uint8Array(oe[ce-1-Qe]);const en=new Uint32Array(oe[ce-1-Qe]);let Je=Z,Fe=ue,yt=-1,kt=-1;for(let dt=0;dt<ue;dt++)for(let ft=0;ft<Z;ft++)fe[we=dt*Z+ft]!=en[we]&&(ft<Je&&(Je=ft),ft>yt&&(yt=ft),dt<Fe&&(Fe=dt),dt>kt&&(kt=dt));yt==-1&&(Je=Fe=yt=kt=0),pe&&((1&Je)==1&&Je--,(1&Fe)==1&&Fe--);const En=(yt-Je+1)*(kt-Fe+1);En<Rt&&(Rt=En,ut=Qe,be=Je,je=Fe,Ne=yt-Je+1,Pe=kt-Fe+1)}$e=new Uint8Array(oe[ce-1-ut]),ut==1&&(ge[ce-1].dispose=2),Ae=new Uint8Array(Ne*Pe*4),e($e,Z,ue,Ae,Ne,Pe,-be,-je,0),Oe=e(_e,Z,ue,Ae,Ne,Pe,-be,-je,3)?1:0,Oe==1?u(_e,Z,ue,Ae,{x:be,y:je,width:Ne,height:Pe}):e(_e,Z,ue,Ae,Ne,Pe,-be,-je,0)}else Ae=_e.slice(0);ge.push({rect:{x:be,y:je,width:Ne,height:Pe},img:Ae,blend:Oe,dispose:0})}if(ye)for(ce=0;ce<ge.length;ce++){if((We=ge[ce]).blend==1)continue;const _e=We.rect,fe=ge[ce-1].rect,be=Math.min(_e.x,fe.x),je=Math.min(_e.y,fe.y),Ne={x:be,y:je,width:Math.max(_e.x+_e.width,fe.x+fe.width)-be,height:Math.max(_e.y+_e.height,fe.y+fe.height)-je};ge[ce-1].dispose=1,ce-1!=0&&c(oe,Z,ue,ge,ce-1,Ne,pe),c(oe,Z,ue,ge,ce,Ne,pe)}let Ye=0;if(oe.length!=1)for(var we=0;we<ge.length;we++){var We;Ye+=(We=ge[we]).rect.width*We.rect.height}return ge}(S,w,M,F,m,C),ee={},ne=[],J=[];if(j!=0){const de=[];for(L=0;L<G.length;L++)de.push(G[L].img.buffer);const oe=function(pe){let Ie=0;for(var ge=0;ge<pe.length;ge++)Ie+=pe[ge].byteLength;const ce=new Uint8Array(Ie);let Ae=0;for(ge=0;ge<pe.length;ge++){const $e=new Uint8Array(pe[ge]),Ye=$e.length;for(let we=0;we<Ye;we+=4){let We=$e[we],_e=$e[we+1],fe=$e[we+2];const be=$e[we+3];be==0&&(We=_e=fe=0),ce[Ae+we]=We,ce[Ae+we+1]=_e,ce[Ae+we+2]=fe,ce[Ae+we+3]=be}Ae+=Ye}return ce.buffer}(de),Z=v(oe,j);for(L=0;L<Z.plte.length;L++)ne.push(Z.plte[L].est.rgba);let ue=0;for(L=0;L<G.length;L++){const ye=(se=G[L]).img.length;var te=new Uint8Array(Z.inds.buffer,ue>>2,ye>>2);J.push(te);const pe=new Uint8Array(Z.abuf,ue,ye);W&&l(se.img,se.rect.width,se.rect.height,ne,pe,te),se.img.set(pe),ue+=ye}}else for(U=0;U<G.length;U++){var se=G[U];const de=new Uint32Array(se.img.buffer);var ae=se.rect.width;for(X=de.length,te=new Uint8Array(X),J.push(te),L=0;L<X;L++){const oe=de[L];if(L!=0&&oe==de[L-1])te[L]=te[L-1];else if(L>ae&&oe==de[L-ae])te[L]=te[L-ae];else{let Z=ee[oe];if(Z==null&&(ee[oe]=Z=ne.length,ne.push(oe),ne.length>=300))break;te[L]=Z}}}const ve=ne.length;for(ve<=256&&b==0&&(R=ve<=2?1:ve<=4?2:ve<=16?4:8,R=Math.max(R,y)),U=0;U<G.length;U++){(se=G[U]).rect.x,se.rect.y,ae=se.rect.width;const de=se.rect.height;let oe=se.img;new Uint32Array(oe.buffer);let Z=4*ae,ue=4;if(ve<=256&&b==0){Z=Math.ceil(R*ae/8);var he=new Uint8Array(Z*de);const ye=J[U];for(let pe=0;pe<de;pe++){L=pe*Z;const Ie=pe*ae;if(R==8)for(var ie=0;ie<ae;ie++)he[L+ie]=ye[Ie+ie];else if(R==4)for(ie=0;ie<ae;ie++)he[L+(ie>>1)]|=ye[Ie+ie]<<4-4*(1&ie);else if(R==2)for(ie=0;ie<ae;ie++)he[L+(ie>>2)]|=ye[Ie+ie]<<6-2*(3&ie);else if(R==1)for(ie=0;ie<ae;ie++)he[L+(ie>>3)]|=ye[Ie+ie]<<7-1*(7&ie)}oe=he,N=3,ue=1}else if(H==0&&G.length==1){he=new Uint8Array(ae*de*3);const ye=ae*de;for(L=0;L<ye;L++){const pe=3*L,Ie=4*L;he[pe]=oe[Ie],he[pe+1]=oe[Ie+1],he[pe+2]=oe[Ie+2]}oe=he,N=2,ue=3,Z=3*ae}se.img=oe,se.bpl=Z,se.bpp=ue}return{ctype:N,depth:R,plte:ne,frames:G}}function c(S,w,M,j,T,F,m){const C=Uint8Array,y=Uint32Array,b=new C(S[T-1]),W=new y(S[T-1]),N=T+1<S.length?new C(S[T+1]):null,R=new C(S[T]),O=new y(R.buffer);let U=w,X=M,L=-1,H=-1;for(let ee=0;ee<F.height;ee++)for(let ne=0;ne<F.width;ne++){const J=F.x+ne,te=F.y+ee,se=te*w+J,ae=O[se];ae==0||j[T-1].dispose==0&&W[se]==ae&&(N==null||N[4*se+3]!=0)||(J<U&&(U=J),J>L&&(L=J),te<X&&(X=te),te>H&&(H=te))}L==-1&&(U=X=L=H=0),m&&((1&U)==1&&U--,(1&X)==1&&X--),F={x:U,y:X,width:L-U+1,height:H-X+1};const G=j[T];G.rect=F,G.blend=1,G.img=new Uint8Array(F.width*F.height*4),j[T-1].dispose==0?(e(b,w,M,G.img,F.width,F.height,-F.x,-F.y,0),u(R,w,M,G.img,F)):e(R,w,M,G.img,F.width,F.height,-F.x,-F.y,0)}function u(S,w,M,j,T){e(S,w,M,j,T.width,T.height,-T.x,-T.y,2)}function h(S,w,M,j,T,F,m){const C=[];let y,b=[0,1,2,3,4];F!=-1?b=[F]:(w*j>5e5||M==1)&&(b=[0]),m&&(y={level:0});const W=I0;for(var N=0;N<b.length;N++){for(let U=0;U<w;U++)x(T,S,U,j,M,b[N]);C.push(W.deflate(T,y))}let R,O=1e9;for(N=0;N<C.length;N++)C[N].length<O&&(R=N,O=C[N].length);return C[R]}function x(S,w,M,j,T,F){const m=M*j;let C=m+M;if(S[C]=F,C++,F==0)if(j<500)for(var y=0;y<j;y++)S[C+y]=w[m+y];else S.set(new Uint8Array(w.buffer,m,j),C);else if(F==1){for(y=0;y<T;y++)S[C+y]=w[m+y];for(y=T;y<j;y++)S[C+y]=w[m+y]-w[m+y-T]+256&255}else if(M==0){for(y=0;y<T;y++)S[C+y]=w[m+y];if(F==2)for(y=T;y<j;y++)S[C+y]=w[m+y];if(F==3)for(y=T;y<j;y++)S[C+y]=w[m+y]-(w[m+y-T]>>1)+256&255;if(F==4)for(y=T;y<j;y++)S[C+y]=w[m+y]-r(w[m+y-T],0,0)+256&255}else{if(F==2)for(y=0;y<j;y++)S[C+y]=w[m+y]+256-w[m+y-j]&255;if(F==3){for(y=0;y<T;y++)S[C+y]=w[m+y]+256-(w[m+y-j]>>1)&255;for(y=T;y<j;y++)S[C+y]=w[m+y]+256-(w[m+y-j]+w[m+y-T]>>1)&255}if(F==4){for(y=0;y<T;y++)S[C+y]=w[m+y]+256-r(0,w[m+y-j],0)&255;for(y=T;y<j;y++)S[C+y]=w[m+y]+256-r(w[m+y-T],w[m+y-j],w[m+y-T-j])&255}}}function v(S,w){const M=new Uint8Array(S),j=M.slice(0),T=new Uint32Array(j.buffer),F=I(j,w),m=F[0],C=F[1],y=M.length,b=new Uint8Array(y>>2);let W;if(M.length<2e7)for(var N=0;N<y;N+=4)W=p(m,R=M[N]*(1/255),O=M[N+1]*(1/255),U=M[N+2]*(1/255),X=M[N+3]*(1/255)),b[N>>2]=W.ind,T[N>>2]=W.est.rgba;else for(N=0;N<y;N+=4){var R=M[N]*.00392156862745098,O=M[N+1]*(1/255),U=M[N+2]*(1/255),X=M[N+3]*(1/255);for(W=m;W.left;)W=A(W.est,R,O,U,X)<=0?W.left:W.right;b[N>>2]=W.ind,T[N>>2]=W.est.rgba}return{abuf:j.buffer,inds:b,plte:C}}function I(S,w,M){M==null&&(M=1e-4);const j=new Uint32Array(S.buffer),T={i0:0,i1:S.length,bst:null,est:null,tdst:0,left:null,right:null};T.bst=D(S,T.i0,T.i1),T.est=E(T.bst);const F=[T];for(;F.length<w;){let C=0,y=0;for(var m=0;m<F.length;m++)F[m].est.L>C&&(C=F[m].est.L,y=m);if(C<M)break;const b=F[y],W=k(S,j,b.i0,b.i1,b.est.e,b.est.eMq255);if(b.i0>=W||b.i1<=W){b.est.L=0;continue}const N={i0:b.i0,i1:W,bst:null,est:null,tdst:0,left:null,right:null};N.bst=D(S,N.i0,N.i1),N.est=E(N.bst);const R={i0:W,i1:b.i1,bst:null,est:null,tdst:0,left:null,right:null};for(R.bst={R:[],m:[],N:b.bst.N-N.bst.N},m=0;m<16;m++)R.bst.R[m]=b.bst.R[m]-N.bst.R[m];for(m=0;m<4;m++)R.bst.m[m]=b.bst.m[m]-N.bst.m[m];R.est=E(R.bst),b.left=N,b.right=R,F[y]=N,F.push(R)}for(F.sort((C,y)=>y.bst.N-C.bst.N),m=0;m<F.length;m++)F[m].ind=m;return[T,F]}function p(S,w,M,j,T){if(S.left==null)return S.tdst=function(N,R,O,U,X){const L=R-N[0],H=O-N[1],G=U-N[2],ee=X-N[3];return L*L+H*H+G*G+ee*ee}(S.est.q,w,M,j,T),S;const F=A(S.est,w,M,j,T);let m=S.left,C=S.right;F>0&&(m=S.right,C=S.left);const y=p(m,w,M,j,T);if(y.tdst<=F*F)return y;const b=p(C,w,M,j,T);return b.tdst<y.tdst?b:y}function A(S,w,M,j,T){const{e:F}=S;return F[0]*w+F[1]*M+F[2]*j+F[3]*T-S.eMq}function k(S,w,M,j,T,F){for(j-=4;M<j;){for(;_(S,M,T)<=F;)M+=4;for(;_(S,j,T)>F;)j-=4;if(M>=j)break;const m=w[M>>2];w[M>>2]=w[j>>2],w[j>>2]=m,M+=4,j-=4}for(;_(S,M,T)>F;)M-=4;return M+4}function _(S,w,M){return S[w]*M[0]+S[w+1]*M[1]+S[w+2]*M[2]+S[w+3]*M[3]}function D(S,w,M){const j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T=[0,0,0,0],F=M-w>>2;for(let m=w;m<M;m+=4){const C=S[m]*.00392156862745098,y=S[m+1]*(1/255),b=S[m+2]*(1/255),W=S[m+3]*(1/255);T[0]+=C,T[1]+=y,T[2]+=b,T[3]+=W,j[0]+=C*C,j[1]+=C*y,j[2]+=C*b,j[3]+=C*W,j[5]+=y*y,j[6]+=y*b,j[7]+=y*W,j[10]+=b*b,j[11]+=b*W,j[15]+=W*W}return j[4]=j[1],j[8]=j[2],j[9]=j[6],j[12]=j[3],j[13]=j[7],j[14]=j[11],{R:j,m:T,N:F}}function E(S){const{R:w}=S,{m:M}=S,{N:j}=S,T=M[0],F=M[1],m=M[2],C=M[3],y=j==0?0:1/j,b=[w[0]-T*T*y,w[1]-T*F*y,w[2]-T*m*y,w[3]-T*C*y,w[4]-F*T*y,w[5]-F*F*y,w[6]-F*m*y,w[7]-F*C*y,w[8]-m*T*y,w[9]-m*F*y,w[10]-m*m*y,w[11]-m*C*y,w[12]-C*T*y,w[13]-C*F*y,w[14]-C*m*y,w[15]-C*C*y],W=b,N=z;let R=[Math.random(),Math.random(),Math.random(),Math.random()],O=0,U=0;if(j!=0)for(let L=0;L<16&&(R=N.multVec(W,R),U=Math.sqrt(N.dot(R,R)),R=N.sml(1/U,R),!(L!=0&&Math.abs(U-O)<1e-9));L++)O=U;const X=[T*y,F*y,m*y,C*y];return{Cov:b,q:X,e:R,L:O,eMq255:N.dot(N.sml(255,X),R),eMq:N.dot(R,X),rgba:(Math.round(255*X[3])<<24|Math.round(255*X[2])<<16|Math.round(255*X[1])<<8|Math.round(255*X[0])<<0)>>>0}}var z={multVec:(S,w)=>[S[0]*w[0]+S[1]*w[1]+S[2]*w[2]+S[3]*w[3],S[4]*w[0]+S[5]*w[1]+S[6]*w[2]+S[7]*w[3],S[8]*w[0]+S[9]*w[1]+S[10]*w[2]+S[11]*w[3],S[12]*w[0]+S[13]*w[1]+S[14]*w[2]+S[15]*w[3]],dot:(S,w)=>S[0]*w[0]+S[1]*w[1]+S[2]*w[2]+S[3]*w[3],sml:(S,w)=>[S*w[0],S*w[1],S*w[2],S*w[3]]};et.encode=function(w,M,j,T,F,m,C){T==null&&(T=0),C==null&&(C=!1);const y=a(w,M,j,T,[!1,!1,!1,0,C,!1]);return f(y,-1),d(y,M,j,F,m)},et.encodeLL=function(w,M,j,T,F,m,C,y){const b={ctype:0+(T==1?0:2)+(F==0?0:4),depth:m,frames:[]},W=(T+F)*m,N=W*M;for(let R=0;R<w.length;R++)b.frames.push({rect:{x:0,y:0,width:M,height:j},img:new Uint8Array(w[R]),blend:0,dispose:1,bpp:Math.ceil(W/8),bpl:Math.ceil(N/8)});return f(b,0,!0),d(b,M,j,C,y)},et.encode.compress=a,et.encode.dither=l,et.quantize=v,et.quantize.getKDtree=I,et.quantize.getNearest=p})();const pa={toArrayBuffer(e,t){const r=e.width,o=e.height,n=r<<2,i=e.getContext("2d").getImageData(0,0,r,o),s=new Uint32Array(i.data.buffer),l=(32*r+31)/32<<2,d=l*o,f=122+d,a=new ArrayBuffer(f),c=new DataView(a),u=1<<20;let h,x,v,I,p=u,A=0,k=0,_=0;function D(S){c.setUint16(k,S,!0),k+=2}function E(S){c.setUint32(k,S,!0),k+=4}function z(S){k+=S}D(19778),E(f),z(4),E(122),E(108),E(r),E(-o>>>0),D(1),D(32),E(3),E(d),E(2835),E(2835),z(8),E(16711680),E(65280),E(255),E(4278190080),E(1466527264),function S(){for(;A<o&&p>0;){for(I=122+A*l,h=0;h<n;)p--,x=s[_++],v=x>>>24,c.setUint32(I+h,x<<8|v),h+=4;A++}_<s.length?(p=u,setTimeout(S,pa._dly)):t(a)}()},toBlob(e,t){this.toArrayBuffer(e,r=>{t(new Blob([r],{type:"image/bmp"}))})},_dly:9};var He={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},A0={[He.CHROME]:16384,[He.FIREFOX]:11180,[He.DESKTOP_SAFARI]:16384,[He.IE]:8192,[He.IOS]:4096,[He.ETC]:8192};const ho=typeof window<"u",ma=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,er=ho&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),k0=(ho||ma)&&(er&&er.getOriginalSymbol(window,"File")||typeof File<"u"&&File),xa=(ho||ma)&&(er&&er.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function go(e,t,r=Date.now()){return new Promise(o=>{const n=e.split(","),i=n[0].match(/:(.*?);/)[1],s=globalThis.atob(n[1]);let l=s.length;const d=new Uint8Array(l);for(;l--;)d[l]=s.charCodeAt(l);const f=new Blob([d],{type:i});f.name=t,f.lastModified=r,o(f)})}function ya(e){return new Promise((t,r)=>{const o=new xa;o.onload=()=>t(o.result),o.onerror=n=>r(n),o.readAsDataURL(e)})}function ba(e){return new Promise((t,r)=>{const o=new Image;o.onload=()=>t(o),o.onerror=n=>r(n),o.src=e})}function zt(){if(zt.cachedResult!==void 0)return zt.cachedResult;let e=He.ETC;const{userAgent:t}=navigator;return/Chrom(e|ium)/i.test(t)?e=He.CHROME:/iP(ad|od|hone)/i.test(t)&&/WebKit/i.test(t)?e=He.IOS:/Safari/i.test(t)?e=He.DESKTOP_SAFARI:/Firefox/i.test(t)?e=He.FIREFOX:(/MSIE/i.test(t)||document.documentMode)&&(e=He.IE),zt.cachedResult=e,zt.cachedResult}function va(e,t){const r=zt(),o=A0[r];let n=e,i=t,s=n*i;const l=n>i?i/n:n/i;for(;s>o*o;){const d=(o+n)/2,f=(o+i)/2;d<f?(i=f,n=f*l):(i=d*l,n=d),s=n*i}return{width:n,height:i}}function gr(e,t){let r,o;try{if(r=new OffscreenCanvas(e,t),o=r.getContext("2d"),o===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{r=document.createElement("canvas"),o=r.getContext("2d")}return r.width=e,r.height=t,[r,o]}function wa(e,t){const{width:r,height:o}=va(e.width,e.height),[n,i]=gr(r,o);return t&&/jpe?g/.test(t)&&(i.fillStyle="white",i.fillRect(0,0,n.width,n.height)),i.drawImage(e,0,0,n.width,n.height),n}function Rn(){return Rn.cachedResult!==void 0||(Rn.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Rn.cachedResult}function tr(e,t={}){return new Promise(function(r,o){let n,i;var s=function(){try{return i=wa(n,t.fileType||e.type),r([n,i])}catch(d){return o(d)}},l=function(d){try{var f=function(a){try{throw a}catch(c){return o(c)}};try{let a;return ya(e).then(function(c){try{return a=c,ba(a).then(function(u){try{return n=u,function(){try{return s()}catch(h){return o(h)}}()}catch(h){return f(h)}},f)}catch(u){return f(u)}},f)}catch(a){f(a)}}catch(a){return o(a)}};try{if(Rn()||[He.DESKTOP_SAFARI,He.MOBILE_SAFARI].includes(zt()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(e).then(function(d){try{return n=d,s()}catch{return l()}},l)}catch{l()}})}function nr(e,t,r,o,n=1){return new Promise(function(i,s){let l;if(t==="image/png"){let f,a,c;return f=e.getContext("2d"),{data:a}=f.getImageData(0,0,e.width,e.height),c=et.encode([a.buffer],e.width,e.height,4096*n),l=new Blob([c],{type:t}),l.name=r,l.lastModified=o,d.call(this)}{let f=function(){return d.call(this)};if(t==="image/bmp")return new Promise(a=>pa.toBlob(e,a)).then((function(a){try{return l=a,l.name=r,l.lastModified=o,f.call(this)}catch(c){return s(c)}}).bind(this),s);{let a=function(){return f.call(this)};if(typeof OffscreenCanvas=="function"&&e instanceof OffscreenCanvas)return e.convertToBlob({type:t,quality:n}).then((function(c){try{return l=c,l.name=r,l.lastModified=o,a.call(this)}catch(u){return s(u)}}).bind(this),s);{let c;return c=e.toDataURL(t,n),go(c,r,o).then((function(u){try{return l=u,a.call(this)}catch(h){return s(h)}}).bind(this),s)}}}function d(){return i(l)}})}function st(e){e.width=0,e.height=0}function Lt(){return new Promise(function(e,t){let r,o,n,i;return Lt.cachedResult!==void 0?e(Lt.cachedResult):go("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(s){try{return r=s,tr(r).then(function(l){try{return o=l[1],nr(o,r.type,r.name,r.lastModified).then(function(d){try{return n=d,st(o),tr(n).then(function(f){try{return i=f[0],Lt.cachedResult=i.width===1&&i.height===2,e(Lt.cachedResult)}catch(a){return t(a)}},t)}catch(f){return t(f)}},t)}catch(d){return t(d)}},t)}catch(l){return t(l)}},t)})}function Sa(e){return new Promise((t,r)=>{const o=new xa;o.onload=n=>{const i=new DataView(n.target.result);if(i.getUint16(0,!1)!=65496)return t(-2);const s=i.byteLength;let l=2;for(;l<s;){if(i.getUint16(l+2,!1)<=8)return t(-1);const d=i.getUint16(l,!1);if(l+=2,d==65505){if(i.getUint32(l+=2,!1)!=1165519206)return t(-1);const f=i.getUint16(l+=6,!1)==18761;l+=i.getUint32(l+4,f);const a=i.getUint16(l,f);l+=2;for(let c=0;c<a;c++)if(i.getUint16(l+12*c,f)==274)return t(i.getUint16(l+12*c+8,f))}else{if((65280&d)!=65280)break;l+=i.getUint16(l,!1)}}return t(-1)},o.onerror=n=>r(n),o.readAsArrayBuffer(e)})}function Ea(e,t){const{width:r}=e,{height:o}=e,{maxWidthOrHeight:n}=t;let i,s=e;return isFinite(n)&&(r>n||o>n)&&([s,i]=gr(r,o),r>o?(s.width=n,s.height=o/r*n):(s.width=r/o*n,s.height=n),i.drawImage(e,0,0,s.width,s.height),st(e)),s}function Ca(e,t){const{width:r}=e,{height:o}=e,[n,i]=gr(r,o);switch(t>4&&t<9?(n.width=o,n.height=r):(n.width=r,n.height=o),t){case 2:i.transform(-1,0,0,1,r,0);break;case 3:i.transform(-1,0,0,-1,r,o);break;case 4:i.transform(1,0,0,-1,0,o);break;case 5:i.transform(0,1,1,0,0,0);break;case 6:i.transform(0,1,-1,0,o,0);break;case 7:i.transform(0,-1,-1,0,o,r);break;case 8:i.transform(0,-1,1,0,0,r)}return i.drawImage(e,0,0,r,o),st(e),n}function di(e,t,r=0){return new Promise(function(o,n){let i,s,l,d,f,a,c,u,h,x,v,I,p,A,k,_,D,E,z,S;function w(j=5){if(t.signal&&t.signal.aborted)throw t.signal.reason;i+=j,t.onProgress(Math.min(i,100))}function M(j){if(t.signal&&t.signal.aborted)throw t.signal.reason;i=Math.min(Math.max(j,i),100),t.onProgress(i)}return i=r,s=t.maxIteration||10,l=1024*t.maxSizeMB*1024,w(),tr(e,t).then((function(j){try{return[,d]=j,w(),f=Ea(d,t),w(),new Promise(function(T,F){var m;if(!(m=t.exifOrientation))return Sa(e).then((function(y){try{return m=y,C.call(this)}catch(b){return F(b)}}).bind(this),F);function C(){return T(m)}return C.call(this)}).then((function(T){try{return a=T,w(),Lt().then((function(F){try{return c=F?f:Ca(f,a),w(),u=t.initialQuality||1,h=t.fileType||e.type,nr(c,h,e.name,e.lastModified,u).then((function(m){try{{let y=function(){if(s--&&(k>l||k>p)){let W,N;return W=S?.95*z.width:z.width,N=S?.95*z.height:z.height,[D,E]=gr(W,N),E.drawImage(z,0,0,W,N),u*=h==="image/png"?.85:.95,nr(D,h,e.name,e.lastModified,u).then(function(R){try{return _=R,st(z),z=D,k=_.size,M(Math.min(99,Math.floor((A-k)/(A-l)*100))),y}catch(O){return n(O)}},n)}return[1]},b=function(){return st(z),st(D),st(f),st(c),st(d),M(100),o(_)};if(x=m,w(),v=x.size>l,I=x.size>e.size,!v&&!I)return M(100),o(x);var C;return p=e.size,A=x.size,k=A,z=c,S=!t.alwaysKeepResolution&&v,(C=(function(W){for(;W;){if(W.then)return void W.then(C,n);try{if(W.pop){if(W.length)return W.pop()?b.call(this):W;W=y}else W=W.call(this)}catch(N){return n(N)}}}).bind(this))(y)}}catch(y){return n(y)}}).bind(this),n)}catch(m){return n(m)}}).bind(this),n)}catch(F){return n(F)}}).bind(this),n)}catch(T){return n(T)}}).bind(this),n)})}const N0=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let jr;function j0(e,t){return new Promise((r,o)=>{jr||(jr=function(s){const l=[];return l.push(s),URL.createObjectURL(new Blob(l))}(N0));const n=new Worker(jr);n.addEventListener("message",function(s){if(t.signal&&t.signal.aborted)n.terminate();else if(s.data.progress===void 0){if(s.data.error)return o(new Error(s.data.error)),void n.terminate();r(s.data.file),n.terminate()}else t.onProgress(s.data.progress)}),n.addEventListener("error",o),t.signal&&t.signal.addEventListener("abort",()=>{o(t.signal.reason),n.terminate()}),n.postMessage({file:e,imageCompressionLibUrl:t.libURL,options:{...t,onProgress:void 0,signal:void 0}})})}function Re(e,t){return new Promise(function(r,o){let n,i,s,l,d,f;if(n={...t},s=0,{onProgress:l}=n,n.maxSizeMB=n.maxSizeMB||Number.POSITIVE_INFINITY,d=typeof n.useWebWorker!="boolean"||n.useWebWorker,delete n.useWebWorker,n.onProgress=h=>{s=h,typeof l=="function"&&l(s)},!(e instanceof Blob||e instanceof k0))return o(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(e.type))return o(new Error("The file given is not an image"));if(f=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!d||typeof Worker!="function"||f)return di(e,n).then((function(h){try{return i=h,u.call(this)}catch(x){return o(x)}}).bind(this),o);var a=(function(){try{return u.call(this)}catch(h){return o(h)}}).bind(this),c=function(h){try{return di(e,n).then(function(x){try{return i=x,a()}catch(v){return o(v)}},o)}catch(x){return o(x)}};try{return n.libURL=n.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",j0(e,n).then(function(h){try{return i=h,a()}catch{return c()}},c)}catch{c()}function u(){try{i.name=e.name,i.lastModified=e.lastModified}catch{}try{n.preserveExif&&e.type==="image/jpeg"&&(!n.fileType||n.fileType&&n.fileType===e.type)&&(i=ga(e,i))}catch{}return r(i)}})}Re.getDataUrlFromFile=ya,Re.getFilefromDataUrl=go,Re.loadImage=ba,Re.drawImageInCanvas=wa,Re.drawFileInCanvas=tr,Re.canvasToFile=nr,Re.getExifOrientation=Sa,Re.handleMaxWidthOrHeight=Ea,Re.followExifOrientation=Ca,Re.cleanupCanvasMemory=st,Re.isAutoOrientationInBrowser=Lt,Re.approximateBelowMaximumCanvasSizeOfBrowser=va,Re.copyExifWithoutOrientation=ga,Re.getBrowserName=zt,Re.version="2.0.2";const _a=({images:e,onImagesChange:t,storagePath:r,disabled:o=!1})=>{const[n,i]=P.useState(!1),[s,l]=P.useState(0),[d,f]=P.useState(null),[a,c]=P.useState(null),u=P.useRef(null),h=async p=>{const A=Array.from(p.target.files||[]);if(A.length!==0){i(!0),c(null),l(0);try{const k=Bn(),_=[];for(let D=0;D<A.length;D++){const E=A[D];let z=E;E.size>1024*1024&&(z=await Re(E,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0}));const S=`${Date.now()}_${Mr()}.${z.type.split("/")[1]}`,w=`${r}/${S}`,M=Ln(k,w),j=Di(M,z);await new Promise((T,F)=>{j.on("state_changed",m=>{const C=(D+m.bytesTransferred/m.totalBytes)/A.length*100;l(C)},m=>{console.error("Upload error:",m),F(m)},async()=>{const m=await $i(j.snapshot.ref);_.push({url:m,path:w,title:E.name.replace(/\.[^/.]+$/,"")}),T()})})}t([...e,..._])}catch(k){console.error("Error uploading images:",k),c("Failed to upload images. Please try again.")}finally{i(!1),l(0),u.current&&(u.current.value="")}}},x=async p=>{const A=e[p];try{const k=Bn(),_=Ln(k,A.path);await Fi(_);const D=e.filter((E,z)=>z!==p);t(D)}catch(k){console.error("Error deleting image:",k),c("Failed to delete image. It may have been already deleted.");const _=e.filter((D,E)=>E!==p);t(_)}},v=P.useCallback((p,A)=>{const k=[...e];k[p]={...k[p],title:A},t(k)},[e,t]),I=p=>{f(p)};return g.jsxs(Y,{children:[g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:B[3]},children:[g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:B[2]},children:[g.jsx(Pn,{sx:{color:$.text.tertiary}}),g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.semibold,color:$.text.primary},children:"Images"}),g.jsxs(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm},children:[e.length," ",e.length===1?"image":"images"]})]}),g.jsx(Se,{variant:"outlined",startIcon:g.jsx(_i,{}),onClick:()=>{var p;return(p=u.current)==null?void 0:p.click()},disabled:o||n,sx:{borderRadius:Ee.md,textTransform:"none",fontWeight:q.fontWeight.medium},children:"Upload Images"}),g.jsx("input",{ref:u,type:"file",accept:"image/*",multiple:!0,style:{display:"none"},onChange:h,disabled:o})]}),n&&g.jsxs(Y,{sx:{mb:B[3]},children:[g.jsx(Ii,{variant:"determinate",value:s}),g.jsxs(K,{variant:"caption",sx:{color:$.text.tertiary,mt:B[1],display:"block"},children:["Uploading... ",Math.round(s),"%"]})]}),a&&g.jsx(ot,{severity:"error",onClose:()=>c(null),sx:{mb:B[3]},children:a}),e.length>0?g.jsx(Wn,{container:!0,spacing:B[2],children:e.map((p,A)=>g.jsx(Wn,{item:!0,xs:12,sm:6,md:4,children:g.jsxs(fi,{sx:{borderRadius:Ee.lg,boxShadow:rt.sm,transition:"all 0.2s","&:hover":{boxShadow:rt.md}},children:[g.jsx(hi,{component:"img",height:"160",image:p.url,alt:p.title,sx:{objectFit:"cover",cursor:"pointer"},onClick:()=>I(p)}),g.jsx(gi,{sx:{p:B[2]},children:g.jsx(Ft,{fullWidth:!0,size:"small",placeholder:"Image title...",value:p.title,onChange:k=>v(A,k.target.value),disabled:o,sx:{"& .MuiInputBase-root":{fontSize:q.fontSize.sm}}})}),g.jsxs(al,{sx:{px:B[2],pb:B[2],pt:0,justifyContent:"space-between"},children:[g.jsx(Hn,{title:"View fullscreen",children:g.jsx(me,{size:"small",onClick:()=>I(p),children:g.jsx(bn,{fontSize:"small"})})}),g.jsx(Hn,{title:"Delete image",children:g.jsx(me,{size:"small",onClick:()=>x(A),disabled:o,sx:{color:$.error,"&:hover":{backgroundColor:"#FEE2E2"}},children:g.jsx(or,{fontSize:"small"})})})]})]})},A))}):g.jsxs(Y,{sx:{border:`2px dashed ${$.neutral[300]}`,borderRadius:Ee.lg,p:B[6],textAlign:"center",backgroundColor:$.background.secondary},children:[g.jsx(Pn,{sx:{fontSize:48,color:$.text.tertiary,mb:B[2]}}),g.jsx(K,{variant:"body1",sx:{color:$.text.secondary,mb:B[1]},children:"No images yet"}),g.jsxs(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm},children:['Click "Upload Images" to add images to this ',r.includes("design")?"design":r.includes("build")?"build":"test"]})]}),g.jsx(Jt,{open:!!d,onClose:()=>f(null),maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{backgroundColor:$.background.primary,borderRadius:Ee.xl}},children:g.jsx(pi,{sx:{p:0,position:"relative"},children:d&&g.jsxs(g.Fragment,{children:[g.jsx(me,{onClick:()=>f(null),sx:{position:"absolute",top:B[2],right:B[2],backgroundColor:"rgba(0, 0, 0, 0.5)",color:"#fff","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"},zIndex:1},children:g.jsx(lt,{})}),g.jsx("img",{src:d.url,alt:d.title,style:{width:"100%",height:"auto",display:"block"}}),d.title&&g.jsx(Y,{sx:{p:B[3],backgroundColor:$.background.secondary},children:g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.display,color:$.text.primary},children:d.title})})]})})})]})},M0=e=>{var r;switch((r=e.split(".").pop())==null?void 0:r.toLowerCase()){case"pdf":return g.jsx(Ci,{sx:{color:"#D32F2F"}});case"doc":case"docx":return g.jsx(Un,{sx:{color:"#1976D2"}});case"xls":case"xlsx":case"csv":return g.jsx(Ei,{sx:{color:"#2E7D32"}});case"txt":case"md":return g.jsx(Un,{sx:{color:$.text.secondary}});case"json":case"xml":case"html":case"css":case"js":case"ts":return g.jsx(Si,{sx:{color:"#F57C00"}});case"zip":case"rar":case"7z":return g.jsx(wi,{sx:{color:"#5E35B1"}});default:return g.jsx(qt,{sx:{color:$.text.tertiary}})}},Ia=({files:e,onFilesChange:t,storagePath:r,disabled:o=!1,maxFileSize:n=10,allowedTypes:i=[]})=>{const[s,l]=P.useState(!1),[d,f]=P.useState(0),[a,c]=P.useState(""),[u,h]=P.useState(null),x=P.useRef(null),v=P.useCallback(A=>{var _;const k=n*1024*1024;if(A.size>k)return`File size exceeds ${n}MB limit`;if(i.length>0){const D=`.${(_=A.name.split(".").pop())==null?void 0:_.toLowerCase()}`;if(!i.some(z=>z.startsWith(".")?z.toLowerCase()===D:A.type===z))return`File type not allowed. Allowed types: ${i.join(", ")}`}return null},[n,i]),I=async A=>{const k=Array.from(A.target.files||[]);if(k.length!==0){l(!0),h(null),f(0);try{const _=Bn(),D=[];for(let E=0;E<k.length;E++){const z=k[E];c(z.name);const S=v(z);if(S){h(S);continue}const w=z.name.split(".").pop(),M=`${Date.now()}_${Mr()}.${w}`,j=`${r}/files/${M}`,T=Ln(_,j),F=Di(T,z);await new Promise((m,C)=>{F.on("state_changed",y=>{const b=(E+y.bytesTransferred/y.totalBytes)/k.length*100;f(b)},y=>{console.error("Upload error:",y),C(y)},async()=>{const y=await $i(F.snapshot.ref);D.push({id:Mr(),url:y,name:z.name,path:j}),m()})})}t([...e,...D])}catch(_){console.error("Error uploading files:",_),h("Failed to upload files. Please try again.")}finally{l(!1),f(0),c(""),x.current&&(x.current.value="")}}},p=async A=>{const k=e[A];try{const _=Bn(),D=Ln(_,k.path);await Fi(D);const E=e.filter((z,S)=>S!==A);t(E)}catch(_){console.error("Error deleting file:",_),h("Failed to delete file. It may have been already deleted.");const D=e.filter((E,z)=>z!==A);t(D)}};return g.jsxs(Y,{children:[g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:B[3]},children:[g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:B[2]},children:[g.jsx(qt,{sx:{color:$.text.tertiary}}),g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.semibold,color:$.text.primary},children:"Files"}),g.jsxs(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm},children:[e.length," ",e.length===1?"file":"files"]})]}),g.jsx(Se,{variant:"outlined",startIcon:g.jsx(_i,{}),onClick:()=>{var A;return(A=x.current)==null?void 0:A.click()},disabled:o||s,sx:{borderRadius:Ee.md,textTransform:"none",fontWeight:q.fontWeight.medium},children:"Upload Files"}),g.jsx("input",{ref:x,type:"file",multiple:!0,style:{display:"none"},onChange:I,disabled:o,accept:i.length>0?i.join(","):void 0})]}),s&&g.jsxs(Y,{sx:{mb:B[3]},children:[g.jsxs(K,{variant:"caption",sx:{color:$.text.secondary,mb:B[1],display:"block"},children:["Uploading ",a,"..."]}),g.jsx(Ii,{variant:"determinate",value:d}),g.jsxs(K,{variant:"caption",sx:{color:$.text.tertiary,mt:B[1],display:"block"},children:[Math.round(d),"%"]})]}),u&&g.jsx(ot,{severity:"error",onClose:()=>h(null),sx:{mb:B[3]},children:u}),e.length>0?g.jsx(mi,{sx:{border:`1px solid ${$.neutral[200]}`,borderRadius:Ee.lg,backgroundColor:$.background.secondary,overflow:"hidden"},children:e.map((A,k)=>{var _;return g.jsxs(xi,{sx:{borderBottom:k<e.length-1?`1px solid ${$.neutral[200]}`:"none","&:hover":{backgroundColor:$.neutral[50]}},children:[g.jsx(yi,{children:M0(A.name)}),g.jsx(bi,{primary:g.jsx(K,{variant:"body2",sx:{fontWeight:q.fontWeight.medium,color:$.text.primary},children:A.name}),secondary:g.jsxs(K,{variant:"caption",sx:{color:$.text.tertiary},children:[(_=A.name.split(".").pop())==null?void 0:_.toUpperCase()," file"]})}),g.jsx(vi,{children:g.jsx(me,{edge:"end",onClick:()=>p(k),disabled:o,sx:{color:$.error,"&:hover":{backgroundColor:"#FEE2E2"}},children:g.jsx(or,{})})})]},A.id)})}):g.jsxs(Y,{sx:{border:`2px dashed ${$.neutral[300]}`,borderRadius:Ee.lg,p:B[6],textAlign:"center",backgroundColor:$.background.secondary},children:[g.jsx(qt,{sx:{fontSize:48,color:$.text.tertiary,mb:B[2]}}),g.jsx(K,{variant:"body1",sx:{color:$.text.secondary,mb:B[1]},children:"No files attached"}),g.jsx(K,{variant:"body2",sx:{color:$.text.tertiary,fontSize:q.fontSize.sm},children:'Click "Upload Files" to attach documents, data files, or other resources'}),n&&g.jsx(rr,{label:`Max file size: ${n}MB`,size:"small",sx:{mt:B[2]}})]})]})},z0=()=>{const e=Q(j=>j.selectedNodeId),t=Q(j=>j.getNodeById),r=Q(j=>j.setActivePanel),o=Q(j=>j.setIsExpanded),n=Q(j=>j.fetchAllData),i=e?t(e):null,[s,l]=P.useState(""),[d,f]=P.useState(""),[a,c]=P.useState(""),[u,h]=P.useState(""),[x,v]=P.useState([]),[I,p]=P.useState([]),[A,k]=P.useState(!1),[_,D]=P.useState(null);if(P.useEffect(()=>{i&&(l(i.data.title||""),f(i.data.description||""),v(i.data.images||[]),p(i.data.files||[]),ze(i)&&(c(i.data.results||""),h(i.data.conclusions||"")))},[i]),!i)return null;const E=()=>{r("detail")},z=()=>{o(!0)},S=async j=>{if(j.preventDefault(),!s.trim()){D("Title is required");return}if(!d.trim()){D("Description is required");return}k(!0),D(null);try{Te(i)?await Ze.updateDesign({id:i.data.designId,title:s.trim(),description:d.trim(),images:x,files:I}):Me(i)?await Ze.updateBuild({id:i.data.buildId,title:s.trim(),description:d.trim(),images:x,files:I}):ze(i)&&await Ze.updateTest({id:i.data.testId,title:s.trim(),description:d.trim(),results:a.trim(),conclusions:u.trim(),images:x,files:I}),await n(i.data.userId,!1,[]),r("detail")}catch(T){console.error("Error updating:",T),D(T instanceof Error?T.message:"Failed to update")}finally{k(!1)}},M=Te(i)?{type:"Design",color:$.primary[500],bgColor:$.primary[50]}:Me(i)?{type:"Build",color:$.secondary[500],bgColor:$.secondary[50]}:ze(i)?{type:"Test",color:$.warning,bgColor:"#FFF7ED"}:{type:"Unknown",color:$.neutral[500],bgColor:$.neutral[50]};return g.jsxs(Y,{sx:{position:"absolute",right:0,top:0,bottom:0,width:480,backgroundColor:$.background.primary,boxShadow:rt["2xl"],zIndex:1300,display:"flex",flexDirection:"column",animation:"slideInRight 0.3s ease-out","@keyframes slideInRight":{from:{transform:"translateX(100%)"},to:{transform:"translateX(0)"}}},children:[g.jsx(Y,{sx:{p:B[4],borderBottom:`1px solid ${$.neutral[200]}`,backgroundColor:M.bgColor},children:g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[g.jsxs(K,{variant:"h4",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary},children:["Edit ",M.type]}),g.jsxs(Y,{sx:{display:"flex",gap:B[.5]},children:[g.jsx(me,{size:"small",onClick:z,disabled:A,children:g.jsx(bn,{})}),g.jsx(me,{size:"small",onClick:E,disabled:A,children:g.jsx(lt,{})})]})]})}),g.jsxs(Y,{component:"form",onSubmit:S,sx:{flex:1,overflowY:"auto",p:B[4],display:"flex",flexDirection:"column",gap:B[4]},children:[_&&g.jsx(ot,{severity:"error",onClose:()=>D(null),children:_}),g.jsx(Ft,{label:"Title",value:s,onChange:j=>l(j.target.value),required:!0,fullWidth:!0,disabled:A,sx:{"& .MuiOutlinedInput-root":{borderRadius:Ee.lg}}}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body2",sx:{mb:B[1],color:$.text.secondary,fontWeight:q.fontWeight.medium},children:"Description *"}),g.jsx(Be,{value:d,onChange:f,placeholder:"Enter description...",minHeight:200,disabled:A})]}),g.jsx(Ct,{sx:{my:B[2]}}),g.jsx(_a,{images:x,onImagesChange:v,storagePath:Te(i)?`designs/${i.data.designId}`:Me(i)?`builds/${i.data.buildId}`:ze(i)?`tests/${i.data.testId}`:"",disabled:A}),g.jsx(Ct,{sx:{my:B[2]}}),g.jsx(Ia,{files:I,onFilesChange:p,storagePath:Te(i)?`designs/${i.data.designId}`:Me(i)?`builds/${i.data.buildId}`:ze(i)?`tests/${i.data.testId}`:"",disabled:A,maxFileSize:10}),ze(i)&&g.jsxs(g.Fragment,{children:[g.jsxs(Y,{children:[g.jsx(K,{variant:"body2",sx:{mb:B[1],color:$.text.secondary,fontWeight:q.fontWeight.medium},children:"Results"}),g.jsx(Be,{value:a,onChange:c,placeholder:"Describe the test results...",minHeight:150,disabled:A})]}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body2",sx:{mb:B[1],color:$.text.secondary,fontWeight:q.fontWeight.medium},children:"Conclusions"}),g.jsx(Be,{value:u,onChange:h,placeholder:"What conclusions can you draw?",minHeight:150,disabled:A})]})]})]}),g.jsxs(Y,{sx:{p:B[4],borderTop:`1px solid ${$.neutral[200]}`,display:"flex",gap:B[2]},children:[g.jsx(Se,{variant:"outlined",onClick:E,fullWidth:!0,disabled:A,children:"Cancel"}),g.jsx(Se,{type:"submit",variant:"contained",onClick:S,fullWidth:!0,disabled:A,startIcon:A?g.jsx(It,{size:20}):g.jsx(Ai,{}),sx:{backgroundColor:$.primary[500],"&:hover":{backgroundColor:$.primary[600]}},children:A?"Saving...":"Save Changes"})]})]})},T0=()=>{const e=Q(j=>j.selectedNodeId),t=Q(j=>j.getNodeById),r=Q(j=>j.setActivePanel),o=Q(j=>j.setIsExpanded),n=Q(j=>j.fetchAllData),i=e?t(e):null,[s,l]=P.useState(""),[d,f]=P.useState(""),[a,c]=P.useState(""),[u,h]=P.useState(""),[x,v]=P.useState([]),[I,p]=P.useState([]),[A,k]=P.useState(!1),[_,D]=P.useState(null);if(P.useEffect(()=>{i&&(l(i.data.title||""),f(i.data.description||""),v(i.data.images||[]),p(i.data.files||[]),ze(i)&&(c(i.data.results||""),h(i.data.conclusions||"")))},[i]),!i)return null;const E=()=>{r(null),o(!1)},z=()=>{r("detail")},S=async j=>{if(j.preventDefault(),!s.trim()){D("Title is required");return}if(!d.trim()){D("Description is required");return}k(!0),D(null);try{Te(i)?await Ze.updateDesign({id:i.data.designId,title:s.trim(),description:d.trim(),images:x,files:I}):Me(i)?await Ze.updateBuild({id:i.data.buildId,title:s.trim(),description:d.trim(),images:x,files:I}):ze(i)&&await Ze.updateTest({id:i.data.testId,title:s.trim(),description:d.trim(),results:a.trim(),conclusions:u.trim(),images:x,files:I}),await n(i.data.userId,!1,[]),r("detail")}catch(T){console.error("Error updating:",T),D(T instanceof Error?T.message:"Failed to update")}finally{k(!1)}},M=Te(i)?{type:"Design",color:$.primary[500],bgColor:$.primary[50]}:Me(i)?{type:"Build",color:$.secondary[500],bgColor:$.secondary[50]}:ze(i)?{type:"Test",color:$.warning,bgColor:"#FFF7ED"}:{type:"Unknown",color:$.neutral[500],bgColor:$.neutral[50]};return g.jsxs(Jt,{open:!0,onClose:E,fullScreen:!0,PaperProps:{sx:{backgroundColor:$.background.secondary}},children:[g.jsx(Y,{sx:{position:"sticky",top:0,zIndex:10,p:B[4],backgroundColor:M.bgColor,borderBottom:`1px solid ${$.neutral[200]}`},children:g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:B[2]},children:[g.jsx(me,{onClick:z,disabled:A,children:g.jsx(un,{})}),g.jsxs(K,{variant:"h3",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary},children:["Edit ",M.type]})]}),g.jsx(me,{onClick:E,disabled:A,children:g.jsx(lt,{})})]})}),g.jsxs(Y,{component:"form",onSubmit:S,sx:{flex:1,overflowY:"auto",p:B[6],maxWidth:1200,mx:"auto",width:"100%"},children:[_&&g.jsx(ot,{severity:"error",onClose:()=>D(null),sx:{mb:B[4]},children:_}),g.jsxs(Y,{sx:{display:"flex",flexDirection:"column",gap:B[4]},children:[g.jsx(Ft,{label:"Title",value:s,onChange:j=>l(j.target.value),required:!0,fullWidth:!0,disabled:A,sx:{"& .MuiOutlinedInput-root":{borderRadius:Ee.lg,fontSize:q.fontSize.xl}}}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body1",sx:{mb:B[2],color:$.text.secondary,fontWeight:q.fontWeight.medium,fontSize:q.fontSize.lg},children:"Description *"}),g.jsx(Be,{value:d,onChange:f,placeholder:"Enter description...",minHeight:300,disabled:A})]}),g.jsx(Ct,{sx:{my:B[3]}}),g.jsx(_a,{images:x,onImagesChange:v,storagePath:Te(i)?`designs/${i.data.designId}`:Me(i)?`builds/${i.data.buildId}`:ze(i)?`tests/${i.data.testId}`:"",disabled:A}),g.jsx(Ct,{sx:{my:B[3]}}),g.jsx(Ia,{files:I,onFilesChange:p,storagePath:Te(i)?`designs/${i.data.designId}`:Me(i)?`builds/${i.data.buildId}`:ze(i)?`tests/${i.data.testId}`:"",disabled:A,maxFileSize:10}),ze(i)&&g.jsxs(g.Fragment,{children:[g.jsxs(Y,{children:[g.jsx(K,{variant:"body1",sx:{mb:B[2],color:$.text.secondary,fontWeight:q.fontWeight.medium,fontSize:q.fontSize.lg},children:"Results"}),g.jsx(Be,{value:a,onChange:c,placeholder:"Describe the test results...",minHeight:250,disabled:A})]}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body1",sx:{mb:B[2],color:$.text.secondary,fontWeight:q.fontWeight.medium,fontSize:q.fontSize.lg},children:"Conclusions"}),g.jsx(Be,{value:u,onChange:h,placeholder:"What conclusions can you draw?",minHeight:250,disabled:A})]})]})]})]}),g.jsx(Y,{sx:{position:"sticky",bottom:0,p:B[4],backgroundColor:$.background.primary,borderTop:`1px solid ${$.neutral[200]}`,boxShadow:"0 -4px 6px -1px rgba(0, 0, 0, 0.1)"},children:g.jsxs(Y,{sx:{maxWidth:1200,mx:"auto",width:"100%",display:"flex",gap:B[2]},children:[g.jsx(Se,{variant:"outlined",onClick:z,fullWidth:!0,size:"large",disabled:A,children:"Cancel"}),g.jsx(Se,{type:"submit",variant:"contained",onClick:S,fullWidth:!0,size:"large",disabled:A,startIcon:A?g.jsx(It,{size:20}):g.jsx(Ai,{}),sx:{backgroundColor:$.primary[500],"&:hover":{backgroundColor:$.primary[600]}},children:A?"Saving...":"Save Changes"})]})})]})},D0=({designId:e})=>{var D;const t=Q(E=>E.setActivePanel),r=Q(E=>E.setIsExpanded),o=Q(E=>E.fetchAllData),n=Q(E=>E.designs),i=Q(E=>E.selectedNodeId),s=Q(E=>E.getNodeById),l=i?s(i):null;let d=e;!d&&l&&((D=l.data)!=null&&D.designId?d=l.data.designId:l.id&&l.id.startsWith("design-")&&(d=l.id.replace("design-","")));const f=n.find(E=>E.id===d),[a,c]=P.useState(""),[u,h]=P.useState(""),[x,v]=P.useState(!1),[I,p]=P.useState(null);if(!f)return null;const A=()=>{t(null)},k=()=>{r(!0)},_=async E=>{if(E.preventDefault(),!a.trim()){p("Title is required");return}if(!u.trim()){p("Description is required");return}v(!0),p(null);try{await Ze.createBuild({designId:d,userId:f.userId,title:a.trim(),description:u.trim()}),await o(f.userId,!1,[]),t(null)}catch(z){console.error("Error creating build:",z),p(z instanceof Error?z.message:"Failed to create build")}finally{v(!1)}};return g.jsxs(Y,{sx:{position:"absolute",right:0,top:0,bottom:0,width:480,backgroundColor:$.background.primary,boxShadow:rt["2xl"],zIndex:1300,display:"flex",flexDirection:"column",animation:"slideInRight 0.3s ease-out","@keyframes slideInRight":{from:{transform:"translateX(100%)"},to:{transform:"translateX(0)"}}},children:[g.jsx(Y,{sx:{p:B[4],borderBottom:`1px solid ${$.neutral[200]}`,backgroundColor:$.secondary[50]},children:g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[g.jsxs(Y,{children:[g.jsx(K,{variant:"h4",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary},children:"Add Build"}),g.jsxs(K,{variant:"body2",sx:{color:$.text.secondary,mt:B[1]},children:["To: ",f.title]})]}),g.jsxs(Y,{sx:{display:"flex",gap:B[.5]},children:[g.jsx(me,{size:"small",onClick:k,disabled:x,children:g.jsx(bn,{})}),g.jsx(me,{size:"small",onClick:A,disabled:x,children:g.jsx(lt,{})})]})]})}),g.jsxs(Y,{component:"form",onSubmit:_,sx:{flex:1,overflowY:"auto",p:B[4],display:"flex",flexDirection:"column",gap:B[4]},children:[I&&g.jsx(ot,{severity:"error",onClose:()=>p(null),children:I}),g.jsx(Ft,{label:"Build Title",value:a,onChange:E=>c(E.target.value),required:!0,fullWidth:!0,disabled:x,placeholder:"e.g., Prototype v1.0",sx:{"& .MuiOutlinedInput-root":{borderRadius:Ee.lg}}}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body2",sx:{mb:B[1],color:$.text.secondary,fontWeight:q.fontWeight.medium},children:"Description *"}),g.jsx(Be,{value:u,onChange:h,placeholder:"Describe the build details, materials, methods, etc...",minHeight:250,disabled:x})]})]}),g.jsxs(Y,{sx:{p:B[4],borderTop:`1px solid ${$.neutral[200]}`,display:"flex",gap:B[2]},children:[g.jsx(Se,{variant:"outlined",onClick:A,fullWidth:!0,disabled:x,children:"Cancel"}),g.jsx(Se,{type:"submit",variant:"contained",onClick:_,fullWidth:!0,disabled:x,startIcon:x?g.jsx(It,{size:20}):g.jsx(_t,{}),sx:{backgroundColor:$.secondary[500],"&:hover":{backgroundColor:$.secondary[600]}},children:x?"Creating...":"Create Build"})]})]})},$0=({designId:e})=>{var D;const t=Q(E=>E.setActivePanel),r=Q(E=>E.setIsExpanded),o=Q(E=>E.fetchAllData),n=Q(E=>E.designs),i=Q(E=>E.selectedNodeId),s=Q(E=>E.getNodeById),l=i?s(i):null;let d=e;!d&&l&&((D=l.data)!=null&&D.designId?d=l.data.designId:l.id&&l.id.startsWith("design-")&&(d=l.id.replace("design-","")));const f=n.find(E=>E.id===d),[a,c]=P.useState(""),[u,h]=P.useState(""),[x,v]=P.useState(!1),[I,p]=P.useState(null);if(!f)return null;const A=()=>{t(null),r(!1)},k=()=>{t("detail")},_=async E=>{if(E.preventDefault(),!a.trim()){p("Title is required");return}if(!u.trim()){p("Description is required");return}v(!0),p(null);try{await Ze.createBuild({designId:d,userId:f.userId,title:a.trim(),description:u.trim()}),await o(f.userId,!1,[]),t("detail"),c(""),h("")}catch(z){console.error("Error creating build:",z),p(z instanceof Error?z.message:"Failed to create build")}finally{v(!1)}};return g.jsxs(Jt,{open:!0,onClose:A,fullScreen:!0,PaperProps:{sx:{backgroundColor:$.background.secondary}},children:[g.jsxs(Y,{sx:{position:"sticky",top:0,zIndex:10,p:B[4],backgroundColor:$.secondary[50],borderBottom:`1px solid ${$.neutral[200]}`},children:[g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:B[2]},children:[g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:B[2]},children:[g.jsx(me,{onClick:k,disabled:x,children:g.jsx(un,{})}),g.jsx(K,{variant:"h3",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary},children:"Add Build"})]}),g.jsx(me,{onClick:A,disabled:x,children:g.jsx(lt,{})})]}),g.jsxs(K,{variant:"body1",sx:{color:$.text.secondary},children:["To: ",f.title]})]}),g.jsxs(Y,{component:"form",onSubmit:_,sx:{flex:1,overflowY:"auto",p:B[6],maxWidth:1200,mx:"auto",width:"100%"},children:[I&&g.jsx(ot,{severity:"error",onClose:()=>p(null),sx:{mb:B[4]},children:I}),g.jsxs(Y,{sx:{display:"flex",flexDirection:"column",gap:B[4]},children:[g.jsx(Ft,{label:"Build Title",value:a,onChange:E=>c(E.target.value),required:!0,fullWidth:!0,disabled:x,placeholder:"e.g., Prototype v1.0",sx:{"& .MuiOutlinedInput-root":{borderRadius:Ee.lg,fontSize:q.fontSize.xl}}}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body1",sx:{mb:B[2],color:$.text.secondary,fontWeight:q.fontWeight.medium,fontSize:q.fontSize.lg},children:"Description *"}),g.jsx(Be,{value:u,onChange:h,placeholder:"Describe the build details, materials, methods, etc...",minHeight:400,disabled:x})]})]})]}),g.jsx(Y,{sx:{position:"sticky",bottom:0,p:B[4],backgroundColor:$.background.primary,borderTop:`1px solid ${$.neutral[200]}`,boxShadow:"0 -4px 6px -1px rgba(0, 0, 0, 0.1)"},children:g.jsxs(Y,{sx:{maxWidth:1200,mx:"auto",width:"100%",display:"flex",gap:B[2]},children:[g.jsx(Se,{variant:"outlined",onClick:k,fullWidth:!0,size:"large",disabled:x,children:"Cancel"}),g.jsx(Se,{type:"submit",variant:"contained",onClick:_,fullWidth:!0,size:"large",disabled:x,startIcon:x?g.jsx(It,{size:20}):g.jsx(_t,{}),sx:{backgroundColor:$.secondary[500],"&:hover":{backgroundColor:$.secondary[600]}},children:x?"Creating...":"Create Build"})]})})]})},F0=({designId:e})=>{var m;const t=Q(C=>C.setActivePanel),r=Q(C=>C.setIsExpanded),o=Q(C=>C.fetchAllData),n=Q(C=>C.designs),i=Q(C=>C.builds),s=Q(C=>C.selectedNodeId),l=Q(C=>C.getNodeById),d=s?l(s):null;let f=e;if(!f&&d){if((m=d.data)!=null&&m.designId)f=d.data.designId;else if(d.id&&d.id.startsWith("design-"))f=d.id.replace("design-","");else if(d.id&&d.id.startsWith("build-")){const C=d.id.replace("build-",""),y=i.find(b=>b.id===C);y&&(f=y.design_ID)}}const a=n.find(C=>C.id===f),c=i.filter(C=>C.design_ID===f),u=V.useMemo(()=>d&&d.id&&d.id.startsWith("build-")?d.id.replace("build-",""):"",[d]),[h,x]=P.useState(u),[v,I]=P.useState(""),[p,A]=P.useState(""),[k,_]=P.useState(""),[D,E]=P.useState("");V.useEffect(()=>{u&&x(u)},[u]);const[z,S]=P.useState(!1),[w,M]=P.useState(null);if(!a)return null;const j=()=>{t(null)},T=()=>{r(!0)},F=async C=>{if(C.preventDefault(),!h){M("Please select a build");return}if(!v.trim()){M("Title is required");return}if(!p.trim()){M("Description is required");return}S(!0),M(null);try{await Ze.createTest({buildId:h,designId:f,userId:a.userId,title:v.trim(),description:p.trim(),results:k.trim(),conclusions:D.trim()}),await o(a.userId,!1,[]),t(null)}catch(y){console.error("Error creating test:",y),M(y instanceof Error?y.message:"Failed to create test")}finally{S(!1)}};return g.jsxs(Y,{sx:{position:"absolute",right:0,top:0,bottom:0,width:480,backgroundColor:$.background.primary,boxShadow:rt["2xl"],zIndex:1300,display:"flex",flexDirection:"column",animation:"slideInRight 0.3s ease-out","@keyframes slideInRight":{from:{transform:"translateX(100%)"},to:{transform:"translateX(0)"}}},children:[g.jsx(Y,{sx:{p:B[4],borderBottom:`1px solid ${$.neutral[200]}`,backgroundColor:"#FFF7ED"},children:g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[g.jsxs(Y,{children:[g.jsx(K,{variant:"h4",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary},children:"Add Test"}),g.jsxs(K,{variant:"body2",sx:{color:$.text.secondary,mt:B[1]},children:["To: ",a.title]})]}),g.jsxs(Y,{sx:{display:"flex",gap:B[.5]},children:[g.jsx(me,{size:"small",onClick:T,disabled:z,children:g.jsx(bn,{})}),g.jsx(me,{size:"small",onClick:j,disabled:z,children:g.jsx(lt,{})})]})]})}),g.jsxs(Y,{component:"form",onSubmit:F,sx:{flex:1,overflowY:"auto",p:B[4],display:"flex",flexDirection:"column",gap:B[4]},children:[w&&g.jsx(ot,{severity:"error",onClose:()=>M(null),children:w}),c.length===0?g.jsx(ot,{severity:"warning",children:"No builds available. Please create a build first before adding tests."}):g.jsxs(g.Fragment,{children:[g.jsxs(ki,{fullWidth:!0,required:!0,disabled:z,children:[g.jsx(Ni,{children:"Select Build"}),g.jsx(ji,{value:h,onChange:C=>x(C.target.value),label:"Select Build",sx:{borderRadius:Ee.lg},children:c.map(C=>g.jsx(Mi,{value:C.id,children:C.title},C.id))})]}),g.jsx(Ft,{label:"Test Title",value:v,onChange:C=>I(C.target.value),required:!0,fullWidth:!0,disabled:z,placeholder:"e.g., Temperature Test",sx:{"& .MuiOutlinedInput-root":{borderRadius:Ee.lg}}}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body2",sx:{mb:B[1],color:$.text.secondary,fontWeight:q.fontWeight.medium},children:"Description *"}),g.jsx(Be,{value:p,onChange:A,placeholder:"Describe the test methodology...",minHeight:150,disabled:z})]}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body2",sx:{mb:B[1],color:$.text.secondary,fontWeight:q.fontWeight.medium},children:"Results (Optional)"}),g.jsx(Be,{value:k,onChange:_,placeholder:"Document the test results...",minHeight:150,disabled:z})]}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body2",sx:{mb:B[1],color:$.text.secondary,fontWeight:q.fontWeight.medium},children:"Conclusions (Optional)"}),g.jsx(Be,{value:D,onChange:E,placeholder:"What conclusions can you draw?",minHeight:150,disabled:z})]})]})]}),g.jsxs(Y,{sx:{p:B[4],borderTop:`1px solid ${$.neutral[200]}`,display:"flex",gap:B[2]},children:[g.jsx(Se,{variant:"outlined",onClick:j,fullWidth:!0,disabled:z,children:"Cancel"}),g.jsx(Se,{type:"submit",variant:"contained",onClick:F,fullWidth:!0,disabled:z||c.length===0,startIcon:z?g.jsx(It,{size:20}):g.jsx(_t,{}),sx:{backgroundColor:$.warning,color:$.text.primary,"&:hover":{backgroundColor:"#F59E0B"}},children:z?"Creating...":"Create Test"})]})]})},R0=({designId:e})=>{var m;const t=Q(C=>C.setActivePanel),r=Q(C=>C.setIsExpanded),o=Q(C=>C.fetchAllData),n=Q(C=>C.designs),i=Q(C=>C.builds),s=Q(C=>C.selectedNodeId),l=Q(C=>C.getNodeById),d=s?l(s):null;let f=e;if(!f&&d){if((m=d.data)!=null&&m.designId)f=d.data.designId;else if(d.id&&d.id.startsWith("design-"))f=d.id.replace("design-","");else if(d.id&&d.id.startsWith("build-")){const C=d.id.replace("build-",""),y=i.find(b=>b.id===C);y&&(f=y.design_ID)}}const a=n.find(C=>C.id===f),c=i.filter(C=>C.design_ID===f),u=P.useMemo(()=>d&&d.id&&d.id.startsWith("build-")?d.id.replace("build-",""):"",[d]),[h,x]=P.useState(u),[v,I]=P.useState(""),[p,A]=P.useState(""),[k,_]=P.useState(""),[D,E]=P.useState(""),[z,S]=P.useState(!1),[w,M]=P.useState(null);if(P.useEffect(()=>{u&&x(u)},[u]),!a)return null;const j=()=>{t(null),r(!1)},T=()=>{t("detail")},F=async C=>{if(C.preventDefault(),!h){M("Please select a build");return}if(!v.trim()){M("Title is required");return}if(!p.trim()){M("Description is required");return}S(!0),M(null);try{await Ze.createTest({buildId:h,designId:f,userId:a.userId,title:v.trim(),description:p.trim(),results:k.trim(),conclusions:D.trim()}),await o(a.userId,!1,[]),t("detail"),I(""),A(""),_(""),E("")}catch(y){console.error("Error creating test:",y),M(y instanceof Error?y.message:"Failed to create test")}finally{S(!1)}};return g.jsxs(Jt,{open:!0,onClose:j,fullScreen:!0,PaperProps:{sx:{backgroundColor:$.background.secondary}},children:[g.jsxs(Y,{sx:{position:"sticky",top:0,zIndex:10,p:B[4],backgroundColor:"#FFF7ED",borderBottom:`1px solid ${$.neutral[200]}`},children:[g.jsxs(Y,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:B[2]},children:[g.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:B[2]},children:[g.jsx(me,{onClick:T,disabled:z,children:g.jsx(un,{})}),g.jsx(K,{variant:"h3",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary},children:"Add Test"})]}),g.jsx(me,{onClick:j,disabled:z,children:g.jsx(lt,{})})]}),g.jsxs(K,{variant:"body1",sx:{color:$.text.secondary},children:["To: ",a.title]})]}),g.jsxs(Y,{component:"form",onSubmit:F,sx:{flex:1,overflowY:"auto",p:B[6],maxWidth:1200,mx:"auto",width:"100%"},children:[w&&g.jsx(ot,{severity:"error",onClose:()=>M(null),sx:{mb:B[4]},children:w}),c.length===0?g.jsx(ot,{severity:"warning",children:"No builds available. Please create a build first before adding tests."}):g.jsxs(Y,{sx:{display:"flex",flexDirection:"column",gap:B[4]},children:[g.jsxs(ki,{fullWidth:!0,required:!0,disabled:z,children:[g.jsx(Ni,{children:"Select Build"}),g.jsx(ji,{value:h,onChange:C=>x(C.target.value),label:"Select Build",sx:{borderRadius:Ee.lg,fontSize:q.fontSize.lg},children:c.map(C=>g.jsx(Mi,{value:C.id,children:C.title},C.id))})]}),g.jsx(Ft,{label:"Test Title",value:v,onChange:C=>I(C.target.value),required:!0,fullWidth:!0,disabled:z,placeholder:"e.g., Temperature Test",sx:{"& .MuiOutlinedInput-root":{borderRadius:Ee.lg,fontSize:q.fontSize.xl}}}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body1",sx:{mb:B[2],color:$.text.secondary,fontWeight:q.fontWeight.medium,fontSize:q.fontSize.lg},children:"Description *"}),g.jsx(Be,{value:p,onChange:A,placeholder:"Describe the test methodology...",minHeight:250,disabled:z})]}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body1",sx:{mb:B[2],color:$.text.secondary,fontWeight:q.fontWeight.medium,fontSize:q.fontSize.lg},children:"Results (Optional)"}),g.jsx(Be,{value:k,onChange:_,placeholder:"Document the test results...",minHeight:250,disabled:z})]}),g.jsxs(Y,{children:[g.jsx(K,{variant:"body1",sx:{mb:B[2],color:$.text.secondary,fontWeight:q.fontWeight.medium,fontSize:q.fontSize.lg},children:"Conclusions (Optional)"}),g.jsx(Be,{value:D,onChange:E,placeholder:"What conclusions can you draw?",minHeight:250,disabled:z})]})]})]}),g.jsx(Y,{sx:{position:"sticky",bottom:0,p:B[4],backgroundColor:$.background.primary,borderTop:`1px solid ${$.neutral[200]}`,boxShadow:"0 -4px 6px -1px rgba(0, 0, 0, 0.1)"},children:g.jsxs(Y,{sx:{maxWidth:1200,mx:"auto",width:"100%",display:"flex",gap:B[2]},children:[g.jsx(Se,{variant:"outlined",onClick:T,fullWidth:!0,size:"large",disabled:z,children:"Cancel"}),g.jsx(Se,{type:"submit",variant:"contained",onClick:F,fullWidth:!0,size:"large",disabled:z||c.length===0,startIcon:z?g.jsx(It,{size:20}):g.jsx(_t,{}),sx:{backgroundColor:$.warning,color:$.text.primary,"&:hover":{backgroundColor:"#F59E0B"}},children:z?"Creating...":"Create Test"})]})})]})},O0=()=>{const{designId:e}=cl(),t=ul(),{userDetails:r,loading:o}=dl(),n=Q(k=>k.designs);Q(k=>k.nodes);const i=Q(k=>k.isLoading),s=Q(k=>k.activePanel),l=Q(k=>k.isExpanded),d=Q(k=>k.buildGraph),f=Q(k=>k.fetchAllData),a=Q(k=>k.deleteDialog),c=Q(k=>k.closeDeleteDialog),u=Q(k=>k.confirmDelete),[h,x]=P.useState(!1),[v,I]=P.useState(!1),p=n.find(k=>k.id===e);P.useEffect(()=>{if(!o&&r&&!v&&n.length===0){const k=Object.keys(r.classes||{});f(r.uid,r.isAdmin,k),I(!0)}},[r,o,f,v,n.length]),P.useEffect(()=>{p&&d()},[p,d]);const A=async()=>{x(!0);try{await u()}finally{x(!1)}};return i||o||v&&!p&&n.length===0?g.jsxs(Y,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh",gap:B[4]},children:[g.jsx(It,{size:60,sx:{color:$.primary[500]}}),g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.display,color:$.text.secondary},children:"Loading design..."})]}):v&&!p&&n.length>0?g.jsxs(Y,{sx:{p:B[6]},children:[g.jsxs(ot,{severity:"error",sx:{borderRadius:"12px",mb:B[4]},children:[g.jsx(K,{variant:"h6",sx:{mb:1},children:"Design Not Found"}),g.jsx(K,{variant:"body2",children:"The design you're looking for doesn't exist or you don't have permission to view it."})]}),g.jsx(Se,{variant:"contained",startIcon:g.jsx(un,{}),onClick:()=>t("/laboratory-notebook"),children:"All Designs"})]}):p?g.jsx(fo,{children:g.jsxs(Y,{sx:{position:"relative",display:"flex",flexDirection:"column",height:"100vh",backgroundColor:$.background.secondary,overflow:"hidden"},children:[g.jsxs(Y,{sx:{p:B[4],backgroundColor:$.background.primary,borderBottom:`1px solid ${$.neutral[200]}`,display:"flex",alignItems:"center",gap:B[3]},children:[g.jsx(Se,{variant:"outlined",startIcon:g.jsx(un,{}),onClick:()=>t("/laboratory-notebook"),sx:{borderRadius:Ee.lg},children:"All Designs"}),g.jsx(Y,{children:g.jsx(K,{variant:"h4",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:$.text.primary},children:p.title})})]}),g.jsx(Y,{sx:{flex:1,position:"relative",overflow:"hidden"},children:g.jsx(b0,{designIdFilter:e})}),l?g.jsxs(g.Fragment,{children:[s==="detail"&&g.jsx(S0,{}),s==="edit"&&g.jsx(T0,{}),s==="addBuild"&&g.jsx($0,{designId:e}),s==="addTest"&&g.jsx(R0,{designId:e})]}):g.jsxs(g.Fragment,{children:[s==="detail"&&g.jsx(w0,{}),s==="edit"&&g.jsx(z0,{}),s==="addBuild"&&g.jsx(D0,{designId:e}),s==="addTest"&&g.jsx(F0,{designId:e})]}),g.jsx(zi,{open:a.open,title:`Delete ${a.nodeType==="build"?"Build":"Test"}?`,message:`Are you sure you want to delete "${a.nodeName}"? ${a.nodeType==="build"?"This will also delete all associated tests. ":""}This action cannot be undone.`,confirmLabel:h?"Deleting...":"Delete",cancelLabel:"Cancel",onConfirm:A,onCancel:c,isDestructive:!0})]})}):g.jsxs(Y,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh",gap:B[4]},children:[g.jsx(It,{size:60,sx:{color:$.primary[500]}}),g.jsx(K,{variant:"h6",sx:{fontFamily:q.fontFamily.display,color:$.text.secondary},children:"Loading design..."})]})};export{O0 as default};
