import{j as e,E as te,H as re,ao as D,ac as Ae,an as _,B as d,v as G,t as Q,I as V,a4 as ye,a8 as we,am as ce,T as a,ah as Fe,a3 as De,a as A,ak as ze,$ as de,r as f,G as b,bK as Me,bL as Te,aq as je,V as ne,W as oe,X as ae,Y as Ce,Z as ie,C as Se,aa as We,A as ve,O as Pe,P as Re,aL as xe,aI as he,at as ue,aA as O,aB as q,aC as Be,a6 as L,aD as U,aE as $e,a0 as N,a1 as H,aF as Ee,U as Oe,aG as qe,D as fe}from"./ui-CvbxGYbq.js";import{j as r,P as Le,f as le,b as I,u as K,k as pe,c as y,a as se,d as Ue,s as v,t as C,l as Ne,m as He,n as Ge}from"./index-BRrx0mBg.js";import{P as Z,R as me,v as ee,_ as be,I as Ye,e as X,y as _e,i as Ze,f as ke}from"./firebase-CTJJwFJC.js";import"./vendor-BFl3bqVE.js";const Je=s=>{const h=new Date;if(s.scheduledTimestamp){const o=s.scheduledTimestamp.toDate();return o>h?`Scheduled for ${o.toLocaleDateString()}`:`Scheduled ${o.toLocaleDateString()}`}if(s.published){const o=s.timestamp.toDate(),i=Math.floor((h.getTime()-o.getTime())/(1e3*60*60*24));if(i===0)return"Published today";if(i===1)return"Published yesterday";if(i<7)return`Published ${i} days ago`;if(i<30){const x=Math.floor(i/7);return`Published ${x} week${x>1?"s":""} ago`}else return`Published ${o.toLocaleDateString()}`}const t=s.timestamp.toDate(),l=Math.floor((h.getTime()-t.getTime())/(1e3*60*60*24));if(l===0)return"Created today";if(l===1)return"Created yesterday";if(l<7)return`Created ${l} days ago`;if(l<30){const o=Math.floor(l/7);return`Created ${o} week${o>1?"s":""} ago`}else return`Created ${t.toLocaleDateString()}`},Ke=({material:s,isCourseAdmin:h=!1,loading:t=!1,onView:l,onEdit:o,onDelete:i,onUnpublish:x,className:p})=>{const u=(g=>g.published?{label:"Published",color:r.palette.success.main,backgroundColor:r.palette.success.light,icon:e.jsx(ce,{sx:{fontSize:16}})}:g.scheduledTimestamp?{label:"Scheduled",color:r.palette.info.main,backgroundColor:r.palette.info.light,icon:e.jsx(Fe,{sx:{fontSize:16}})}:{label:"Draft",color:r.palette.warning.main,backgroundColor:r.palette.warning.light,icon:e.jsx(De,{sx:{fontSize:16}})})(s);return t?e.jsxs(te,{className:p,sx:{height:200},children:[e.jsxs(re,{children:[e.jsx(D,{variant:"text",width:"80%",height:32}),e.jsx(D,{variant:"text",width:"60%",height:24,sx:{mt:1}}),e.jsx(D,{variant:"rectangular",width:"100%",height:40,sx:{mt:2,borderRadius:2}})]}),e.jsxs(Ae,{children:[e.jsx(D,{variant:"circular",width:40,height:40}),e.jsx(D,{variant:"circular",width:40,height:40}),e.jsx(D,{variant:"circular",width:40,height:40})]})]}):e.jsx(_,{in:!0,timeout:300,children:e.jsx(te,{className:p,sx:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-4px)",boxShadow:r.shadows[8]}},children:e.jsxs(re,{sx:{flexGrow:1,pb:3,px:3,pt:3},children:[e.jsxs(d,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(G,{icon:u.icon,label:u.label,size:"small",sx:{backgroundColor:u.backgroundColor,color:u.color,fontWeight:600,"& .MuiChip-icon":{color:u.color}}}),h&&e.jsxs(d,{sx:{display:"flex",gap:.5},children:[e.jsx(Q,{title:"Edit Material",arrow:!0,children:e.jsx(V,{size:"small",onClick:g=>{g.stopPropagation(),o==null||o(s.id)},sx:{color:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.light,color:r.palette.primary.contrastText}},children:e.jsx(ye,{fontSize:"small"})})}),e.jsx(Q,{title:"Delete Material",arrow:!0,children:e.jsx(V,{size:"small",onClick:g=>{g.stopPropagation(),i==null||i(s.id)},sx:{color:r.palette.error.main,"&:hover":{backgroundColor:r.palette.error.light,color:r.palette.error.contrastText}},children:e.jsx(we,{fontSize:"small"})})}),s.published&&x&&e.jsx(Q,{title:"Unpublish Material",arrow:!0,children:e.jsx(V,{size:"small",onClick:g=>{g.stopPropagation(),x==null||x(s.id)},sx:{color:r.palette.warning.main,"&:hover":{backgroundColor:r.palette.warning.light,color:r.palette.warning.contrastText}},children:e.jsx(ce,{fontSize:"small"})})})]})]}),e.jsx(a,{variant:"h5",component:"h3",sx:{fontFamily:r.typography.h5.fontFamily,fontWeight:600,fontSize:{xs:"1.25rem",sm:"1.5rem"},lineHeight:1.3,color:r.palette.text.primary,mb:1,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{color:r.palette.primary.main,textDecoration:"underline",textDecorationColor:r.palette.primary.main,textDecorationThickness:"2px",textUnderlineOffset:"4px",transform:"translateY(-1px)"}},onClick:g=>{g.stopPropagation(),l==null||l(s.id)},children:s.title||"Untitled Material"}),e.jsx(d,{sx:{mt:2},children:e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:1},children:[e.jsx(d,{component:"span",sx:{width:8,height:8,borderRadius:"50%",backgroundColor:u.color}}),Je(s)]})})]})})})},Xe=()=>e.jsx(Le,{title:"Course Materials"}),Qe=({selectedCourse:s,variant:h="contained",size:t="large",showModeToggle:l=!1,onModeChange:o,currentMode:i="manual"})=>{const x=le(),p=()=>{s&&x(`/add-material?course=${s}&mode=${l?i:"manual"}`)},j=u=>{o&&o(u)};return l?e.jsx(_,{in:!0,timeout:500,children:e.jsxs(d,{sx:{display:"flex",flexDirection:"column",gap:2,p:3,backgroundColor:r.palette.background.paper,borderRadius:I["2xl"],border:`1px solid ${r.palette.divider}`,boxShadow:r.shadows[2]},children:[e.jsx(a,{variant:"h6",sx:{fontFamily:r.typography.h6.fontFamily,fontWeight:r.typography.h6.fontWeight,color:r.palette.text.primary,textAlign:"center",mb:1},children:"Create New Material"}),e.jsx(a,{variant:"body2",sx:{color:r.palette.text.secondary,textAlign:"center",mb:2},children:"Choose how you'd like to create your material"}),e.jsxs(d,{sx:{display:"flex",gap:2},children:[e.jsx(A,{variant:i==="manual"?"contained":"outlined",startIcon:e.jsx(ye,{}),onClick:()=>j("manual"),disabled:!s,sx:{flex:1,py:2,borderRadius:I.xl,textTransform:"none",fontWeight:600,...i==="manual"&&{backgroundColor:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.dark}},...i!=="manual"&&{borderColor:r.palette.primary.main,color:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.light,borderColor:r.palette.primary.dark}}},children:"Manual Entry"}),e.jsx(A,{variant:i==="ai"?"contained":"outlined",startIcon:e.jsx(ze,{}),onClick:()=>j("ai"),disabled:!s,sx:{flex:1,py:2,borderRadius:I.xl,textTransform:"none",fontWeight:600,...i==="ai"&&{backgroundColor:r.palette.secondary.main,"&:hover":{backgroundColor:r.palette.secondary.dark}},...i!=="ai"&&{borderColor:r.palette.secondary.main,color:r.palette.secondary.main,"&:hover":{backgroundColor:r.palette.secondary.light,borderColor:r.palette.secondary.dark}}},children:"AI Import"})]}),e.jsx(A,{variant:"contained",startIcon:e.jsx(de,{}),onClick:p,disabled:!s,size:t,sx:{width:"100%",py:2,borderRadius:I.xl,textTransform:"none",fontWeight:600,backgroundColor:i==="ai"?r.palette.secondary.main:r.palette.primary.main,"&:hover":{backgroundColor:i==="ai"?r.palette.secondary.dark:r.palette.primary.dark,transform:"translateY(-1px)",boxShadow:r.shadows[4]},transition:r.transitions.create(["all"],{duration:r.transitions.duration.short})},children:i==="ai"?"Import with AI":"Create Material"})]})}):e.jsx(_,{in:!0,timeout:300,children:e.jsx(A,{variant:h,startIcon:e.jsx(de,{}),onClick:p,disabled:!s,size:t,sx:{borderRadius:r.shape.borderRadius,textTransform:"none",fontWeight:600,py:t==="large"?2:t==="medium"?1.5:1,px:t==="large"?4:t==="medium"?3:2,transition:r.transitions.create(["all"],{duration:r.transitions.duration.short}),"&:hover":{transform:"translateY(-1px)",boxShadow:r.shadows[4]},...h==="contained"&&{backgroundColor:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.dark}},...h==="outlined"&&{borderColor:r.palette.primary.main,color:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.light,borderColor:r.palette.primary.dark}}},children:"Add Material"})})},Ve=({courseId:s,isCourseAdmin:h,onDeleteClick:t,onUnpublishClick:l})=>{const[o,i]=f.useState(0),[x,p]=f.useState([]),[j,u]=f.useState(!0),[g,w]=f.useState(null),{userDetails:F}=K(),P=le(),z=Z(),k=h;f.useEffect(()=>{if(!s){p([]),u(!1);return}u(!0);const n=F!=null&&F.isAdmin?me(be(z,"materials"),ee("course","==",s)):me(be(z,"materials"),ee("course","==",s),ee("published","==",!0)),c=Ye(n,m=>{const Y=m.docs.map(W=>({id:W.id,...W.data()})).sort((W,J)=>W.sequenceNumber!==void 0&&J.sequenceNumber!==void 0?W.sequenceNumber-J.sequenceNumber:W.sequenceNumber!==void 0?-1:J.sequenceNumber!==void 0?1:J.timestamp.toMillis()-W.timestamp.toMillis());p(Y),u(!1),w(null)},m=>{console.error("Error fetching materials:",m),w("Failed to fetch materials"),u(!1)});return()=>c()},[s,z,F]);const R=(n,c)=>{i(c)},B=n=>{P(`/view-material/${n}`)},$=n=>{P(`/edit-material/${n}`)},M=n=>x.filter(c=>{switch(n){case"published":return c.published===!0;case"scheduled":return c.scheduledTimestamp&&!c.published;case"saved":return!c.published&&!c.scheduledTimestamp;default:return!1}}),E=n=>M(n).length,T=k?M(["published","scheduled","saved"][o]):x.filter(n=>n.published===!0);return j?e.jsxs(d,{sx:{width:"100%"},children:[e.jsx(d,{sx:{mb:4},children:e.jsx(D,{variant:"rectangular",height:60,sx:{borderRadius:2}})}),e.jsx(b,{container:!0,spacing:3,children:Array.from({length:6}).map((n,c)=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,children:e.jsx(D,{variant:"rectangular",height:200,sx:{borderRadius:2}})},c))})]}):g?e.jsxs(d,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200,p:4},children:[e.jsx(a,{variant:"h6",sx:{color:r.palette.error.main,mb:2,textAlign:"center"},children:"Error Loading Materials"}),e.jsx(a,{variant:"body2",sx:{color:r.palette.text.secondary,textAlign:"center"},children:g})]}):e.jsxs(d,{sx:{width:"100%"},children:[k&&e.jsx(d,{sx:{mb:4},children:e.jsx(Me,{value:o,onChange:R,variant:"fullWidth",sx:{backgroundColor:r.palette.background.paper,borderRadius:I.xl,boxShadow:r.shadows[1],"& .MuiTabs-indicator":{backgroundColor:r.palette.primary.main,height:3,borderRadius:"3px 3px 0 0"},"& .MuiTabs-flexContainer":{gap:1}},children:[{key:"published",label:"Published",icon:"ðŸ“š"},{key:"scheduled",label:"Scheduled",icon:"â°"},{key:"saved",label:"Drafts",icon:"ðŸ’¾"}].map((n,c)=>{const m=E(n.key);return e.jsx(Te,{label:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(a,{variant:"button",sx:{fontWeight:600,textTransform:"none",fontSize:"0.875rem"},children:n.label}),e.jsx(G,{label:m,size:"small",sx:{backgroundColor:r.palette.primary.light,color:r.palette.primary.main,fontWeight:600,minWidth:24,height:20,fontSize:"0.75rem"}})]}),sx:{textTransform:"none",fontWeight:600,minHeight:48,color:r.palette.text.primary,"&.Mui-selected":{color:r.palette.primary.main,backgroundColor:r.palette.primary.light,borderRadius:I.xl},"&:hover":{backgroundColor:r.palette.action.hover,borderRadius:I.xl}}},n.key)})})}),T.length===0?e.jsx(je,{maxWidth:"md",children:e.jsxs(d,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300,textAlign:"center"},children:[e.jsx(a,{variant:"h6",sx:{color:r.palette.text.secondary,mb:2},children:k?e.jsxs(e.Fragment,{children:[o===0&&"No published materials yet.",o===1&&"No scheduled materials.",o===2&&"No draft materials saved."]}):"No published materials available."}),e.jsx(a,{variant:"body2",sx:{color:r.palette.text.disabled},children:k?e.jsxs(e.Fragment,{children:[o===0&&"Published materials will appear here once you publish them.",o===1&&"Scheduled materials will appear here once you schedule them.",o===2&&"Draft materials will appear here as you work on them."]}):"Published materials will appear here once they are made available."})]})}):e.jsx(_,{in:!0,timeout:300,children:e.jsx(b,{container:!0,spacing:3,children:T.map(n=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Ke,{material:n,isCourseAdmin:h,onView:B,onEdit:$,onDelete:t,onUnpublish:l})},n.id))})})]})},et=({materialId:s,open:h,onClose:t,onDelete:l})=>{const o=Z(),i=async()=>{const x=X(o,"materials",s);await _e(x),l(),t()};return e.jsxs(ne,{open:h,onClose:t,children:[e.jsx(oe,{children:"Delete Material"}),e.jsx(ae,{children:e.jsx(Ce,{children:"Are you sure you want to delete this material? This action cannot be undone."})}),e.jsxs(ie,{children:[e.jsx(A,{onClick:t,color:"primary",children:"Cancel"}),e.jsx(A,{onClick:i,color:"secondary",children:"Delete"})]})]})},tt=({materialId:s,open:h,onClose:t,onUnpublish:l})=>{const o=Z(),i=async()=>{const x=X(o,"materials",s);await Ze(x,{published:!1}),l(),t()};return e.jsxs(ne,{open:h,onClose:t,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(oe,{id:"alert-dialog-title",children:"Unpublish Material"}),e.jsx(ae,{children:e.jsx(Ce,{id:"alert-dialog-description",children:"Are you sure you want to unpublish this material? It will no longer be visible to users until it is published again."})}),e.jsxs(ie,{children:[e.jsx(A,{onClick:t,color:"primary",children:"Cancel"}),e.jsx(A,{onClick:i,color:"error",autoFocus:!0,children:"Unpublish"})]})]})},rt=({initialCourse:s})=>{const{userDetails:h}=K(),t=Z(),[l,o]=f.useState(s??null),[i,x]=f.useState(!1),[p,j]=f.useState(null),[u,g]=f.useState({open:!1,materialId:null}),[w,F]=f.useState(null),[P,z]=f.useState(!1),k=f.useCallback(async()=>{if(l)try{z(!0);const c=X(t,"courses",l),m=await ke(c);if(m.exists()){const S=m.data(),Y=(S==null?void 0:S.courseAdmin)||[];x(Y.includes(h==null?void 0:h.uid))}else x(!1)}catch(c){console.error("Error fetching course admin status:",c),F("Failed to verify course permissions")}finally{z(!1)}},[l,t,h]);f.useEffect(()=>{l&&k()},[l,k]),f.useEffect(()=>{s&&l!==s&&o(s)},[s,l]);const R=c=>{j(c)},B=()=>{j(null)},$=()=>{console.log("Material deleted:",p),j(null)},M=c=>{g({open:!0,materialId:c})},E=()=>{console.log("Material unpublished:",u.materialId),g({open:!1,materialId:null})},T=()=>{g({open:!1,materialId:null})},n=()=>{F(null)};return e.jsxs(d,{sx:{width:"100%"},children:[l?e.jsx(_,{in:!0,timeout:500,children:e.jsx(d,{children:e.jsx(Ve,{courseId:l,isCourseAdmin:i,onDeleteClick:R,onUnpublishClick:M})})}):e.jsx(je,{maxWidth:"md",children:e.jsxs(d,{sx:{textAlign:"center",py:8,px:4,backgroundColor:r.palette.background.paper,borderRadius:I["2xl"],border:`1px solid ${r.palette.divider}`},children:[e.jsx(a,{variant:"h5",sx:{fontFamily:r.typography.h5.fontFamily,fontWeight:r.typography.h5.fontWeight,color:r.palette.text.secondary,mb:2},children:"Select a Course"}),e.jsx(a,{variant:"body1",sx:{color:r.palette.text.secondary,maxWidth:400,mx:"auto"},children:"Please select a course from the dropdown above to view and manage course materials."})]})}),P&&e.jsx(d,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:4},children:e.jsx(Se,{size:40,sx:{color:r.palette.primary.main}})}),p&&e.jsx(et,{materialId:p,open:!!p,onClose:B,onDelete:$}),u.materialId&&e.jsx(tt,{materialId:u.materialId,open:u.open,onClose:T,onUnpublish:E}),w&&e.jsx(We,{open:!!w,autoHideDuration:6e3,onClose:n,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(ve,{onClose:n,severity:"error",sx:{backgroundColor:r.palette.error.light,color:r.palette.error.contrastText,"& .MuiAlert-icon":{color:r.palette.error.main}},children:w})})]})},Ie=()=>{const{userDetails:s}=K();return f.useMemo(()=>{if(!(s!=null&&s.classes))return{publicCourses:[],userCourses:[]};const t=Object.entries(s.classes).map(([i,x])=>{let p,j;return x.courseCreatedAt&&(x.courseCreatedAt instanceof Date?p=x.courseCreatedAt:p=pe(x.courseCreatedAt)),x.enrolledAt&&(x.enrolledAt instanceof Date?j=x.enrolledAt:j=pe(x.enrolledAt)),{id:i,number:x.number,title:x.title,isPublic:i==="rqoyheM9Lf8jGftIoZyT",courseCreatedAt:p||void 0,enrolledAt:j||void 0,isCourseAdmin:x.isCourseAdmin}}),l=t.filter(i=>i.isPublic),o=t.filter(i=>!i.isPublic);return o.sort((i,x)=>!i.enrolledAt&&!x.enrolledAt?0:i.enrolledAt?x.enrolledAt?x.enrolledAt.getTime()-i.enrolledAt.getTime():-1:1),{publicCourses:l,userCourses:o}},[s==null?void 0:s.classes])},st=({course:s,onClick:h})=>{const t=s.isPublic||s.id==="xsA42JCvfCUtmyoyx45s";return e.jsx(te,{onClick:h,sx:{height:"100%",cursor:"pointer",backgroundColor:y.background.primary,borderRadius:I.xl,border:`1px solid ${y.neutral[200]}`,boxShadow:se.sm,transition:Ue.transitions.normal,position:"relative","&:hover":{transform:"translateY(-8px)",boxShadow:se.xl,border:`1px solid ${t?y.warning:y.primary[500]}`}},children:e.jsx(re,{sx:{textAlign:"center",p:v[4],height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:e.jsxs(d,{sx:{flex:1},children:[e.jsx(d,{sx:{color:t?y.warning:y.primary[500],mb:v[3],display:"flex",justifyContent:"center"},children:e.jsx(Pe,{sx:{fontSize:40}})}),e.jsx(a,{variant:"h6",component:"h3",sx:{fontWeight:C.fontWeight.bold,fontFamily:C.fontFamily.display,fontSize:"2rem",color:y.text.primary,mb:v[2]},children:s.number}),e.jsx(a,{variant:"body2",sx:{color:y.text.secondary,fontFamily:C.fontFamily.secondary,fontSize:C.fontSize.lg,lineHeight:1.5,mb:v[1]},children:s.title}),s.enrolledAt&&e.jsxs(a,{variant:"caption",sx:{color:y.text.tertiary,fontFamily:C.fontFamily.secondary,fontSize:C.fontSize.xs,fontStyle:"italic",mb:v[2],display:"block"},children:["Enrolled: ",s.enrolledAt.toLocaleDateString()]}),e.jsx(G,{label:s.isCourseAdmin?"Instructor Access":"Student Access",size:"small",sx:{backgroundColor:s.isCourseAdmin?y.warning+"20":y.secondary[100],color:s.isCourseAdmin?y.warning:y.secondary[700],fontFamily:C.fontFamily.secondary,fontWeight:C.fontWeight.medium,fontSize:C.fontSize.xs}})]})})})},ge=({title:s,courses:h,onCourseClick:t})=>h.length===0?null:e.jsxs(d,{sx:{mb:v[6]},children:[e.jsxs(d,{sx:{mb:v[4]},children:[e.jsx(a,{variant:"h4",component:"h2",sx:{fontFamily:C.fontFamily.display,fontSize:C.fontSize.xl,fontWeight:C.fontWeight.bold,color:y.text.primary,mb:v[2]},children:s}),e.jsxs(a,{variant:"body1",sx:{fontFamily:C.fontFamily.secondary,fontSize:C.fontSize.base,color:y.text.secondary,lineHeight:1.6},children:[h.length," ",h.length===1?"course":"courses"," available"]})]}),e.jsx(b,{container:!0,spacing:v[4],children:h.map(l=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(st,{course:l,onClick:()=>t(l.id)})},l.id))})]}),nt=({courses:s})=>{const h=le(),{publicCourses:t,userCourses:l}=Ie(),o=i=>{h(`/supplemental-materials?course=${i}`)};return e.jsx(d,{sx:{width:"100%",padding:4},children:e.jsxs(d,{sx:{mb:v[6],p:v[4],backgroundColor:y.background.secondary,borderRadius:I.xl,border:`1px solid ${y.neutral[200]}`,boxShadow:se.sm,position:"relative",mt:v[3]},children:[e.jsx(d,{sx:{position:"absolute",top:"-25px",left:"40px",backgroundColor:y.secondary[500],borderRadius:`${I.lg} ${I.lg} 0 0`,px:v[3],py:v[1],zIndex:1},children:e.jsx(a,{sx:{color:y.text.inverse,fontFamily:C.fontFamily.display,fontSize:"2rem",fontWeight:C.fontWeight.bold,whiteSpace:"nowrap",lineHeight:1},children:"Available Courses"})}),e.jsxs(d,{sx:{mt:v[3]},children:[e.jsx(ge,{title:"Public Course",courses:t,onCourseClick:o}),e.jsx(ge,{title:"Your Enrolled Courses",courses:l,onCourseClick:o})]})]})})},ot=({courseId:s,isAdmin:h=!1})=>{var $,M,E,T;const[t,l]=f.useState(null),[o,i]=f.useState(null),[x,p]=f.useState(!0),[j,u]=f.useState(null),[g,w]=f.useState(!1),F=Z();f.useEffect(()=>{s&&(async()=>{try{p(!0);const c=X(F,"courses",s),m=await ke(c);if(m.exists()){const S=m.data();l(S.additionalInfo||null),i(S.syllabusFile||null)}else u("Course not found")}catch(c){console.error("Error fetching course additional info:",c),u("Failed to load course information")}finally{p(!1)}})()},[s,F]);const P=()=>{o!=null&&o.url&&window.open(o.url,"_blank")},k=(()=>{if(!t)return{};const n=new Set(["contactInfo","policies","additionalResources","labSpecific","textbooks","gradingPolicy","assignments","prerequisites","lastUpdated"]),c={};return Object.keys(t).forEach(m=>{!n.has(m)&&t[m]!=null&&(c[m]=t[m])}),c})(),R=Object.keys(k).length>0,B=t&&(t.contactInfo||t.policies||t.additionalResources||t.labSpecific||(($=t.textbooks)==null?void 0:$.length)||((M=t.gradingPolicy)==null?void 0:M.length)||((E=t.assignments)==null?void 0:E.length)||((T=t.prerequisites)==null?void 0:T.length)||R);return x?e.jsx(d,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(Se,{})}):j?e.jsx(ve,{severity:"error",sx:{mb:3},children:j}):!B&&!o?null:e.jsxs(Re,{sx:{p:3,mb:4,backgroundColor:"#f8f9fa",borderRadius:"15px",border:"1px solid #e3f2fd"},children:[e.jsxs(a,{variant:"h4",sx:{mb:3,display:"flex",alignItems:"center",gap:1,fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"2rem"},children:[e.jsx(xe,{sx:{color:"#0B53C0"}}),"Course Information"]}),o&&e.jsx(d,{sx:{mb:3},children:e.jsx(A,{variant:"outlined",startIcon:e.jsx(ue,{}),endIcon:e.jsx(he,{}),onClick:()=>w(!0),sx:{mb:2,fontFamily:"Staatliches, sans-serif",fontSize:"1.2rem",textTransform:"none",borderRadius:"15px",backgroundColor:"#CDDAFF",color:"#0B53C0",border:"1px solid #0B53C0","&:hover":{backgroundColor:"#0B53C0",color:"#FFFFFF"}},children:"Syllabus"})}),B&&e.jsxs(d,{sx:{mb:2},children:[(t==null?void 0:t.contactInfo)&&Object.keys(t.contactInfo).length>0&&e.jsxs(O,{children:[e.jsx(q,{expandIcon:e.jsx(L,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Be,{sx:{color:"#0B53C0"}}),e.jsx(a,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Contact Information"})]})}),e.jsx(U,{children:e.jsxs(b,{container:!0,spacing:2,children:[t.contactInfo.email&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Email"}),e.jsx(a,{variant:"body1",children:t.contactInfo.email})]}),t.contactInfo.phone&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Phone"}),e.jsx(a,{variant:"body1",children:t.contactInfo.phone})]}),t.contactInfo.office&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Office"}),e.jsx(a,{variant:"body1",children:t.contactInfo.office})]}),t.contactInfo.officeHours&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Office Hours"}),e.jsx(a,{variant:"body1",children:t.contactInfo.officeHours})]}),t.contactInfo.website&&e.jsxs(b,{item:!0,xs:12,children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"Website"}),e.jsx(a,{variant:"body1",children:e.jsx("a",{href:t.contactInfo.website,target:"_blank",rel:"noopener noreferrer",children:t.contactInfo.website})})]})]})})]}),(t==null?void 0:t.textbooks)&&t.textbooks.length>0&&e.jsxs(O,{children:[e.jsx(q,{expandIcon:e.jsx(L,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx($e,{sx:{color:"#0B53C0"}}),e.jsx(a,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Textbooks & Resources"})]})}),e.jsx(U,{children:e.jsx(N,{children:t.textbooks.map((n,c)=>e.jsxs(H,{sx:{px:0,flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(a,{variant:"body1",sx:{fontWeight:"medium"},children:n.title}),e.jsx(G,{label:n.required?"Required":"Optional",size:"small",color:n.required?"error":"default"})]}),e.jsxs(d,{sx:{pl:0},children:[n.author&&e.jsxs(a,{variant:"body2",color:"text.secondary",children:["by ",n.author]}),n.edition&&e.jsxs(a,{variant:"body2",color:"text.secondary",children:["Edition: ",n.edition]}),n.isbn&&e.jsxs(a,{variant:"body2",color:"text.secondary",children:["ISBN: ",n.isbn]})]})]},c))})})]}),(t==null?void 0:t.gradingPolicy)&&t.gradingPolicy.length>0&&e.jsxs(O,{children:[e.jsx(q,{expandIcon:e.jsx(L,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ee,{sx:{color:"#0B53C0"}}),e.jsx(a,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Grading Policy"})]})}),e.jsx(U,{children:e.jsx(N,{children:t.gradingPolicy.map((n,c)=>e.jsxs(H,{sx:{px:0,flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",mb:n.description?1:0},children:[e.jsx(a,{variant:"body1",children:n.component}),e.jsx(G,{label:`${n.percentage}%`,size:"small",color:"primary"})]}),n.description&&e.jsx(a,{variant:"body2",color:"text.secondary",children:n.description})]},c))})})]}),(t==null?void 0:t.labSpecific)&&Object.keys(t.labSpecific).length>0&&e.jsxs(O,{children:[e.jsx(q,{expandIcon:e.jsx(L,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Oe,{sx:{color:"#0B53C0"}}),e.jsx(a,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Laboratory Information"})]})}),e.jsx(U,{children:e.jsxs(b,{container:!0,spacing:3,children:[t.labSpecific.safetyRequirements&&e.jsxs(b,{item:!0,xs:12,children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Safety Requirements"}),e.jsx(N,{dense:!0,children:t.labSpecific.safetyRequirements.map((n,c)=>e.jsx(H,{sx:{py:.5},children:e.jsxs(a,{variant:"body2",children:["â€¢ ",n]})},c))})]}),t.labSpecific.dresscode&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Dress Code"}),e.jsx(N,{dense:!0,children:t.labSpecific.dresscode.map((n,c)=>e.jsx(H,{sx:{py:.5},children:e.jsxs(a,{variant:"body2",children:["â€¢ ",n]})},c))})]}),t.labSpecific.requiredEquipment&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Required Equipment"}),e.jsx(N,{dense:!0,children:t.labSpecific.requiredEquipment.map((n,c)=>e.jsx(H,{sx:{py:.5},children:e.jsxs(a,{variant:"body2",children:["â€¢ ",n]})},c))})]})]})})]}),(t==null?void 0:t.policies)&&Object.keys(t.policies).length>0&&e.jsxs(O,{children:[e.jsx(q,{expandIcon:e.jsx(L,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(qe,{sx:{color:"#0B53C0"}}),e.jsx(a,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Course Policies"})]})}),e.jsx(U,{children:e.jsx(b,{container:!0,spacing:2,children:Object.entries(t.policies).map(([n,c])=>{if(!c)return null;const m=n.replace(/([A-Z])/g," $1").replace(/^./,S=>S.toUpperCase());return e.jsxs(b,{item:!0,xs:12,children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:m}),e.jsx(a,{variant:"body2",sx:{mt:.5},children:c}),e.jsx(fe,{sx:{mt:1}})]},n)})})})]}),R&&e.jsxs(O,{children:[e.jsx(q,{expandIcon:e.jsx(L,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(xe,{sx:{color:"#0B53C0"}}),e.jsx(a,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Other Course Information"})]})}),e.jsx(U,{children:e.jsx(b,{container:!0,spacing:2,children:Object.entries(k).map(([n,c])=>{const m=n.replace(/([A-Z])/g," $1").replace(/^./,S=>S.toUpperCase());return e.jsxs(b,{item:!0,xs:12,children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:m}),e.jsx(d,{sx:{mt:.5},children:Array.isArray(c)?e.jsx(N,{dense:!0,children:c.map((S,Y)=>e.jsx(H,{sx:{py:.25,px:0},children:e.jsxs(a,{variant:"body2",children:["â€¢ ",typeof S=="object"?JSON.stringify(S,null,2):String(S)]})},Y))}):typeof c=="object"?e.jsx(d,{sx:{p:1,backgroundColor:"grey.100",borderRadius:1},children:e.jsx(a,{variant:"body2",component:"pre",sx:{fontFamily:"monospace",fontSize:"0.875rem"},children:JSON.stringify(c,null,2)})}):e.jsx(a,{variant:"body2",children:String(c)})}),Object.keys(k).indexOf(n)<Object.keys(k).length-1&&e.jsx(fe,{sx:{mt:2}})]},n)})})})]})]}),e.jsxs(ne,{open:g,onClose:()=>w(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"15px",backgroundColor:"#f8f9fa"}},children:[e.jsxs(oe,{sx:{display:"flex",alignItems:"center",gap:1,fontFamily:"Staatliches, sans-serif",fontSize:"1.5rem",fontWeight:"bold",color:"#0B53C0",backgroundColor:"#ECF4FE",borderBottom:"1px solid #e3f2fd"},children:[e.jsx(ue,{sx:{color:"#0B53C0"}}),"Syllabus Document"]}),e.jsx(ae,{sx:{pt:3},children:o&&e.jsxs(d,{children:[e.jsxs(a,{variant:"body1",sx:{mb:2,fontFamily:"Staatliches, sans-serif",fontSize:"1.1rem",color:"#0B53C0"},children:[e.jsx("strong",{children:"Filename:"})," ",o.metadata.originalFilename]}),e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[e.jsx("strong",{children:"Type:"})," ",Ne(o.metadata.fileType)]}),e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[e.jsx("strong",{children:"Size:"})," ",He(o.metadata.fileSize)]}),e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mb:2},children:[e.jsx("strong",{children:"Uploaded:"})," ",(()=>{if(!o.metadata.uploadedAt)return"Date not available";const n=o.metadata.uploadedAt;if(n instanceof Date)return n.toLocaleDateString();if(typeof n=="object"&&n!==null&&"seconds"in n)return new Date(n.seconds*1e3).toLocaleDateString();try{return new Date(n).toLocaleDateString()}catch{return"Date not available"}})()]})]})}),e.jsxs(ie,{sx:{p:3,gap:2},children:[e.jsx(A,{onClick:()=>w(!1),sx:{fontFamily:"Staatliches, sans-serif",fontSize:"1.1rem",textTransform:"none",borderRadius:"15px",color:"#666","&:hover":{backgroundColor:"#f0f0f0"}},children:"Close"}),e.jsx(A,{onClick:P,variant:"contained",startIcon:e.jsx(he,{}),sx:{fontFamily:"Staatliches, sans-serif",fontSize:"1.1rem",textTransform:"none",borderRadius:"15px",backgroundColor:"#CDDAFF",color:"#0B53C0","&:hover":{backgroundColor:"#0B53C0",color:"#FFFFFF"}},children:"Download"})]})]})]})},dt=()=>{const{userDetails:s}=K(),{userCourses:h}=Ie(),[t]=Ge(),l=t.get("course")||null,o=f.useMemo(()=>{const i=h.find(x=>x.id===l);return l&&i&&console.log("[SupplementalMaterials] Selected course data:",{courseId:l,courseTitle:i.title,isCourseAdmin:i.isCourseAdmin,userIsAdmin:s==null?void 0:s.isAdmin,shouldShowAddButton:(s==null?void 0:s.isAdmin)&&i.isCourseAdmin,timestamp:new Date().toISOString()}),i},[h,l,s==null?void 0:s.isAdmin]);return e.jsxs(d,{className:"supplemental-container",children:[e.jsx(Xe,{}),l?e.jsxs(d,{children:[e.jsx(d,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:3},children:e.jsx(G,{label:o?`${o.number} - ${o.title}`:"Selected Course",variant:"outlined",sx:{borderRadius:"15px",fontSize:"32px",fontWeight:"bold",background:"#e0f2f1",color:"#00695c",cursor:"pointer",transition:"background-color 0.3s",fontFamily:"Staatliches, sans-serif",padding:"20px 20px","&:hover":{backgroundColor:"#b2dfdb"}}})}),e.jsx(ot,{courseId:l,isAdmin:s==null?void 0:s.isAdmin}),e.jsxs(d,{className:"supplemental-content",children:[(s==null?void 0:s.isAdmin)&&(o==null?void 0:o.isCourseAdmin)&&e.jsx(Qe,{selectedCourse:l}),e.jsx(rt,{initialCourse:l})]})]}):e.jsx(e.Fragment,{children:e.jsx(nt,{courses:h})})]})};export{dt as default};
