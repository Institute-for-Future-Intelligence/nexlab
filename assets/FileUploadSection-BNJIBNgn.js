const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-7OGRd8_x.js","assets/ui-D-CDl99o.js","assets/vendor-BFl3bqVE.js","assets/firebase-CTJJwFJC.js","assets/index-BA2bQjcR.css"])))=>i.map(i=>d[i]);
var Jt=Object.defineProperty;var er=(v,g,p)=>g in v?Jt(v,g,{enumerable:!0,configurable:!0,writable:!0,value:p}):v[g]=p;var wt=(v,g,p)=>er(v,typeof g!="symbol"?g+"":g,p);import{h as tr,i as rr,p as nr,_ as ot,b as re,s as G,c as N,t as q,R as ir,a as It,v as pt}from"./index-7OGRd8_x.js";import{l as sr,P as or,q as at,h as De,_ as Fe,e as ve,i as lt,R as Ge,v as Re,t as Qe,y as Be,f as dt,x as At,k as Ke,r as Ze,z as Ft,n as Rt,p as kt}from"./firebase-CTJJwFJC.js";import{j as P,V as jt,W as ar,B as ae,bF as lr,T as oe,X as Tt,Z as dr,a as Xe,r as le,t as Ye,I as We,bG as cr,bH as Ct,bI as _t,a7 as Dt,aJ as Mt,al as zt,A as Pt,G as St,E as fr,by as ur,H as hr,z as gr,ac as pr,bw as br,a8 as Lt,b1 as mr,aK as bt,a0 as yr,a1 as vr,b9 as xr,a2 as wr,bz as Ir,v as Ar,bA as Cr,bB as _r,at as Ut,bC as Dr,bD as Sr}from"./ui-D-CDl99o.js";import ct from"./purify.es-CQJ0hv7W.js";const Oe=v=>v?v instanceof sr||v.toDate&&typeof v.toDate=="function"?v.toDate():v.seconds?new Date(v.seconds*1e3):new Date:new Date,ft={courseId:null,searchQuery:"",dateRange:{start:null,end:null},nodeTypes:{designs:!0,builds:!0,tests:!0}},ut={x:0,y:0,zoom:1},Gr=tr()(rr(nr((v,g)=>({designs:[],builds:[],tests:[],nodes:[],edges:[],selectedNodeId:null,hoveredNodeId:null,isLoading:!1,error:null,activePanel:null,layoutType:"horizontal",viewMode:"graph",isExpanded:!1,deleteDialog:{open:!1,nodeId:null,nodeType:null,nodeName:null},filters:ft,viewport:ut,fetchAllData:async(p,i=!1,e=[])=>{v({isLoading:!0,error:null});try{const{collection:t,query:l,where:o,getDocs:m,orderBy:x}=await ot(async()=>{const{collection:k,query:U,where:_,getDocs:T,orderBy:h}=await import("./firebase-CTJJwFJC.js").then(E=>E.B);return{collection:k,query:U,where:_,getDocs:T,orderBy:h}},[]),{db:n}=await ot(async()=>{const{db:k}=await import("./index-7OGRd8_x.js").then(U=>U.G);return{db:k}},__vite__mapDeps([0,1,2,3,4]));let s;i&&e.length>0?s=l(t(n,"designs"),o("course","in",e),x("dateCreated","desc")):s=l(t(n,"designs"),o("userId","==",p),x("dateCreated","desc"));const a=(await m(s)).docs.map(k=>{const U=k.data();return{id:k.id,title:U.title||"",description:U.description||"",course:U.course||"",dateCreated:U.dateCreated,dateModified:U.dateModified,userId:U.userId||"",images:U.images||[],files:U.files||[]}}),b=a.map(k=>k.id);let D=[];if(b.length>0){const k=[];for(let _=0;_<b.length;_+=10){const T=b.slice(_,_+10),h=l(t(n,"builds"),o("design_ID","in",T));k.push(m(h))}D=(await Promise.all(k)).flatMap(_=>_.docs.map(T=>{const h=T.data();return{id:T.id,title:h.title||"",description:h.description||"",design_ID:h.design_ID||"",dateCreated:h.dateCreated,userId:h.userId||"",images:h.images||[],files:h.files||[]}}))}const F=D.map(k=>k.id);let y=[];if(F.length>0){const k=[];for(let _=0;_<F.length;_+=10){const T=F.slice(_,_+10),h=l(t(n,"tests"),o("build_ID","in",T));k.push(m(h))}y=(await Promise.all(k)).flatMap(_=>_.docs.map(T=>{const h=T.data();return{id:T.id,title:h.title||"",description:h.description||"",results:h.results||"",conclusions:h.conclusions||"",build_ID:h.build_ID||"",design_ID:h.design_ID||"",dateCreated:h.dateCreated,userId:h.userId||"",images:h.images||[],files:h.files||[]}}))}v({designs:a,builds:D,tests:y,isLoading:!1}),g().buildGraph()}catch(t){console.error("Error fetching lab notebook data:",t);const l=t instanceof Error?t.message:String(t),o=l.includes("permission")||l.includes("insufficient")||l.includes("PERMISSION_DENIED");v({error:o?"Database permissions not configured. Please contact your administrator or deploy Firebase security rules. See docs/FIREBASE_RULES_SETUP.md for instructions.":t instanceof Error?t.message:"Failed to fetch data",isLoading:!1})}},setDesigns:p=>{v({designs:p}),g().buildGraph()},addDesign:p=>{v(i=>({designs:[...i.designs,p]})),g().buildGraph()},updateDesignLocal:(p,i)=>{v(e=>({designs:e.designs.map(t=>t.id===p?{...t,...i}:t)})),g().buildGraph()},removeDesign:p=>{v(i=>({designs:i.designs.filter(e=>e.id!==p),builds:i.builds.filter(e=>e.design_ID!==p),tests:i.tests.filter(e=>e.design_ID!==p)})),g().buildGraph()},setBuilds:p=>{v({builds:p}),g().buildGraph()},addBuild:p=>{v(i=>({builds:[...i.builds,p]})),g().buildGraph()},updateBuildLocal:(p,i)=>{v(e=>({builds:e.builds.map(t=>t.id===p?{...t,...i}:t)})),g().buildGraph()},removeBuild:p=>{v(i=>({builds:i.builds.filter(e=>e.id!==p),tests:i.tests.filter(e=>e.build_ID!==p)})),g().buildGraph()},setTests:p=>{v({tests:p}),g().buildGraph()},addTest:p=>{v(i=>({tests:[...i.tests,p]})),g().buildGraph()},updateTestLocal:(p,i)=>{v(e=>({tests:e.tests.map(t=>t.id===p?{...t,...i}:t)})),g().buildGraph()},removeTest:p=>{v(i=>({tests:i.tests.filter(e=>e.id!==p)})),g().buildGraph()},buildGraph:()=>{const p=g(),{designs:i,builds:e,tests:t,filters:l}=p;let o=i,m=e,x=t;if(l.courseId){o=o.filter(b=>b.course===l.courseId);const r=o.map(b=>b.id);m=m.filter(b=>r.includes(b.design_ID));const a=m.map(b=>b.id);x=x.filter(b=>a.includes(b.build_ID))}if(l.searchQuery){const r=l.searchQuery.toLowerCase();o=o.filter(a=>a.title.toLowerCase().includes(r)||a.description.toLowerCase().includes(r)),m=m.filter(a=>a.title.toLowerCase().includes(r)||a.description.toLowerCase().includes(r)),x=x.filter(a=>a.title.toLowerCase().includes(r)||a.description.toLowerCase().includes(r))}l.nodeTypes.designs||(o=[]),l.nodeTypes.builds||(m=[]),l.nodeTypes.tests||(x=[]);const n=[],s=[];o.forEach((r,a)=>{const b=m.filter(F=>F.design_ID===r.id).length,D=x.filter(F=>F.design_ID===r.id).length;n.push({id:`design-${r.id}`,type:"designNode",position:{x:0,y:a*200},data:{type:"design",designId:r.id,label:r.title,title:r.title,description:r.description,dateCreated:Oe(r.dateCreated),dateModified:Oe(r.dateModified),userId:r.userId,images:r.images||[],files:r.files||[],course:r.course,buildCount:b,testCount:D}})}),m.forEach((r,a)=>{const b=x.filter(D=>D.build_ID===r.id).length;n.push({id:`build-${r.id}`,type:"buildNode",position:{x:400,y:a*180},data:{type:"build",buildId:r.id,designId:r.design_ID,label:r.title,title:r.title,description:r.description,dateCreated:Oe(r.dateCreated),dateModified:Oe(r.dateModified),userId:r.userId,images:r.images||[],files:r.files||[],testCount:b}}),s.push({id:`edge-design-${r.design_ID}-build-${r.id}`,source:`design-${r.design_ID}`,target:`build-${r.id}`,type:"smoothstep",animated:!1})}),x.forEach((r,a)=>{n.push({id:`test-${r.id}`,type:"testNode",position:{x:800,y:a*180},data:{type:"test",testId:r.id,buildId:r.build_ID,designId:r.design_ID,label:r.title,title:r.title,description:r.description,results:r.results,conclusions:r.conclusions,dateCreated:Oe(r.dateCreated),dateModified:Oe(r.dateModified),userId:r.userId,images:r.images||[],files:r.files||[]}}),s.push({id:`edge-build-${r.build_ID}-test-${r.id}`,source:`build-${r.build_ID}`,target:`test-${r.id}`,type:"smoothstep",animated:!1})}),v({nodes:n,edges:s})},selectNode:p=>{v({selectedNodeId:p}),p&&v({activePanel:"detail"})},setHoveredNode:p=>{v({hoveredNodeId:p})},updateNodePosition:(p,i)=>{v(e=>({nodes:e.nodes.map(t=>t.id===p?{...t,position:i}:t)}))},resetGraph:()=>{v({nodes:[],edges:[],selectedNodeId:null,hoveredNodeId:null})},setLoading:p=>v({isLoading:p}),setError:p=>v({error:p}),setActivePanel:p=>v({activePanel:p}),setLayoutType:p=>v({layoutType:p}),setViewMode:p=>v({viewMode:p}),setIsExpanded:p=>v({isExpanded:p}),openDeleteDialog:(p,i,e)=>v({deleteDialog:{open:!0,nodeId:p,nodeType:i,nodeName:e}}),closeDeleteDialog:()=>v({deleteDialog:{open:!1,nodeId:null,nodeType:null,nodeName:null}}),confirmDelete:async()=>{const p=g(),{nodeId:i,nodeType:e}=p.deleteDialog;if(!(!i||!e))try{const{labNotebookService:t}=await ot(async()=>{const{labNotebookService:m}=await Promise.resolve().then(()=>Fr);return{labNotebookService:m}},void 0),l=p.nodes.find(m=>m.id.includes(i));if(!l)return;const o=l.data.userId;e==="build"?(await t.deleteBuild(i,o),g().removeBuild(i)):e==="test"&&(await t.deleteTest(i,o),g().removeTest(i)),g().closeDeleteDialog(),g().selectNode(null),g().setActivePanel(null),await g().fetchAllData(o,!1,[])}catch(t){console.error("Error deleting:",t),v({error:t instanceof Error?t.message:"Failed to delete"})}},setSelectedCourse:p=>{v(i=>({filters:{...i.filters,courseId:p}})),g().buildGraph()},setSearchQuery:p=>{v(i=>({filters:{...i.filters,searchQuery:p}})),g().buildGraph()},setDateRange:(p,i)=>{v(e=>({filters:{...e.filters,dateRange:{start:p,end:i}}})),g().buildGraph()},toggleNodeTypeFilter:p=>{v(i=>({filters:{...i.filters,nodeTypes:{...i.filters.nodeTypes,[p]:!i.filters.nodeTypes[p]}}})),g().buildGraph()},resetFilters:()=>{v({filters:ft}),g().buildGraph()},setViewport:p=>v({viewport:p}),resetViewport:()=>v({viewport:ut}),getGraphMetrics:()=>{const p=g();return{designCount:p.designs.length,buildCount:p.builds.length,testCount:p.tests.length,totalNodes:p.nodes.length,totalEdges:p.edges.length}},getNodeById:p=>g().nodes.find(i=>i.id===p),getDesignById:p=>g().designs.find(i=>i.id===p),getBuildById:p=>g().builds.find(i=>i.id===p),getTestById:p=>g().tests.find(i=>i.id===p),getBuildsByDesignId:p=>g().builds.filter(i=>i.design_ID===p),getTestsByBuildId:p=>g().tests.filter(i=>i.build_ID===p),reset:()=>{v({designs:[],builds:[],tests:[],nodes:[],edges:[],selectedNodeId:null,hoveredNodeId:null,isLoading:!1,error:null,activePanel:null,filters:ft,viewport:ut})}}),{name:"lab-notebook-storage",partialize:v=>({layoutType:v.layoutType,viewMode:v.viewMode,viewport:v.viewport})}),{name:"LabNotebookStore"}));class Ur{constructor(){wt(this,"db",null)}initialize(){this.db||(this.db=or())}async createDesign(g){this.initialize();const p={title:g.title,description:g.description,course:g.course,userId:g.userId,dateCreated:De(),dateModified:De(),images:g.images||[],files:g.files||[]},i=await at(Fe(this.db,"designs"),p);return console.log("Design created with ID:",i.id),i.id}async updateDesign(g){this.initialize();const p={dateModified:De()};g.title!==void 0&&(p.title=g.title),g.description!==void 0&&(p.description=g.description),g.course!==void 0&&(p.course=g.course),g.images!==void 0&&(p.images=g.images),g.files!==void 0&&(p.files=g.files);const i=ve(this.db,"designs",g.id);await lt(i,p),console.log("Design updated:",g.id)}async deleteDesign(g,p){this.initialize();const i=Ge(Fe(this.db,"builds"),Re("design_ID","==",g),Re("userId","==",p)),e=await Qe(i);for(const t of e.docs){const l=t.id,o=Ge(Fe(this.db,"tests"),Re("build_ID","==",l),Re("userId","==",p)),m=await Qe(o);for(const x of m.docs)await Be(ve(this.db,"tests",x.id)),console.log("Test deleted:",x.id);await Be(ve(this.db,"builds",l)),console.log("Build deleted:",l)}await Be(ve(this.db,"designs",g)),console.log("Design deleted:",g)}async getDesign(g){this.initialize();const p=ve(this.db,"designs",g),i=await dt(p);if(i.exists()){const e=i.data();return{id:i.id,title:e.title||"",description:e.description||"",course:e.course||"",dateCreated:e.dateCreated,dateModified:e.dateModified,userId:e.userId||"",images:e.images||[],files:e.files||[]}}return null}async createBuild(g){this.initialize();const p={title:g.title,description:g.description,design_ID:g.designId,userId:g.userId,dateCreated:De(),dateModified:De(),images:g.images||[],files:g.files||[]},i=await at(Fe(this.db,"builds"),p);return console.log("Build created with ID:",i.id),i.id}async updateBuild(g){this.initialize();const p={dateModified:De()};g.title!==void 0&&(p.title=g.title),g.description!==void 0&&(p.description=g.description),g.images!==void 0&&(p.images=g.images),g.files!==void 0&&(p.files=g.files);const i=ve(this.db,"builds",g.id);await lt(i,p),console.log("Build updated:",g.id)}async deleteBuild(g,p){this.initialize();const i=Ge(Fe(this.db,"tests"),Re("build_ID","==",g),Re("userId","==",p)),e=await Qe(i);for(const t of e.docs)await Be(ve(this.db,"tests",t.id)),console.log("Test deleted:",t.id);await Be(ve(this.db,"builds",g)),console.log("Build deleted:",g)}async getBuild(g){this.initialize();const p=ve(this.db,"builds",g),i=await dt(p);if(i.exists()){const e=i.data();return{id:i.id,title:e.title||"",description:e.description||"",design_ID:e.design_ID||"",dateCreated:e.dateCreated,userId:e.userId||"",images:e.images||[],files:e.files||[]}}return null}async getBuildsByDesign(g){this.initialize();const p=Ge(Fe(this.db,"builds"),Re("design_ID","==",g),At("dateCreated","desc"));return(await Qe(p)).docs.map(e=>{const t=e.data();return{id:e.id,title:t.title||"",description:t.description||"",design_ID:t.design_ID||"",dateCreated:t.dateCreated,dateModified:t.dateModified,userId:t.userId||"",images:t.images||[],files:t.files||[]}})}async createTest(g){this.initialize();const p={title:g.title,description:g.description,results:g.results,conclusions:g.conclusions,build_ID:g.buildId,design_ID:g.designId,userId:g.userId,dateCreated:De(),dateModified:De(),images:g.images||[],files:g.files||[]},i=await at(Fe(this.db,"tests"),p);return console.log("Test created with ID:",i.id),i.id}async updateTest(g){this.initialize();const p={dateModified:De()};g.title!==void 0&&(p.title=g.title),g.description!==void 0&&(p.description=g.description),g.results!==void 0&&(p.results=g.results),g.conclusions!==void 0&&(p.conclusions=g.conclusions),g.images!==void 0&&(p.images=g.images),g.files!==void 0&&(p.files=g.files);const i=ve(this.db,"tests",g.id);await lt(i,p),console.log("Test updated:",g.id)}async deleteTest(g,p){this.initialize(),await Be(ve(this.db,"tests",g)),console.log("Test deleted:",g)}async getTest(g){this.initialize();const p=ve(this.db,"tests",g),i=await dt(p);if(i.exists()){const e=i.data();return{id:i.id,title:e.title||"",description:e.description||"",results:e.results||"",conclusions:e.conclusions||"",build_ID:e.build_ID||"",design_ID:e.design_ID||"",dateCreated:e.dateCreated,dateModified:e.dateModified,userId:e.userId||"",images:e.images||[],files:e.files||[]}}return null}async getTestsByBuild(g){this.initialize();const p=Ge(Fe(this.db,"tests"),Re("build_ID","==",g),At("dateCreated","desc"));return(await Qe(p)).docs.map(e=>{const t=e.data();return{id:e.id,title:t.title||"",description:t.description||"",results:t.results||"",conclusions:t.conclusions||"",build_ID:t.build_ID||"",design_ID:t.design_ID||"",dateCreated:t.dateCreated,dateModified:t.dateModified,userId:t.userId||"",images:t.images||[],files:t.files||[]}})}}let ht=null;const Bt=()=>(ht||(ht=new Ur),ht),Er=Bt(),Fr=Object.freeze(Object.defineProperty({__proto__:null,getLabNotebookService:Bt,labNotebookService:Er},Symbol.toStringTag,{value:"Module"})),Qr=({open:v,title:g,message:p,confirmLabel:i="Confirm",cancelLabel:e="Cancel",onConfirm:t,onCancel:l,isDestructive:o=!1})=>P.jsxs(jt,{open:v,onClose:l,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:re.xl}},children:[P.jsx(ar,{children:P.jsxs(ae,{sx:{display:"flex",alignItems:"center",gap:G[2]},children:[o&&P.jsx(lr,{sx:{color:N.error,fontSize:28}}),P.jsx(oe,{variant:"h5",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.bold,color:N.text.primary},children:g})]})}),P.jsx(Tt,{children:P.jsx(oe,{variant:"body1",sx:{color:N.text.secondary,lineHeight:q.lineHeight.relaxed},children:p})}),P.jsxs(dr,{sx:{p:G[3],gap:G[2]},children:[P.jsx(Xe,{onClick:l,variant:"outlined",sx:{borderRadius:re.md,textTransform:"none",fontWeight:q.fontWeight.medium},children:e}),P.jsx(Xe,{onClick:t,variant:"contained",sx:{borderRadius:re.md,textTransform:"none",fontWeight:q.fontWeight.medium,backgroundColor:o?N.error:N.primary[500],"&:hover":{backgroundColor:o?"#C62828":N.primary[600]}},children:i})]})]}),qr=({value:v,onChange:g,placeholder:p="Start writing...",minHeight:i=200,disabled:e=!1})=>{const[t,l]=le.useState(ct.sanitize(v||"")),[o,m]=le.useState(null),[x,n]=le.useState(null),s=le.useRef(null),r=le.useRef(!1);le.useEffect(()=>{if(r.current){const h=ct.sanitize(v||"");h!==t&&l(h)}else r.current=!0},[v]);const a=h=>{const E=ct.sanitize(h);l(E),g(E)},b=h=>{if(!s.current){console.warn("Editor not initialized");return}const E=s.current.getEditor(),c=E.getSelection();if(c)E.insertText(c.index,h),E.setSelection(c.index+h.length);else{const f=E.getText().length;E.insertText(f,h),E.setSelection(f+h.length)}m(null),n(null),E.focus()},D=h=>{m(h.currentTarget),n(null)},F=h=>{n(h.currentTarget),m(null)},y=()=>{m(null),n(null)},k=["α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω","Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω"],U=["+","−","×","÷","±","=","≈","≠","≤","≥","<",">","°","∞","√","∑","∫","π","Δ","∂","∇","∈","∉","⊂","⊃","∩","∪","∅"],_={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],["blockquote","code-block"],["link"],["clean"]]},T=["header","bold","italic","underline","strike","list","script","indent","blockquote","code-block","link"];return P.jsxs(ae,{children:[P.jsxs(ae,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:G[1],mb:G[2]},children:[P.jsx(oe,{variant:"body2",sx:{color:N.text.secondary,fontSize:q.fontSize.sm,fontWeight:q.fontWeight.medium,mr:G[1]},children:"Insert:"}),P.jsx(Ye,{title:"Math Symbols",placement:"top",children:P.jsx(We,{onClick:D,disabled:e,size:"small",sx:{border:`1px solid ${N.neutral[300]}`,borderRadius:re.md,backgroundColor:o?N.primary[50]:N.background.primary,"&:hover":{backgroundColor:N.primary[50],borderColor:N.primary[400]}},children:P.jsx(cr,{sx:{fontSize:18,color:N.primary[600]}})})}),P.jsx(Ye,{title:"Greek Letters",placement:"top",children:P.jsx(We,{onClick:F,disabled:e,size:"small",sx:{border:`1px solid ${N.neutral[300]}`,borderRadius:re.md,backgroundColor:x?N.primary[50]:N.background.primary,fontWeight:q.fontWeight.bold,fontSize:q.fontSize.lg,color:N.primary[600],"&:hover":{backgroundColor:N.primary[50],borderColor:N.primary[400]}},children:"Ω"})})]}),P.jsx(Ct,{open:!!o,anchorEl:o,onClose:y,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{"& .MuiPopover-paper":{borderRadius:re.lg,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)",mt:G[1]}},children:P.jsxs(ae,{sx:{p:G[2],maxWidth:320},children:[P.jsx(oe,{variant:"subtitle2",sx:{fontWeight:q.fontWeight.semibold,color:N.text.primary,mb:G[2]},children:"Math Symbols"}),P.jsx(ae,{sx:{display:"grid",gridTemplateColumns:"repeat(8, 1fr)",gap:G[1]},children:U.map(h=>P.jsx(_t,{onClick:()=>b(h),sx:{width:32,height:32,borderRadius:re.md,border:`1px solid ${N.neutral[200]}`,backgroundColor:N.background.primary,fontSize:q.fontSize.lg,fontWeight:q.fontWeight.medium,color:N.text.primary,transition:"all 0.2s","&:hover":{backgroundColor:N.primary[50],borderColor:N.primary[400],transform:"scale(1.1)"}},children:h},h))})]})}),P.jsx(Ct,{open:!!x,anchorEl:x,onClose:y,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{"& .MuiPopover-paper":{borderRadius:re.lg,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)",mt:G[1]}},children:P.jsxs(ae,{sx:{p:G[2],maxWidth:360},children:[P.jsx(oe,{variant:"subtitle2",sx:{fontWeight:q.fontWeight.semibold,color:N.text.primary,mb:G[2]},children:"Greek Letters"}),P.jsx(ae,{sx:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:G[1]},children:k.map(h=>P.jsx(_t,{onClick:()=>b(h),sx:{width:28,height:28,borderRadius:re.md,border:`1px solid ${N.neutral[200]}`,backgroundColor:N.background.primary,fontSize:q.fontSize.base,fontWeight:q.fontWeight.medium,color:N.text.primary,transition:"all 0.2s","&:hover":{backgroundColor:N.primary[50],borderColor:N.primary[400],transform:"scale(1.15)"}},children:h},h))})]})}),P.jsx(ae,{sx:{"& .quill":{borderRadius:re.lg,border:`1px solid ${N.neutral[300]}`,backgroundColor:N.background.primary},"& .ql-toolbar":{borderTopLeftRadius:re.lg,borderTopRightRadius:re.lg,borderBottom:`1px solid ${N.neutral[200]}`,backgroundColor:N.background.secondary},"& .ql-container":{borderBottomLeftRadius:re.lg,borderBottomRightRadius:re.lg,minHeight:`${i}px`,fontSize:q.fontSize.base,fontFamily:q.fontFamily.body},"& .ql-editor":{minHeight:`${i}px`,color:N.text.primary},"& .ql-editor.ql-blank::before":{color:N.text.tertiary,fontStyle:"normal"}},children:P.jsx(ir,{ref:s,value:t,onChange:a,modules:_,formats:T,theme:"snow",placeholder:p,readOnly:e})})]})};function Rr(v,g){return g.forEach(function(p){p&&typeof p!="string"&&!Array.isArray(p)&&Object.keys(p).forEach(function(i){if(i!=="default"&&!(i in v)){var e=Object.getOwnPropertyDescriptor(p,i);Object.defineProperty(v,i,e.get?e:{enumerable:!0,get:function(){return p[i]}})}})}),Object.freeze(v)}function Ot(v,g){return new Promise(function(p,i){let e;return kr(v).then(function(t){try{return e=t,p(new Blob([g.slice(0,2),e,g.slice(2)],{type:"image/jpeg"}))}catch(l){return i(l)}},i)})}const kr=v=>new Promise((g,p)=>{const i=new FileReader;i.addEventListener("load",({target:{result:e}})=>{const t=new DataView(e);let l=0;if(t.getUint16(l)!==65496)return p("not a valid JPEG");for(l+=2;;){const o=t.getUint16(l);if(o===65498)break;const m=t.getUint16(l+2);if(o===65505&&t.getUint32(l+4)===1165519206){const x=l+10;let n;switch(t.getUint16(x)){case 18761:n=!0;break;case 19789:n=!1;break;default:return p("TIFF header contains invalid endian")}if(t.getUint16(x+2,n)!==42)return p("TIFF header contains invalid version");const s=t.getUint32(x+4,n),r=x+s+2+12*t.getUint16(x+s,n);for(let a=x+s+2;a<r;a+=12)if(t.getUint16(a,n)==274){if(t.getUint16(a+2,n)!==3)return p("Orientation data type is invalid");if(t.getUint32(a+4,n)!==1)return p("Orientation data count is invalid");t.setUint16(a+8,1,n);break}return g(e.slice(l,l+2+m))}l+=2+m}return g(new Blob)}),i.readAsArrayBuffer(v)});var Je={},jr={get exports(){return Je},set exports(v){Je=v}};(function(v){var g,p,i={};jr.exports=i,i.parse=function(e,t){for(var l=i.bin.readUshort,o=i.bin.readUint,m=0,x={},n=new Uint8Array(e),s=n.length-4;o(n,s)!=101010256;)s--;m=s,m+=4;var r=l(n,m+=4);l(n,m+=2);var a=o(n,m+=2),b=o(n,m+=4);m+=4,m=b;for(var D=0;D<r;D++){o(n,m),m+=4,m+=4,m+=4,o(n,m+=4),a=o(n,m+=4);var F=o(n,m+=4),y=l(n,m+=4),k=l(n,m+2),U=l(n,m+4);m+=6;var _=o(n,m+=8);m+=4,m+=y+k+U,i._readLocal(n,_,x,a,F,t)}return x},i._readLocal=function(e,t,l,o,m,x){var n=i.bin.readUshort,s=i.bin.readUint;s(e,t),n(e,t+=4),n(e,t+=2);var r=n(e,t+=2);s(e,t+=2),s(e,t+=4),t+=4;var a=n(e,t+=8),b=n(e,t+=2);t+=2;var D=i.bin.readUTF8(e,t,a);if(t+=a,t+=b,x)l[D]={size:m,csize:o};else{var F=new Uint8Array(e.buffer,t);if(r==0)l[D]=new Uint8Array(F.buffer.slice(t,t+o));else{if(r!=8)throw"unknown compression method: "+r;var y=new Uint8Array(m);i.inflateRaw(F,y),l[D]=y}}},i.inflateRaw=function(e,t){return i.F.inflate(e,t)},i.inflate=function(e,t){return e[0],e[1],i.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},i.deflate=function(e,t){t==null&&(t={level:6});var l=0,o=new Uint8Array(50+Math.floor(1.1*e.length));o[l]=120,o[l+1]=156,l+=2,l=i.F.deflateRaw(e,o,l,t.level);var m=i.adler(e,0,e.length);return o[l+0]=m>>>24&255,o[l+1]=m>>>16&255,o[l+2]=m>>>8&255,o[l+3]=m>>>0&255,new Uint8Array(o.buffer,0,l+4)},i.deflateRaw=function(e,t){t==null&&(t={level:6});var l=new Uint8Array(50+Math.floor(1.1*e.length)),o=i.F.deflateRaw(e,l,o,t.level);return new Uint8Array(l.buffer,0,o)},i.encode=function(e,t){t==null&&(t=!1);var l=0,o=i.bin.writeUint,m=i.bin.writeUshort,x={};for(var n in e){var s=!i._noNeed(n)&&!t,r=e[n],a=i.crc.crc(r,0,r.length);x[n]={cpr:s,usize:r.length,crc:a,file:s?i.deflateRaw(r):r}}for(var n in x)l+=x[n].file.length+30+46+2*i.bin.sizeUTF8(n);l+=22;var b=new Uint8Array(l),D=0,F=[];for(var n in x){var y=x[n];F.push(D),D=i._writeHeader(b,D,n,y,0)}var k=0,U=D;for(var n in x)y=x[n],F.push(D),D=i._writeHeader(b,D,n,y,1,F[k++]);var _=D-U;return o(b,D,101010256),D+=4,m(b,D+=4,k),m(b,D+=2,k),o(b,D+=2,_),o(b,D+=4,U),D+=4,D+=2,b.buffer},i._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},i._writeHeader=function(e,t,l,o,m,x){var n=i.bin.writeUint,s=i.bin.writeUshort,r=o.file;return n(e,t,m==0?67324752:33639248),t+=4,m==1&&(t+=2),s(e,t,20),s(e,t+=2,0),s(e,t+=2,o.cpr?8:0),n(e,t+=2,0),n(e,t+=4,o.crc),n(e,t+=4,r.length),n(e,t+=4,o.usize),s(e,t+=4,i.bin.sizeUTF8(l)),s(e,t+=2,0),t+=2,m==1&&(t+=2,t+=2,n(e,t+=6,x),t+=4),t+=i.bin.writeUTF8(e,t,l),m==0&&(e.set(r,t),t+=r.length),t},i.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var l=t,o=0;o<8;o++)1&l?l=3988292384^l>>>1:l>>>=1;e[t]=l}return e}(),update:function(e,t,l,o){for(var m=0;m<o;m++)e=i.crc.table[255&(e^t[l+m])]^e>>>8;return e},crc:function(e,t,l){return 4294967295^i.crc.update(4294967295,e,t,l)}},i.adler=function(e,t,l){for(var o=1,m=0,x=t,n=t+l;x<n;){for(var s=Math.min(x+5552,n);x<s;)m+=o+=e[x++];o%=65521,m%=65521}return m<<16|o},i.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,l){e[t]=255&l,e[t+1]=l>>8&255,e[t+2]=l>>16&255,e[t+3]=l>>24&255},readASCII:function(e,t,l){for(var o="",m=0;m<l;m++)o+=String.fromCharCode(e[t+m]);return o},writeASCII:function(e,t,l){for(var o=0;o<l.length;o++)e[t+o]=l.charCodeAt(o)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,l){for(var o,m="",x=0;x<l;x++)m+="%"+i.bin.pad(e[t+x].toString(16));try{o=decodeURIComponent(m)}catch{return i.bin.readASCII(e,t,l)}return o},writeUTF8:function(e,t,l){for(var o=l.length,m=0,x=0;x<o;x++){var n=l.charCodeAt(x);if((4294967168&n)==0)e[t+m]=n,m++;else if((4294965248&n)==0)e[t+m]=192|n>>6,e[t+m+1]=128|n>>0&63,m+=2;else if((4294901760&n)==0)e[t+m]=224|n>>12,e[t+m+1]=128|n>>6&63,e[t+m+2]=128|n>>0&63,m+=3;else{if((4292870144&n)!=0)throw"e";e[t+m]=240|n>>18,e[t+m+1]=128|n>>12&63,e[t+m+2]=128|n>>6&63,e[t+m+3]=128|n>>0&63,m+=4}}return m},sizeUTF8:function(e){for(var t=e.length,l=0,o=0;o<t;o++){var m=e.charCodeAt(o);if((4294967168&m)==0)l++;else if((4294965248&m)==0)l+=2;else if((4294901760&m)==0)l+=3;else{if((4292870144&m)!=0)throw"e";l+=4}}return l}},i.F={},i.F.deflateRaw=function(e,t,l,o){var m=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],x=i.F.U,n=i.F._goodIndex;i.F._hash;var s=i.F._putsE,r=0,a=l<<3,b=0,D=e.length;if(o==0){for(;r<D;)s(t,a,r+(C=Math.min(65535,D-r))==D?1:0),a=i.F._copyExact(e,r,C,t,a+8),r+=C;return a>>>3}var F=x.lits,y=x.strt,k=x.prev,U=0,_=0,T=0,h=0,E=0,c=0;for(D>2&&(y[c=i.F._hash(e,0)]=0),r=0;r<D;r++){if(E=c,r+1<D-2){c=i.F._hash(e,r+1);var f=r+1&32767;k[f]=y[c],y[c]=f}if(b<=r){(U>14e3||_>26697)&&D-r>100&&(b<r&&(F[U]=r-b,U+=2,b=r),a=i.F._writeBlock(r==D-1||b==D?1:0,F,U,h,e,T,r-T,t,a),U=_=h=0,T=r);var I=0;r<D-2&&(I=i.F._bestMatch(e,r,k,E,Math.min(m[2],D-r),m[3]));var C=I>>>16,A=65535&I;if(I!=0){A=65535&I;var S=n(C=I>>>16,x.of0);x.lhst[257+S]++;var w=n(A,x.df0);x.dhst[w]++,h+=x.exb[S]+x.dxb[w],F[U]=C<<23|r-b,F[U+1]=A<<16|S<<8|w,U+=2,b=r+C}else x.lhst[e[r]]++;_++}}for(T==r&&e.length!=0||(b<r&&(F[U]=r-b,U+=2,b=r),a=i.F._writeBlock(1,F,U,h,e,T,r-T,t,a),U=0,_=0,U=_=h=0,T=r);(7&a)!=0;)a++;return a>>>3},i.F._bestMatch=function(e,t,l,o,m,x){var n=32767&t,s=l[n],r=n-s+32768&32767;if(s==n||o!=i.F._hash(e,t-r))return 0;for(var a=0,b=0,D=Math.min(32767,t);r<=D&&--x!=0&&s!=n;){if(a==0||e[t+a]==e[t+a-r]){var F=i.F._howLong(e,t,r);if(F>a){if(b=r,(a=F)>=m)break;r+2<F&&(F=r+2);for(var y=0,k=0;k<F-2;k++){var U=t-r+k+32768&32767,_=U-l[U]+32768&32767;_>y&&(y=_,s=U)}}}r+=(n=s)-(s=l[n])+32768&32767}return a<<16|b},i.F._howLong=function(e,t,l){if(e[t]!=e[t-l]||e[t+1]!=e[t+1-l]||e[t+2]!=e[t+2-l])return 0;var o=t,m=Math.min(e.length,t+258);for(t+=3;t<m&&e[t]==e[t-l];)t++;return t-o},i.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},i.saved=0,i.F._writeBlock=function(e,t,l,o,m,x,n,s,r){var a,b,D,F,y,k,U,_,T,h=i.F.U,E=i.F._putsF,c=i.F._putsE;h.lhst[256]++,b=(a=i.F.getTrees())[0],D=a[1],F=a[2],y=a[3],k=a[4],U=a[5],_=a[6],T=a[7];var f=32+((r+3&7)==0?0:8-(r+3&7))+(n<<3),I=o+i.F.contSize(h.fltree,h.lhst)+i.F.contSize(h.fdtree,h.dhst),C=o+i.F.contSize(h.ltree,h.lhst)+i.F.contSize(h.dtree,h.dhst);C+=14+3*U+i.F.contSize(h.itree,h.ihst)+(2*h.ihst[16]+3*h.ihst[17]+7*h.ihst[18]);for(var A=0;A<286;A++)h.lhst[A]=0;for(A=0;A<30;A++)h.dhst[A]=0;for(A=0;A<19;A++)h.ihst[A]=0;var S=f<I&&f<C?0:I<C?1:2;if(E(s,r,e),E(s,r+1,S),r+=3,S==0){for(;(7&r)!=0;)r++;r=i.F._copyExact(m,x,n,s,r)}else{var w,R;if(S==1&&(w=h.fltree,R=h.fdtree),S==2){i.F.makeCodes(h.ltree,b),i.F.revCodes(h.ltree,b),i.F.makeCodes(h.dtree,D),i.F.revCodes(h.dtree,D),i.F.makeCodes(h.itree,F),i.F.revCodes(h.itree,F),w=h.ltree,R=h.dtree,c(s,r,y-257),c(s,r+=5,k-1),c(s,r+=5,U-4),r+=4;for(var u=0;u<U;u++)c(s,r+3*u,h.itree[1+(h.ordr[u]<<1)]);r+=3*U,r=i.F._codeTiny(_,h.itree,s,r),r=i.F._codeTiny(T,h.itree,s,r)}for(var d=x,z=0;z<l;z+=2){for(var j=t[z],L=j>>>23,H=d+(8388607&j);d<H;)r=i.F._writeLit(m[d++],w,s,r);if(L!=0){var O=t[z+1],W=O>>16,B=O>>8&255,M=255&O;c(s,r=i.F._writeLit(257+B,w,s,r),L-h.of0[B]),r+=h.exb[B],E(s,r=i.F._writeLit(M,R,s,r),W-h.df0[M]),r+=h.dxb[M],d+=L}}r=i.F._writeLit(256,w,s,r)}return r},i.F._copyExact=function(e,t,l,o,m){var x=m>>>3;return o[x]=l,o[x+1]=l>>>8,o[x+2]=255-o[x],o[x+3]=255-o[x+1],x+=4,o.set(new Uint8Array(e.buffer,t,l),x),m+(l+4<<3)},i.F.getTrees=function(){for(var e=i.F.U,t=i.F._hufTree(e.lhst,e.ltree,15),l=i.F._hufTree(e.dhst,e.dtree,15),o=[],m=i.F._lenCodes(e.ltree,o),x=[],n=i.F._lenCodes(e.dtree,x),s=0;s<o.length;s+=2)e.ihst[o[s]]++;for(s=0;s<x.length;s+=2)e.ihst[x[s]]++;for(var r=i.F._hufTree(e.ihst,e.itree,7),a=19;a>4&&e.itree[1+(e.ordr[a-1]<<1)]==0;)a--;return[t,l,r,m,n,a,o,x]},i.F.getSecond=function(e){for(var t=[],l=0;l<e.length;l+=2)t.push(e[l+1]);return t},i.F.nonZero=function(e){for(var t="",l=0;l<e.length;l+=2)e[l+1]!=0&&(t+=(l>>1)+",");return t},i.F.contSize=function(e,t){for(var l=0,o=0;o<t.length;o++)l+=t[o]*e[1+(o<<1)];return l},i.F._codeTiny=function(e,t,l,o){for(var m=0;m<e.length;m+=2){var x=e[m],n=e[m+1];o=i.F._writeLit(x,t,l,o);var s=x==16?2:x==17?3:7;x>15&&(i.F._putsE(l,o,n,s),o+=s)}return o},i.F._lenCodes=function(e,t){for(var l=e.length;l!=2&&e[l-1]==0;)l-=2;for(var o=0;o<l;o+=2){var m=e[o+1],x=o+3<l?e[o+3]:-1,n=o+5<l?e[o+5]:-1,s=o==0?-1:e[o-1];if(m==0&&x==m&&n==m){for(var r=o+5;r+2<l&&e[r+2]==m;)r+=2;(a=Math.min(r+1-o>>>1,138))<11?t.push(17,a-3):t.push(18,a-11),o+=2*a-2}else if(m==s&&x==m&&n==m){for(r=o+5;r+2<l&&e[r+2]==m;)r+=2;var a=Math.min(r+1-o>>>1,6);t.push(16,a-3),o+=2*a-2}else t.push(m,0)}return l>>>1},i.F._hufTree=function(e,t,l){var o=[],m=e.length,x=t.length,n=0;for(n=0;n<x;n+=2)t[n]=0,t[n+1]=0;for(n=0;n<m;n++)e[n]!=0&&o.push({lit:n,f:e[n]});var s=o.length,r=o.slice(0);if(s==0)return 0;if(s==1){var a=o[0].lit;return r=a==0?1:0,t[1+(a<<1)]=1,t[1+(r<<1)]=1,1}o.sort(function(_,T){return _.f-T.f});var b=o[0],D=o[1],F=0,y=1,k=2;for(o[0]={lit:-1,f:b.f+D.f,l:b,r:D,d:0};y!=s-1;)b=F!=y&&(k==s||o[F].f<o[k].f)?o[F++]:o[k++],D=F!=y&&(k==s||o[F].f<o[k].f)?o[F++]:o[k++],o[y++]={lit:-1,f:b.f+D.f,l:b,r:D};var U=i.F.setDepth(o[y-1],0);for(U>l&&(i.F.restrictDepth(r,l,U),U=l),n=0;n<s;n++)t[1+(r[n].lit<<1)]=r[n].d;return U},i.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(i.F.setDepth(e.l,t+1),i.F.setDepth(e.r,t+1))},i.F.restrictDepth=function(e,t,l){var o=0,m=1<<l-t,x=0;for(e.sort(function(s,r){return r.d==s.d?s.f-r.f:r.d-s.d}),o=0;o<e.length&&e[o].d>t;o++){var n=e[o].d;e[o].d=t,x+=m-(1<<l-n)}for(x>>>=l-t;x>0;)(n=e[o].d)<t?(e[o].d++,x-=1<<t-n-1):o++;for(;o>=0;o--)e[o].d==t&&x<0&&(e[o].d--,x++);x!=0&&console.log("debt left")},i.F._goodIndex=function(e,t){var l=0;return t[16|l]<=e&&(l|=16),t[8|l]<=e&&(l|=8),t[4|l]<=e&&(l|=4),t[2|l]<=e&&(l|=2),t[1|l]<=e&&(l|=1),l},i.F._writeLit=function(e,t,l,o){return i.F._putsF(l,o,t[e<<1]),o+t[1+(e<<1)]},i.F.inflate=function(e,t){var l=Uint8Array;if(e[0]==3&&e[1]==0)return t||new l(0);var o=i.F,m=o._bitsF,x=o._bitsE,n=o._decodeTiny,s=o.makeCodes,r=o.codes2map,a=o._get17,b=o.U,D=t==null;D&&(t=new l(e.length>>>2<<3));for(var F,y,k=0,U=0,_=0,T=0,h=0,E=0,c=0,f=0,I=0;k==0;)if(k=m(e,I,1),U=m(e,I+1,2),I+=3,U!=0){if(D&&(t=i.F._check(t,f+(1<<17))),U==1&&(F=b.flmap,y=b.fdmap,E=511,c=31),U==2){_=x(e,I,5)+257,T=x(e,I+5,5)+1,h=x(e,I+10,4)+4,I+=14;for(var C=0;C<38;C+=2)b.itree[C]=0,b.itree[C+1]=0;var A=1;for(C=0;C<h;C++){var S=x(e,I+3*C,3);b.itree[1+(b.ordr[C]<<1)]=S,S>A&&(A=S)}I+=3*h,s(b.itree,A),r(b.itree,A,b.imap),F=b.lmap,y=b.dmap,I=n(b.imap,(1<<A)-1,_+T,e,I,b.ttree);var w=o._copyOut(b.ttree,0,_,b.ltree);E=(1<<w)-1;var R=o._copyOut(b.ttree,_,T,b.dtree);c=(1<<R)-1,s(b.ltree,w),r(b.ltree,w,F),s(b.dtree,R),r(b.dtree,R,y)}for(;;){var u=F[a(e,I)&E];I+=15&u;var d=u>>>4;if(!(d>>>8))t[f++]=d;else{if(d==256)break;var z=f+d-254;if(d>264){var j=b.ldef[d-257];z=f+(j>>>3)+x(e,I,7&j),I+=7&j}var L=y[a(e,I)&c];I+=15&L;var H=L>>>4,O=b.ddef[H],W=(O>>>4)+m(e,I,15&O);for(I+=15&O,D&&(t=i.F._check(t,f+(1<<17)));f<z;)t[f]=t[f++-W],t[f]=t[f++-W],t[f]=t[f++-W],t[f]=t[f++-W];f=z}}}else{(7&I)!=0&&(I+=8-(7&I));var B=4+(I>>>3),M=e[B-4]|e[B-3]<<8;D&&(t=i.F._check(t,f+M)),t.set(new l(e.buffer,e.byteOffset+B,M),f),I=B+M<<3,f+=M}return t.length==f?t:t.slice(0,f)},i.F._check=function(e,t){var l=e.length;if(t<=l)return e;var o=new Uint8Array(Math.max(l<<1,t));return o.set(e,0),o},i.F._decodeTiny=function(e,t,l,o,m,x){for(var n=i.F._bitsE,s=i.F._get17,r=0;r<l;){var a=e[s(o,m)&t];m+=15&a;var b=a>>>4;if(b<=15)x[r]=b,r++;else{var D=0,F=0;b==16?(F=3+n(o,m,2),m+=2,D=x[r-1]):b==17?(F=3+n(o,m,3),m+=3):b==18&&(F=11+n(o,m,7),m+=7);for(var y=r+F;r<y;)x[r]=D,r++}}return m},i.F._copyOut=function(e,t,l,o){for(var m=0,x=0,n=o.length>>>1;x<l;){var s=e[x+t];o[x<<1]=0,o[1+(x<<1)]=s,s>m&&(m=s),x++}for(;x<n;)o[x<<1]=0,o[1+(x<<1)]=0,x++;return m},i.F.makeCodes=function(e,t){for(var l,o,m,x,n=i.F.U,s=e.length,r=n.bl_count,a=0;a<=t;a++)r[a]=0;for(a=1;a<s;a+=2)r[e[a]]++;var b=n.next_code;for(l=0,r[0]=0,o=1;o<=t;o++)l=l+r[o-1]<<1,b[o]=l;for(m=0;m<s;m+=2)(x=e[m+1])!=0&&(e[m]=b[x],b[x]++)},i.F.codes2map=function(e,t,l){for(var o=e.length,m=i.F.U.rev15,x=0;x<o;x+=2)if(e[x+1]!=0)for(var n=x>>1,s=e[x+1],r=n<<4|s,a=t-s,b=e[x]<<a,D=b+(1<<a);b!=D;)l[m[b]>>>15-t]=r,b++},i.F.revCodes=function(e,t){for(var l=i.F.U.rev15,o=15-t,m=0;m<e.length;m+=2){var x=e[m]<<t-e[m+1];e[m]=l[x]>>>o}},i.F._putsE=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8},i.F._putsF=function(e,t,l){l<<=7&t;var o=t>>>3;e[o]|=l,e[o+1]|=l>>>8,e[o+2]|=l>>>16},i.F._bitsE=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<l)-1},i.F._bitsF=function(e,t,l){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<l)-1},i.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},i.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},i.F.U=(g=Uint16Array,p=Uint32Array,{next_code:new g(16),bl_count:new g(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new g(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new p(32),flmap:new g(512),fltree:[],fdmap:new g(32),fdtree:[],lmap:new g(32768),ltree:[],ttree:[],dmap:new g(32768),dtree:[],imap:new g(512),itree:[],rev15:new g(32768),lhst:new p(286),dhst:new p(30),ihst:new p(19),lits:new p(15e3),strt:new g(65536),prev:new g(32768)}),function(){for(var e=i.F.U,t=0;t<32768;t++){var l=t;l=(4278255360&(l=(4042322160&(l=(3435973836&(l=(2863311530&l)>>>1|(1431655765&l)<<1))>>>2|(858993459&l)<<2))>>>4|(252645135&l)<<4))>>>8|(16711935&l)<<8,e.rev15[t]=(l>>>16|l<<16)>>>17}function o(m,x,n){for(;x--!=0;)m.push(0,n)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];o(e.fltree,144,8),o(e.fltree,112,9),o(e.fltree,24,7),o(e.fltree,8,8),i.F.makeCodes(e.fltree,9),i.F.codes2map(e.fltree,9,e.flmap),i.F.revCodes(e.fltree,9),o(e.fdtree,32,5),i.F.makeCodes(e.fdtree,5),i.F.codes2map(e.fdtree,5,e.fdmap),i.F.revCodes(e.fdtree,5),o(e.itree,19,0),o(e.ltree,286,0),o(e.dtree,30,0),o(e.ttree,320,0)}()})();var Tr=Rr({__proto__:null,default:Je},[Je]);const we=function(){var v={nextZero(n,s){for(;n[s]!=0;)s++;return s},readUshort:(n,s)=>n[s]<<8|n[s+1],writeUshort(n,s,r){n[s]=r>>8&255,n[s+1]=255&r},readUint:(n,s)=>16777216*n[s]+(n[s+1]<<16|n[s+2]<<8|n[s+3]),writeUint(n,s,r){n[s]=r>>24&255,n[s+1]=r>>16&255,n[s+2]=r>>8&255,n[s+3]=255&r},readASCII(n,s,r){let a="";for(let b=0;b<r;b++)a+=String.fromCharCode(n[s+b]);return a},writeASCII(n,s,r){for(let a=0;a<r.length;a++)n[s+a]=r.charCodeAt(a)},readBytes(n,s,r){const a=[];for(let b=0;b<r;b++)a.push(n[s+b]);return a},pad:n=>n.length<2?`0${n}`:n,readUTF8(n,s,r){let a,b="";for(let D=0;D<r;D++)b+=`%${v.pad(n[s+D].toString(16))}`;try{a=decodeURIComponent(b)}catch{return v.readASCII(n,s,r)}return a}};function g(n,s,r,a){const b=s*r,D=t(a),F=Math.ceil(s*D/8),y=new Uint8Array(4*b),k=new Uint32Array(y.buffer),{ctype:U}=a,{depth:_}=a,T=v.readUshort;if(U==6){const j=b<<2;if(_==8)for(var h=0;h<j;h+=4)y[h]=n[h],y[h+1]=n[h+1],y[h+2]=n[h+2],y[h+3]=n[h+3];if(_==16)for(h=0;h<j;h++)y[h]=n[h<<1]}else if(U==2){const j=a.tabs.tRNS;if(j==null){if(_==8)for(h=0;h<b;h++){var E=3*h;k[h]=255<<24|n[E+2]<<16|n[E+1]<<8|n[E]}if(_==16)for(h=0;h<b;h++)E=6*h,k[h]=255<<24|n[E+4]<<16|n[E+2]<<8|n[E]}else{var c=j[0];const L=j[1],H=j[2];if(_==8)for(h=0;h<b;h++){var f=h<<2;E=3*h,k[h]=255<<24|n[E+2]<<16|n[E+1]<<8|n[E],n[E]==c&&n[E+1]==L&&n[E+2]==H&&(y[f+3]=0)}if(_==16)for(h=0;h<b;h++)f=h<<2,E=6*h,k[h]=255<<24|n[E+4]<<16|n[E+2]<<8|n[E],T(n,E)==c&&T(n,E+2)==L&&T(n,E+4)==H&&(y[f+3]=0)}}else if(U==3){const j=a.tabs.PLTE,L=a.tabs.tRNS,H=L?L.length:0;if(_==1)for(var I=0;I<r;I++){var C=I*F,A=I*s;for(h=0;h<s;h++){f=A+h<<2;var S=3*(w=n[C+(h>>3)]>>7-((7&h)<<0)&1);y[f]=j[S],y[f+1]=j[S+1],y[f+2]=j[S+2],y[f+3]=w<H?L[w]:255}}if(_==2)for(I=0;I<r;I++)for(C=I*F,A=I*s,h=0;h<s;h++)f=A+h<<2,S=3*(w=n[C+(h>>2)]>>6-((3&h)<<1)&3),y[f]=j[S],y[f+1]=j[S+1],y[f+2]=j[S+2],y[f+3]=w<H?L[w]:255;if(_==4)for(I=0;I<r;I++)for(C=I*F,A=I*s,h=0;h<s;h++)f=A+h<<2,S=3*(w=n[C+(h>>1)]>>4-((1&h)<<2)&15),y[f]=j[S],y[f+1]=j[S+1],y[f+2]=j[S+2],y[f+3]=w<H?L[w]:255;if(_==8)for(h=0;h<b;h++){var w;f=h<<2,S=3*(w=n[h]),y[f]=j[S],y[f+1]=j[S+1],y[f+2]=j[S+2],y[f+3]=w<H?L[w]:255}}else if(U==4){if(_==8)for(h=0;h<b;h++){f=h<<2;var R=n[u=h<<1];y[f]=R,y[f+1]=R,y[f+2]=R,y[f+3]=n[u+1]}if(_==16)for(h=0;h<b;h++){var u;f=h<<2,R=n[u=h<<2],y[f]=R,y[f+1]=R,y[f+2]=R,y[f+3]=n[u+2]}}else if(U==0)for(c=a.tabs.tRNS?a.tabs.tRNS:-1,I=0;I<r;I++){const j=I*F,L=I*s;if(_==1)for(var d=0;d<s;d++){var z=(R=255*(n[j+(d>>>3)]>>>7-(7&d)&1))==255*c?0:255;k[L+d]=z<<24|R<<16|R<<8|R}else if(_==2)for(d=0;d<s;d++)z=(R=85*(n[j+(d>>>2)]>>>6-((3&d)<<1)&3))==85*c?0:255,k[L+d]=z<<24|R<<16|R<<8|R;else if(_==4)for(d=0;d<s;d++)z=(R=17*(n[j+(d>>>1)]>>>4-((1&d)<<2)&15))==17*c?0:255,k[L+d]=z<<24|R<<16|R<<8|R;else if(_==8)for(d=0;d<s;d++)z=(R=n[j+d])==c?0:255,k[L+d]=z<<24|R<<16|R<<8|R;else if(_==16)for(d=0;d<s;d++)R=n[j+(d<<1)],z=T(n,j+(d<<1))==c?0:255,k[L+d]=z<<24|R<<16|R<<8|R}return y}function p(n,s,r,a){const b=t(n),D=Math.ceil(r*b/8),F=new Uint8Array((D+1+n.interlace)*a);return s=n.tabs.CgBI?e(s,F):i(s,F),n.interlace==0?s=l(s,n,0,r,a):n.interlace==1&&(s=function(k,U){const _=U.width,T=U.height,h=t(U),E=h>>3,c=Math.ceil(_*h/8),f=new Uint8Array(T*c);let I=0;const C=[0,0,4,0,2,0,1],A=[0,4,0,2,0,1,0],S=[8,8,8,4,4,2,2],w=[8,8,4,4,2,2,1];let R=0;for(;R<7;){const d=S[R],z=w[R];let j=0,L=0,H=C[R];for(;H<T;)H+=d,L++;let O=A[R];for(;O<_;)O+=z,j++;const W=Math.ceil(j*h/8);l(k,U,I,j,L);let B=0,M=C[R];for(;M<T;){let $=A[R],Y=I+B*W<<3;for(;$<_;){var u;if(h==1&&(u=(u=k[Y>>3])>>7-(7&Y)&1,f[M*c+($>>3)]|=u<<7-((7&$)<<0)),h==2&&(u=(u=k[Y>>3])>>6-(7&Y)&3,f[M*c+($>>2)]|=u<<6-((3&$)<<1)),h==4&&(u=(u=k[Y>>3])>>4-(7&Y)&15,f[M*c+($>>1)]|=u<<4-((1&$)<<2)),h>=8){const V=M*c+$*E;for(let Q=0;Q<E;Q++)f[V+Q]=k[(Y>>3)+Q]}Y+=h,$+=z}B++,M+=d}j*L!=0&&(I+=L*(1+W)),R+=1}return f}(s,n)),s}function i(n,s){return e(new Uint8Array(n.buffer,2,n.length-6),s)}var e=function(){const n={H:{}};return n.H.N=function(s,r){const a=Uint8Array;let b,D,F=0,y=0,k=0,U=0,_=0,T=0,h=0,E=0,c=0;if(s[0]==3&&s[1]==0)return r||new a(0);const f=n.H,I=f.b,C=f.e,A=f.R,S=f.n,w=f.A,R=f.Z,u=f.m,d=r==null;for(d&&(r=new a(s.length>>>2<<5));F==0;)if(F=I(s,c,1),y=I(s,c+1,2),c+=3,y!=0){if(d&&(r=n.H.W(r,E+(1<<17))),y==1&&(b=u.J,D=u.h,T=511,h=31),y==2){k=C(s,c,5)+257,U=C(s,c+5,5)+1,_=C(s,c+10,4)+4,c+=14;let j=1;for(var z=0;z<38;z+=2)u.Q[z]=0,u.Q[z+1]=0;for(z=0;z<_;z++){const O=C(s,c+3*z,3);u.Q[1+(u.X[z]<<1)]=O,O>j&&(j=O)}c+=3*_,S(u.Q,j),w(u.Q,j,u.u),b=u.w,D=u.d,c=A(u.u,(1<<j)-1,k+U,s,c,u.v);const L=f.V(u.v,0,k,u.C);T=(1<<L)-1;const H=f.V(u.v,k,U,u.D);h=(1<<H)-1,S(u.C,L),w(u.C,L,b),S(u.D,H),w(u.D,H,D)}for(;;){const j=b[R(s,c)&T];c+=15&j;const L=j>>>4;if(!(L>>>8))r[E++]=L;else{if(L==256)break;{let H=E+L-254;if(L>264){const $=u.q[L-257];H=E+($>>>3)+C(s,c,7&$),c+=7&$}const O=D[R(s,c)&h];c+=15&O;const W=O>>>4,B=u.c[W],M=(B>>>4)+I(s,c,15&B);for(c+=15&B;E<H;)r[E]=r[E++-M],r[E]=r[E++-M],r[E]=r[E++-M],r[E]=r[E++-M];E=H}}}}else{(7&c)!=0&&(c+=8-(7&c));const j=4+(c>>>3),L=s[j-4]|s[j-3]<<8;d&&(r=n.H.W(r,E+L)),r.set(new a(s.buffer,s.byteOffset+j,L),E),c=j+L<<3,E+=L}return r.length==E?r:r.slice(0,E)},n.H.W=function(s,r){const a=s.length;if(r<=a)return s;const b=new Uint8Array(a<<1);return b.set(s,0),b},n.H.R=function(s,r,a,b,D,F){const y=n.H.e,k=n.H.Z;let U=0;for(;U<a;){const _=s[k(b,D)&r];D+=15&_;const T=_>>>4;if(T<=15)F[U]=T,U++;else{let h=0,E=0;T==16?(E=3+y(b,D,2),D+=2,h=F[U-1]):T==17?(E=3+y(b,D,3),D+=3):T==18&&(E=11+y(b,D,7),D+=7);const c=U+E;for(;U<c;)F[U]=h,U++}}return D},n.H.V=function(s,r,a,b){let D=0,F=0;const y=b.length>>>1;for(;F<a;){const k=s[F+r];b[F<<1]=0,b[1+(F<<1)]=k,k>D&&(D=k),F++}for(;F<y;)b[F<<1]=0,b[1+(F<<1)]=0,F++;return D},n.H.n=function(s,r){const a=n.H.m,b=s.length;let D,F,y,k;const U=a.j;for(var _=0;_<=r;_++)U[_]=0;for(_=1;_<b;_+=2)U[s[_]]++;const T=a.K;for(D=0,U[0]=0,F=1;F<=r;F++)D=D+U[F-1]<<1,T[F]=D;for(y=0;y<b;y+=2)k=s[y+1],k!=0&&(s[y]=T[k],T[k]++)},n.H.A=function(s,r,a){const b=s.length,D=n.H.m.r;for(let F=0;F<b;F+=2)if(s[F+1]!=0){const y=F>>1,k=s[F+1],U=y<<4|k,_=r-k;let T=s[F]<<_;const h=T+(1<<_);for(;T!=h;)a[D[T]>>>15-r]=U,T++}},n.H.l=function(s,r){const a=n.H.m.r,b=15-r;for(let D=0;D<s.length;D+=2){const F=s[D]<<r-s[D+1];s[D]=a[F]>>>b}},n.H.M=function(s,r,a){a<<=7&r;const b=r>>>3;s[b]|=a,s[b+1]|=a>>>8},n.H.I=function(s,r,a){a<<=7&r;const b=r>>>3;s[b]|=a,s[b+1]|=a>>>8,s[b+2]|=a>>>16},n.H.e=function(s,r,a){return(s[r>>>3]|s[1+(r>>>3)]<<8)>>>(7&r)&(1<<a)-1},n.H.b=function(s,r,a){return(s[r>>>3]|s[1+(r>>>3)]<<8|s[2+(r>>>3)]<<16)>>>(7&r)&(1<<a)-1},n.H.Z=function(s,r){return(s[r>>>3]|s[1+(r>>>3)]<<8|s[2+(r>>>3)]<<16)>>>(7&r)},n.H.i=function(s,r){return(s[r>>>3]|s[1+(r>>>3)]<<8|s[2+(r>>>3)]<<16|s[3+(r>>>3)]<<24)>>>(7&r)},n.H.m=function(){const s=Uint16Array,r=Uint32Array;return{K:new s(16),j:new s(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new s(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new s(512),_:[],h:new s(32),$:[],w:new s(32768),C:[],v:[],d:new s(32768),D:[],u:new s(512),Q:[],r:new s(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new s(65536),g:new s(32768)}}(),function(){const s=n.H.m;for(var r=0;r<32768;r++){let b=r;b=(2863311530&b)>>>1|(1431655765&b)<<1,b=(3435973836&b)>>>2|(858993459&b)<<2,b=(4042322160&b)>>>4|(252645135&b)<<4,b=(4278255360&b)>>>8|(16711935&b)<<8,s.r[r]=(b>>>16|b<<16)>>>17}function a(b,D,F){for(;D--!=0;)b.push(0,F)}for(r=0;r<32;r++)s.q[r]=s.S[r]<<3|s.T[r],s.c[r]=s.p[r]<<4|s.z[r];a(s._,144,8),a(s._,112,9),a(s._,24,7),a(s._,8,8),n.H.n(s._,9),n.H.A(s._,9,s.J),n.H.l(s._,9),a(s.$,32,5),n.H.n(s.$,5),n.H.A(s.$,5,s.h),n.H.l(s.$,5),a(s.Q,19,0),a(s.C,286,0),a(s.D,30,0),a(s.v,320,0)}(),n.H.N}();function t(n){return[1,null,3,1,2,null,4][n.ctype]*n.depth}function l(n,s,r,a,b){let D=t(s);const F=Math.ceil(a*D/8);let y,k;D=Math.ceil(D/8);let U=n[r],_=0;if(U>1&&(n[r]=[0,0,1][U-2]),U==3)for(_=D;_<F;_++)n[_+1]=n[_+1]+(n[_+1-D]>>>1)&255;for(let T=0;T<b;T++)if(y=r+T*F,k=y+T+1,U=n[k-1],_=0,U==0)for(;_<F;_++)n[y+_]=n[k+_];else if(U==1){for(;_<D;_++)n[y+_]=n[k+_];for(;_<F;_++)n[y+_]=n[k+_]+n[y+_-D]}else if(U==2)for(;_<F;_++)n[y+_]=n[k+_]+n[y+_-F];else if(U==3){for(;_<D;_++)n[y+_]=n[k+_]+(n[y+_-F]>>>1);for(;_<F;_++)n[y+_]=n[k+_]+(n[y+_-F]+n[y+_-D]>>>1)}else{for(;_<D;_++)n[y+_]=n[k+_]+o(0,n[y+_-F],0);for(;_<F;_++)n[y+_]=n[k+_]+o(n[y+_-D],n[y+_-F],n[y+_-D-F])}return n}function o(n,s,r){const a=n+s-r,b=a-n,D=a-s,F=a-r;return b*b<=D*D&&b*b<=F*F?n:D*D<=F*F?s:r}function m(n,s,r){r.width=v.readUint(n,s),s+=4,r.height=v.readUint(n,s),s+=4,r.depth=n[s],s++,r.ctype=n[s],s++,r.compress=n[s],s++,r.filter=n[s],s++,r.interlace=n[s],s++}function x(n,s,r,a,b,D,F,y,k){const U=Math.min(s,b),_=Math.min(r,D);let T=0,h=0;for(let R=0;R<_;R++)for(let u=0;u<U;u++)if(F>=0&&y>=0?(T=R*s+u<<2,h=(y+R)*b+F+u<<2):(T=(-y+R)*s-F+u<<2,h=R*b+u<<2),k==0)a[h]=n[T],a[h+1]=n[T+1],a[h+2]=n[T+2],a[h+3]=n[T+3];else if(k==1){var E=n[T+3]*.00392156862745098,c=n[T]*E,f=n[T+1]*E,I=n[T+2]*E,C=a[h+3]*(1/255),A=a[h]*C,S=a[h+1]*C,w=a[h+2]*C;const d=1-E,z=E+C*d,j=z==0?0:1/z;a[h+3]=255*z,a[h+0]=(c+A*d)*j,a[h+1]=(f+S*d)*j,a[h+2]=(I+w*d)*j}else if(k==2)E=n[T+3],c=n[T],f=n[T+1],I=n[T+2],C=a[h+3],A=a[h],S=a[h+1],w=a[h+2],E==C&&c==A&&f==S&&I==w?(a[h]=0,a[h+1]=0,a[h+2]=0,a[h+3]=0):(a[h]=c,a[h+1]=f,a[h+2]=I,a[h+3]=E);else if(k==3){if(E=n[T+3],c=n[T],f=n[T+1],I=n[T+2],C=a[h+3],A=a[h],S=a[h+1],w=a[h+2],E==C&&c==A&&f==S&&I==w)continue;if(E<220&&C>20)return!1}return!0}return{decode:function(s){const r=new Uint8Array(s);let a=8;const b=v,D=b.readUshort,F=b.readUint,y={tabs:{},frames:[]},k=new Uint8Array(r.length);let U,_=0,T=0;const h=[137,80,78,71,13,10,26,10];for(var E=0;E<8;E++)if(r[E]!=h[E])throw"The input is not a PNG file!";for(;a<r.length;){const R=b.readUint(r,a);a+=4;const u=b.readASCII(r,a,4);if(a+=4,u=="IHDR")m(r,a,y);else if(u=="iCCP"){for(var c=a;r[c]!=0;)c++;b.readASCII(r,a,c-a),r[c+1];const d=r.slice(c+2,a+R);let z=null;try{z=i(d)}catch{z=e(d)}y.tabs[u]=z}else if(u=="CgBI")y.tabs[u]=r.slice(a,a+4);else if(u=="IDAT"){for(E=0;E<R;E++)k[_+E]=r[a+E];_+=R}else if(u=="acTL")y.tabs[u]={num_frames:F(r,a),num_plays:F(r,a+4)},U=new Uint8Array(r.length);else if(u=="fcTL"){T!=0&&((w=y.frames[y.frames.length-1]).data=p(y,U.slice(0,T),w.rect.width,w.rect.height),T=0);const d={x:F(r,a+12),y:F(r,a+16),width:F(r,a+4),height:F(r,a+8)};let z=D(r,a+22);z=D(r,a+20)/(z==0?100:z);const j={rect:d,delay:Math.round(1e3*z),dispose:r[a+24],blend:r[a+25]};y.frames.push(j)}else if(u=="fdAT"){for(E=0;E<R-4;E++)U[T+E]=r[a+E+4];T+=R-4}else if(u=="pHYs")y.tabs[u]=[b.readUint(r,a),b.readUint(r,a+4),r[a+8]];else if(u=="cHRM")for(y.tabs[u]=[],E=0;E<8;E++)y.tabs[u].push(b.readUint(r,a+4*E));else if(u=="tEXt"||u=="zTXt"){y.tabs[u]==null&&(y.tabs[u]={});var f=b.nextZero(r,a),I=b.readASCII(r,a,f-a),C=a+R-f-1;if(u=="tEXt")S=b.readASCII(r,f+1,C);else{var A=i(r.slice(f+2,f+2+C));S=b.readUTF8(A,0,A.length)}y.tabs[u][I]=S}else if(u=="iTXt"){y.tabs[u]==null&&(y.tabs[u]={}),f=0,c=a,f=b.nextZero(r,c),I=b.readASCII(r,c,f-c);const d=r[c=f+1];var S;r[c+1],c+=2,f=b.nextZero(r,c),b.readASCII(r,c,f-c),c=f+1,f=b.nextZero(r,c),b.readUTF8(r,c,f-c),C=R-((c=f+1)-a),d==0?S=b.readUTF8(r,c,C):(A=i(r.slice(c,c+C)),S=b.readUTF8(A,0,A.length)),y.tabs[u][I]=S}else if(u=="PLTE")y.tabs[u]=b.readBytes(r,a,R);else if(u=="hIST"){const d=y.tabs.PLTE.length/3;for(y.tabs[u]=[],E=0;E<d;E++)y.tabs[u].push(D(r,a+2*E))}else if(u=="tRNS")y.ctype==3?y.tabs[u]=b.readBytes(r,a,R):y.ctype==0?y.tabs[u]=D(r,a):y.ctype==2&&(y.tabs[u]=[D(r,a),D(r,a+2),D(r,a+4)]);else if(u=="gAMA")y.tabs[u]=b.readUint(r,a)/1e5;else if(u=="sRGB")y.tabs[u]=r[a];else if(u=="bKGD")y.ctype==0||y.ctype==4?y.tabs[u]=[D(r,a)]:y.ctype==2||y.ctype==6?y.tabs[u]=[D(r,a),D(r,a+2),D(r,a+4)]:y.ctype==3&&(y.tabs[u]=r[a]);else if(u=="IEND")break;a+=R,b.readUint(r,a),a+=4}var w;return T!=0&&((w=y.frames[y.frames.length-1]).data=p(y,U.slice(0,T),w.rect.width,w.rect.height)),y.data=p(y,k,y.width,y.height),delete y.compress,delete y.interlace,delete y.filter,y},toRGBA8:function(s){const r=s.width,a=s.height;if(s.tabs.acTL==null)return[g(s.data,r,a,s).buffer];const b=[];s.frames[0].data==null&&(s.frames[0].data=s.data);const D=r*a*4,F=new Uint8Array(D),y=new Uint8Array(D),k=new Uint8Array(D);for(let _=0;_<s.frames.length;_++){const T=s.frames[_],h=T.rect.x,E=T.rect.y,c=T.rect.width,f=T.rect.height,I=g(T.data,c,f,s);if(_!=0)for(var U=0;U<D;U++)k[U]=F[U];if(T.blend==0?x(I,c,f,F,r,a,h,E,0):T.blend==1&&x(I,c,f,F,r,a,h,E,1),b.push(F.buffer.slice(0)),T.dispose!=0){if(T.dispose==1)x(y,c,f,F,r,a,h,E,0);else if(T.dispose==2)for(U=0;U<D;U++)F[U]=k[U]}}return b},_paeth:o,_copyTile:x,_bin:v}}();(function(){const{_copyTile:v}=we,{_bin:g}=we,p=we._paeth;var i={table:function(){const c=new Uint32Array(256);for(let f=0;f<256;f++){let I=f;for(let C=0;C<8;C++)1&I?I=3988292384^I>>>1:I>>>=1;c[f]=I}return c}(),update(c,f,I,C){for(let A=0;A<C;A++)c=i.table[255&(c^f[I+A])]^c>>>8;return c},crc:(c,f,I)=>4294967295^i.update(4294967295,c,f,I)};function e(c,f,I,C){f[I]+=c[0]*C>>4,f[I+1]+=c[1]*C>>4,f[I+2]+=c[2]*C>>4,f[I+3]+=c[3]*C>>4}function t(c){return Math.max(0,Math.min(255,c))}function l(c,f){const I=c[0]-f[0],C=c[1]-f[1],A=c[2]-f[2],S=c[3]-f[3];return I*I+C*C+A*A+S*S}function o(c,f,I,C,A,S,w){w==null&&(w=1);const R=C.length,u=[];for(var d=0;d<R;d++){const M=C[d];u.push([M>>>0&255,M>>>8&255,M>>>16&255,M>>>24&255])}for(d=0;d<R;d++){let M=4294967295;for(var z=0,j=0;j<R;j++){var L=l(u[d],u[j]);j!=d&&L<M&&(M=L,z=j)}}const H=new Uint32Array(A.buffer),O=new Int16Array(f*I*4),W=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(d=0;d<W.length;d++)W[d]=255*((W[d]+.5)/16-.5);for(let M=0;M<I;M++)for(let $=0;$<f;$++){var B;d=4*(M*f+$),w!=2?B=[t(c[d]+O[d]),t(c[d+1]+O[d+1]),t(c[d+2]+O[d+2]),t(c[d+3]+O[d+3])]:(L=W[4*(3&M)+(3&$)],B=[t(c[d]+L),t(c[d+1]+L),t(c[d+2]+L),t(c[d+3]+L)]),z=0;let Y=16777215;for(j=0;j<R;j++){const K=l(B,u[j]);K<Y&&(Y=K,z=j)}const V=u[z],Q=[B[0]-V[0],B[1]-V[1],B[2]-V[2],B[3]-V[3]];w==1&&($!=f-1&&e(Q,O,d+4,7),M!=I-1&&($!=0&&e(Q,O,d+4*f-4,3),e(Q,O,d+4*f,5),$!=f-1&&e(Q,O,d+4*f+4,1))),S[d>>2]=z,H[d>>2]=C[z]}}function m(c,f,I,C,A){A==null&&(A={});const{crc:S}=i,w=g.writeUint,R=g.writeUshort,u=g.writeASCII;let d=8;const z=c.frames.length>1;let j,L=!1,H=33+(z?20:0);if(A.sRGB!=null&&(H+=13),A.pHYs!=null&&(H+=21),A.iCCP!=null&&(j=pako.deflate(A.iCCP),H+=21+j.length+4),c.ctype==3){for(var O=c.plte.length,W=0;W<O;W++)c.plte[W]>>>24!=255&&(L=!0);H+=8+3*O+4+(L?8+1*O+4:0)}for(var B=0;B<c.frames.length;B++)z&&(H+=38),H+=(V=c.frames[B]).cimg.length+12,B!=0&&(H+=4);H+=12;const M=new Uint8Array(H),$=[137,80,78,71,13,10,26,10];for(W=0;W<8;W++)M[W]=$[W];if(w(M,d,13),d+=4,u(M,d,"IHDR"),d+=4,w(M,d,f),d+=4,w(M,d,I),d+=4,M[d]=c.depth,d++,M[d]=c.ctype,d++,M[d]=0,d++,M[d]=0,d++,M[d]=0,d++,w(M,d,S(M,d-17,17)),d+=4,A.sRGB!=null&&(w(M,d,1),d+=4,u(M,d,"sRGB"),d+=4,M[d]=A.sRGB,d++,w(M,d,S(M,d-5,5)),d+=4),A.iCCP!=null){const Q=13+j.length;w(M,d,Q),d+=4,u(M,d,"iCCP"),d+=4,u(M,d,"ICC profile"),d+=11,d+=2,M.set(j,d),d+=j.length,w(M,d,S(M,d-(Q+4),Q+4)),d+=4}if(A.pHYs!=null&&(w(M,d,9),d+=4,u(M,d,"pHYs"),d+=4,w(M,d,A.pHYs[0]),d+=4,w(M,d,A.pHYs[1]),d+=4,M[d]=A.pHYs[2],d++,w(M,d,S(M,d-13,13)),d+=4),z&&(w(M,d,8),d+=4,u(M,d,"acTL"),d+=4,w(M,d,c.frames.length),d+=4,w(M,d,A.loop!=null?A.loop:0),d+=4,w(M,d,S(M,d-12,12)),d+=4),c.ctype==3){for(w(M,d,3*(O=c.plte.length)),d+=4,u(M,d,"PLTE"),d+=4,W=0;W<O;W++){const Q=3*W,K=c.plte[W],te=255&K,se=K>>>8&255,ke=K>>>16&255;M[d+Q+0]=te,M[d+Q+1]=se,M[d+Q+2]=ke}if(d+=3*O,w(M,d,S(M,d-3*O-4,3*O+4)),d+=4,L){for(w(M,d,O),d+=4,u(M,d,"tRNS"),d+=4,W=0;W<O;W++)M[d+W]=c.plte[W]>>>24&255;d+=O,w(M,d,S(M,d-O-4,O+4)),d+=4}}let Y=0;for(B=0;B<c.frames.length;B++){var V=c.frames[B];z&&(w(M,d,26),d+=4,u(M,d,"fcTL"),d+=4,w(M,d,Y++),d+=4,w(M,d,V.rect.width),d+=4,w(M,d,V.rect.height),d+=4,w(M,d,V.rect.x),d+=4,w(M,d,V.rect.y),d+=4,R(M,d,C[B]),d+=2,R(M,d,1e3),d+=2,M[d]=V.dispose,d++,M[d]=V.blend,d++,w(M,d,S(M,d-30,30)),d+=4);const Q=V.cimg;w(M,d,(O=Q.length)+(B==0?0:4)),d+=4;const K=d;u(M,d,B==0?"IDAT":"fdAT"),d+=4,B!=0&&(w(M,d,Y++),d+=4),M.set(Q,d),d+=O,w(M,d,S(M,K,d-K)),d+=4}return w(M,d,0),d+=4,u(M,d,"IEND"),d+=4,w(M,d,S(M,d-4,4)),d+=4,M.buffer}function x(c,f,I){for(let C=0;C<c.frames.length;C++){const A=c.frames[C];A.rect.width;const S=A.rect.height,w=new Uint8Array(S*A.bpl+S);A.cimg=a(A.img,S,A.bpp,A.bpl,w,f,I)}}function n(c,f,I,C,A){const S=A[0],w=A[1],R=A[2],u=A[3],d=A[4],z=A[5];let j=6,L=8,H=255;for(var O=0;O<c.length;O++){const ce=new Uint8Array(c[O]);for(var W=ce.length,B=0;B<W;B+=4)H&=ce[B+3]}const M=H!=255,$=function(J,Z,de,he,ne,be){const ie=[];for(var X=0;X<J.length;X++){const ge=new Uint8Array(J[X]),xe=new Uint32Array(ge.buffer);var me;let ye=0,_e=0,Ae=Z,Te=de,it=he?1:0;if(X!=0){const Xt=be||he||X==1||ie[X-2].dispose!=0?1:2;let st=0,vt=1e9;for(let He=0;He<Xt;He++){var Se=new Uint8Array(J[X-1-He]);const Yt=new Uint32Array(J[X-1-He]);let Ue=Z,Ee=de,Le=-1,$e=-1;for(let Me=0;Me<de;Me++)for(let ze=0;ze<Z;ze++)xe[fe=Me*Z+ze]!=Yt[fe]&&(ze<Ue&&(Ue=ze),ze>Le&&(Le=ze),Me<Ee&&(Ee=Me),Me>$e&&($e=Me));Le==-1&&(Ue=Ee=Le=$e=0),ne&&((1&Ue)==1&&Ue--,(1&Ee)==1&&Ee--);const xt=(Le-Ue+1)*($e-Ee+1);xt<vt&&(vt=xt,st=He,ye=Ue,_e=Ee,Ae=Le-Ue+1,Te=$e-Ee+1)}Se=new Uint8Array(J[X-1-st]),st==1&&(ie[X-1].dispose=2),me=new Uint8Array(Ae*Te*4),v(Se,Z,de,me,Ae,Te,-ye,-_e,0),it=v(ge,Z,de,me,Ae,Te,-ye,-_e,3)?1:0,it==1?r(ge,Z,de,me,{x:ye,y:_e,width:Ae,height:Te}):v(ge,Z,de,me,Ae,Te,-ye,-_e,0)}else me=ge.slice(0);ie.push({rect:{x:ye,y:_e,width:Ae,height:Te},img:me,blend:it,dispose:0})}if(he)for(X=0;X<ie.length;X++){if((je=ie[X]).blend==1)continue;const ge=je.rect,xe=ie[X-1].rect,ye=Math.min(ge.x,xe.x),_e=Math.min(ge.y,xe.y),Ae={x:ye,y:_e,width:Math.max(ge.x+ge.width,xe.x+xe.width)-ye,height:Math.max(ge.y+ge.height,xe.y+xe.height)-_e};ie[X-1].dispose=1,X-1!=0&&s(J,Z,de,ie,X-1,Ae,ne),s(J,Z,de,ie,X,Ae,ne)}let qe=0;if(J.length!=1)for(var fe=0;fe<ie.length;fe++){var je;qe+=(je=ie[fe]).rect.width*je.rect.height}return ie}(c,f,I,S,w,R),Y={},V=[],Q=[];if(C!=0){const ce=[];for(B=0;B<$.length;B++)ce.push($[B].img.buffer);const J=function(ne){let be=0;for(var ie=0;ie<ne.length;ie++)be+=ne[ie].byteLength;const X=new Uint8Array(be);let me=0;for(ie=0;ie<ne.length;ie++){const Se=new Uint8Array(ne[ie]),qe=Se.length;for(let fe=0;fe<qe;fe+=4){let je=Se[fe],ge=Se[fe+1],xe=Se[fe+2];const ye=Se[fe+3];ye==0&&(je=ge=xe=0),X[me+fe]=je,X[me+fe+1]=ge,X[me+fe+2]=xe,X[me+fe+3]=ye}me+=qe}return X.buffer}(ce),Z=D(J,C);for(B=0;B<Z.plte.length;B++)V.push(Z.plte[B].est.rgba);let de=0;for(B=0;B<$.length;B++){const he=(te=$[B]).img.length;var K=new Uint8Array(Z.inds.buffer,de>>2,he>>2);Q.push(K);const ne=new Uint8Array(Z.abuf,de,he);z&&o(te.img,te.rect.width,te.rect.height,V,ne,K),te.img.set(ne),de+=he}}else for(O=0;O<$.length;O++){var te=$[O];const ce=new Uint32Array(te.img.buffer);var se=te.rect.width;for(W=ce.length,K=new Uint8Array(W),Q.push(K),B=0;B<W;B++){const J=ce[B];if(B!=0&&J==ce[B-1])K[B]=K[B-1];else if(B>se&&J==ce[B-se])K[B]=K[B-se];else{let Z=Y[J];if(Z==null&&(Y[J]=Z=V.length,V.push(J),V.length>=300))break;K[B]=Z}}}const ke=V.length;for(ke<=256&&d==0&&(L=ke<=2?1:ke<=4?2:ke<=16?4:8,L=Math.max(L,u)),O=0;O<$.length;O++){(te=$[O]).rect.x,te.rect.y,se=te.rect.width;const ce=te.rect.height;let J=te.img;new Uint32Array(J.buffer);let Z=4*se,de=4;if(ke<=256&&d==0){Z=Math.ceil(L*se/8);var Ie=new Uint8Array(Z*ce);const he=Q[O];for(let ne=0;ne<ce;ne++){B=ne*Z;const be=ne*se;if(L==8)for(var ee=0;ee<se;ee++)Ie[B+ee]=he[be+ee];else if(L==4)for(ee=0;ee<se;ee++)Ie[B+(ee>>1)]|=he[be+ee]<<4-4*(1&ee);else if(L==2)for(ee=0;ee<se;ee++)Ie[B+(ee>>2)]|=he[be+ee]<<6-2*(3&ee);else if(L==1)for(ee=0;ee<se;ee++)Ie[B+(ee>>3)]|=he[be+ee]<<7-1*(7&ee)}J=Ie,j=3,de=1}else if(M==0&&$.length==1){Ie=new Uint8Array(se*ce*3);const he=se*ce;for(B=0;B<he;B++){const ne=3*B,be=4*B;Ie[ne]=J[be],Ie[ne+1]=J[be+1],Ie[ne+2]=J[be+2]}J=Ie,j=2,de=3,Z=3*se}te.img=J,te.bpl=Z,te.bpp=de}return{ctype:j,depth:L,plte:V,frames:$}}function s(c,f,I,C,A,S,w){const R=Uint8Array,u=Uint32Array,d=new R(c[A-1]),z=new u(c[A-1]),j=A+1<c.length?new R(c[A+1]):null,L=new R(c[A]),H=new u(L.buffer);let O=f,W=I,B=-1,M=-1;for(let Y=0;Y<S.height;Y++)for(let V=0;V<S.width;V++){const Q=S.x+V,K=S.y+Y,te=K*f+Q,se=H[te];se==0||C[A-1].dispose==0&&z[te]==se&&(j==null||j[4*te+3]!=0)||(Q<O&&(O=Q),Q>B&&(B=Q),K<W&&(W=K),K>M&&(M=K))}B==-1&&(O=W=B=M=0),w&&((1&O)==1&&O--,(1&W)==1&&W--),S={x:O,y:W,width:B-O+1,height:M-W+1};const $=C[A];$.rect=S,$.blend=1,$.img=new Uint8Array(S.width*S.height*4),C[A-1].dispose==0?(v(d,f,I,$.img,S.width,S.height,-S.x,-S.y,0),r(L,f,I,$.img,S)):v(L,f,I,$.img,S.width,S.height,-S.x,-S.y,0)}function r(c,f,I,C,A){v(c,f,I,C,A.width,A.height,-A.x,-A.y,2)}function a(c,f,I,C,A,S,w){const R=[];let u,d=[0,1,2,3,4];S!=-1?d=[S]:(f*C>5e5||I==1)&&(d=[0]),w&&(u={level:0});const z=Tr;for(var j=0;j<d.length;j++){for(let O=0;O<f;O++)b(A,c,O,C,I,d[j]);R.push(z.deflate(A,u))}let L,H=1e9;for(j=0;j<R.length;j++)R[j].length<H&&(L=j,H=R[j].length);return R[L]}function b(c,f,I,C,A,S){const w=I*C;let R=w+I;if(c[R]=S,R++,S==0)if(C<500)for(var u=0;u<C;u++)c[R+u]=f[w+u];else c.set(new Uint8Array(f.buffer,w,C),R);else if(S==1){for(u=0;u<A;u++)c[R+u]=f[w+u];for(u=A;u<C;u++)c[R+u]=f[w+u]-f[w+u-A]+256&255}else if(I==0){for(u=0;u<A;u++)c[R+u]=f[w+u];if(S==2)for(u=A;u<C;u++)c[R+u]=f[w+u];if(S==3)for(u=A;u<C;u++)c[R+u]=f[w+u]-(f[w+u-A]>>1)+256&255;if(S==4)for(u=A;u<C;u++)c[R+u]=f[w+u]-p(f[w+u-A],0,0)+256&255}else{if(S==2)for(u=0;u<C;u++)c[R+u]=f[w+u]+256-f[w+u-C]&255;if(S==3){for(u=0;u<A;u++)c[R+u]=f[w+u]+256-(f[w+u-C]>>1)&255;for(u=A;u<C;u++)c[R+u]=f[w+u]+256-(f[w+u-C]+f[w+u-A]>>1)&255}if(S==4){for(u=0;u<A;u++)c[R+u]=f[w+u]+256-p(0,f[w+u-C],0)&255;for(u=A;u<C;u++)c[R+u]=f[w+u]+256-p(f[w+u-A],f[w+u-C],f[w+u-A-C])&255}}}function D(c,f){const I=new Uint8Array(c),C=I.slice(0),A=new Uint32Array(C.buffer),S=F(C,f),w=S[0],R=S[1],u=I.length,d=new Uint8Array(u>>2);let z;if(I.length<2e7)for(var j=0;j<u;j+=4)z=y(w,L=I[j]*(1/255),H=I[j+1]*(1/255),O=I[j+2]*(1/255),W=I[j+3]*(1/255)),d[j>>2]=z.ind,A[j>>2]=z.est.rgba;else for(j=0;j<u;j+=4){var L=I[j]*.00392156862745098,H=I[j+1]*(1/255),O=I[j+2]*(1/255),W=I[j+3]*(1/255);for(z=w;z.left;)z=k(z.est,L,H,O,W)<=0?z.left:z.right;d[j>>2]=z.ind,A[j>>2]=z.est.rgba}return{abuf:C.buffer,inds:d,plte:R}}function F(c,f,I){I==null&&(I=1e-4);const C=new Uint32Array(c.buffer),A={i0:0,i1:c.length,bst:null,est:null,tdst:0,left:null,right:null};A.bst=T(c,A.i0,A.i1),A.est=h(A.bst);const S=[A];for(;S.length<f;){let R=0,u=0;for(var w=0;w<S.length;w++)S[w].est.L>R&&(R=S[w].est.L,u=w);if(R<I)break;const d=S[u],z=U(c,C,d.i0,d.i1,d.est.e,d.est.eMq255);if(d.i0>=z||d.i1<=z){d.est.L=0;continue}const j={i0:d.i0,i1:z,bst:null,est:null,tdst:0,left:null,right:null};j.bst=T(c,j.i0,j.i1),j.est=h(j.bst);const L={i0:z,i1:d.i1,bst:null,est:null,tdst:0,left:null,right:null};for(L.bst={R:[],m:[],N:d.bst.N-j.bst.N},w=0;w<16;w++)L.bst.R[w]=d.bst.R[w]-j.bst.R[w];for(w=0;w<4;w++)L.bst.m[w]=d.bst.m[w]-j.bst.m[w];L.est=h(L.bst),d.left=j,d.right=L,S[u]=j,S.push(L)}for(S.sort((R,u)=>u.bst.N-R.bst.N),w=0;w<S.length;w++)S[w].ind=w;return[A,S]}function y(c,f,I,C,A){if(c.left==null)return c.tdst=function(j,L,H,O,W){const B=L-j[0],M=H-j[1],$=O-j[2],Y=W-j[3];return B*B+M*M+$*$+Y*Y}(c.est.q,f,I,C,A),c;const S=k(c.est,f,I,C,A);let w=c.left,R=c.right;S>0&&(w=c.right,R=c.left);const u=y(w,f,I,C,A);if(u.tdst<=S*S)return u;const d=y(R,f,I,C,A);return d.tdst<u.tdst?d:u}function k(c,f,I,C,A){const{e:S}=c;return S[0]*f+S[1]*I+S[2]*C+S[3]*A-c.eMq}function U(c,f,I,C,A,S){for(C-=4;I<C;){for(;_(c,I,A)<=S;)I+=4;for(;_(c,C,A)>S;)C-=4;if(I>=C)break;const w=f[I>>2];f[I>>2]=f[C>>2],f[C>>2]=w,I+=4,C-=4}for(;_(c,I,A)>S;)I-=4;return I+4}function _(c,f,I){return c[f]*I[0]+c[f+1]*I[1]+c[f+2]*I[2]+c[f+3]*I[3]}function T(c,f,I){const C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A=[0,0,0,0],S=I-f>>2;for(let w=f;w<I;w+=4){const R=c[w]*.00392156862745098,u=c[w+1]*(1/255),d=c[w+2]*(1/255),z=c[w+3]*(1/255);A[0]+=R,A[1]+=u,A[2]+=d,A[3]+=z,C[0]+=R*R,C[1]+=R*u,C[2]+=R*d,C[3]+=R*z,C[5]+=u*u,C[6]+=u*d,C[7]+=u*z,C[10]+=d*d,C[11]+=d*z,C[15]+=z*z}return C[4]=C[1],C[8]=C[2],C[9]=C[6],C[12]=C[3],C[13]=C[7],C[14]=C[11],{R:C,m:A,N:S}}function h(c){const{R:f}=c,{m:I}=c,{N:C}=c,A=I[0],S=I[1],w=I[2],R=I[3],u=C==0?0:1/C,d=[f[0]-A*A*u,f[1]-A*S*u,f[2]-A*w*u,f[3]-A*R*u,f[4]-S*A*u,f[5]-S*S*u,f[6]-S*w*u,f[7]-S*R*u,f[8]-w*A*u,f[9]-w*S*u,f[10]-w*w*u,f[11]-w*R*u,f[12]-R*A*u,f[13]-R*S*u,f[14]-R*w*u,f[15]-R*R*u],z=d,j=E;let L=[Math.random(),Math.random(),Math.random(),Math.random()],H=0,O=0;if(C!=0)for(let B=0;B<16&&(L=j.multVec(z,L),O=Math.sqrt(j.dot(L,L)),L=j.sml(1/O,L),!(B!=0&&Math.abs(O-H)<1e-9));B++)H=O;const W=[A*u,S*u,w*u,R*u];return{Cov:d,q:W,e:L,L:H,eMq255:j.dot(j.sml(255,W),L),eMq:j.dot(L,W),rgba:(Math.round(255*W[3])<<24|Math.round(255*W[2])<<16|Math.round(255*W[1])<<8|Math.round(255*W[0])<<0)>>>0}}var E={multVec:(c,f)=>[c[0]*f[0]+c[1]*f[1]+c[2]*f[2]+c[3]*f[3],c[4]*f[0]+c[5]*f[1]+c[6]*f[2]+c[7]*f[3],c[8]*f[0]+c[9]*f[1]+c[10]*f[2]+c[11]*f[3],c[12]*f[0]+c[13]*f[1]+c[14]*f[2]+c[15]*f[3]],dot:(c,f)=>c[0]*f[0]+c[1]*f[1]+c[2]*f[2]+c[3]*f[3],sml:(c,f)=>[c*f[0],c*f[1],c*f[2],c*f[3]]};we.encode=function(f,I,C,A,S,w,R){A==null&&(A=0),R==null&&(R=!1);const u=n(f,I,C,A,[!1,!1,!1,0,R,!1]);return x(u,-1),m(u,I,C,S,w)},we.encodeLL=function(f,I,C,A,S,w,R,u){const d={ctype:0+(A==1?0:2)+(S==0?0:4),depth:w,frames:[]},z=(A+S)*w,j=z*I;for(let L=0;L<f.length;L++)d.frames.push({rect:{x:0,y:0,width:I,height:C},img:new Uint8Array(f[L]),blend:0,dispose:1,bpp:Math.ceil(z/8),bpl:Math.ceil(j/8)});return x(d,0,!0),m(d,I,C,R,u)},we.encode.compress=n,we.encode.dither=o,we.quantize=D,we.quantize.getKDtree=F,we.quantize.getNearest=y})();const Nt={toArrayBuffer(v,g){const p=v.width,i=v.height,e=p<<2,t=v.getContext("2d").getImageData(0,0,p,i),l=new Uint32Array(t.data.buffer),o=(32*p+31)/32<<2,m=o*i,x=122+m,n=new ArrayBuffer(x),s=new DataView(n),r=1<<20;let a,b,D,F,y=r,k=0,U=0,_=0;function T(c){s.setUint16(U,c,!0),U+=2}function h(c){s.setUint32(U,c,!0),U+=4}function E(c){U+=c}T(19778),h(x),E(4),h(122),h(108),h(p),h(-i>>>0),T(1),T(32),h(3),h(m),h(2835),h(2835),E(8),h(16711680),h(65280),h(255),h(4278190080),h(1466527264),function c(){for(;k<i&&y>0;){for(F=122+k*o,a=0;a<e;)y--,b=l[_++],D=b>>>24,s.setUint32(F+a,b<<8|D),a+=4;k++}_<l.length?(y=r,setTimeout(c,Nt._dly)):g(n)}()},toBlob(v,g){this.toArrayBuffer(v,p=>{g(new Blob([p],{type:"image/bmp"}))})},_dly:9};var pe={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},Mr={[pe.CHROME]:16384,[pe.FIREFOX]:11180,[pe.DESKTOP_SAFARI]:16384,[pe.IE]:8192,[pe.IOS]:4096,[pe.ETC]:8192};const mt=typeof window<"u",Wt=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,et=mt&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),zr=(mt||Wt)&&(et&&et.getOriginalSymbol(window,"File")||typeof File<"u"&&File),Ht=(mt||Wt)&&(et&&et.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function yt(v,g,p=Date.now()){return new Promise(i=>{const e=v.split(","),t=e[0].match(/:(.*?);/)[1],l=globalThis.atob(e[1]);let o=l.length;const m=new Uint8Array(o);for(;o--;)m[o]=l.charCodeAt(o);const x=new Blob([m],{type:t});x.name=g,x.lastModified=p,i(x)})}function $t(v){return new Promise((g,p)=>{const i=new Ht;i.onload=()=>g(i.result),i.onerror=e=>p(e),i.readAsDataURL(v)})}function Gt(v){return new Promise((g,p)=>{const i=new Image;i.onload=()=>g(i),i.onerror=e=>p(e),i.src=v})}function Pe(){if(Pe.cachedResult!==void 0)return Pe.cachedResult;let v=pe.ETC;const{userAgent:g}=navigator;return/Chrom(e|ium)/i.test(g)?v=pe.CHROME:/iP(ad|od|hone)/i.test(g)&&/WebKit/i.test(g)?v=pe.IOS:/Safari/i.test(g)?v=pe.DESKTOP_SAFARI:/Firefox/i.test(g)?v=pe.FIREFOX:(/MSIE/i.test(g)||document.documentMode)&&(v=pe.IE),Pe.cachedResult=v,Pe.cachedResult}function Qt(v,g){const p=Pe(),i=Mr[p];let e=v,t=g,l=e*t;const o=e>t?t/e:e/t;for(;l>i*i;){const m=(i+e)/2,x=(i+t)/2;m<x?(t=x,e=x*o):(t=m*o,e=m),l=e*t}return{width:e,height:t}}function nt(v,g){let p,i;try{if(p=new OffscreenCanvas(v,g),i=p.getContext("2d"),i===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{p=document.createElement("canvas"),i=p.getContext("2d")}return p.width=v,p.height=g,[p,i]}function qt(v,g){const{width:p,height:i}=Qt(v.width,v.height),[e,t]=nt(p,i);return g&&/jpe?g/.test(g)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(v,0,0,e.width,e.height),e}function Ve(){return Ve.cachedResult!==void 0||(Ve.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Ve.cachedResult}function tt(v,g={}){return new Promise(function(p,i){let e,t;var l=function(){try{return t=qt(e,g.fileType||v.type),p([e,t])}catch(m){return i(m)}},o=function(m){try{var x=function(n){try{throw n}catch(s){return i(s)}};try{let n;return $t(v).then(function(s){try{return n=s,Gt(n).then(function(r){try{return e=r,function(){try{return l()}catch(a){return i(a)}}()}catch(a){return x(a)}},x)}catch(r){return x(r)}},x)}catch(n){x(n)}}catch(n){return i(n)}};try{if(Ve()||[pe.DESKTOP_SAFARI,pe.MOBILE_SAFARI].includes(Pe()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(v).then(function(m){try{return e=m,l()}catch{return o()}},o)}catch{o()}})}function rt(v,g,p,i,e=1){return new Promise(function(t,l){let o;if(g==="image/png"){let x,n,s;return x=v.getContext("2d"),{data:n}=x.getImageData(0,0,v.width,v.height),s=we.encode([n.buffer],v.width,v.height,4096*e),o=new Blob([s],{type:g}),o.name=p,o.lastModified=i,m.call(this)}{let x=function(){return m.call(this)};if(g==="image/bmp")return new Promise(n=>Nt.toBlob(v,n)).then((function(n){try{return o=n,o.name=p,o.lastModified=i,x.call(this)}catch(s){return l(s)}}).bind(this),l);{let n=function(){return x.call(this)};if(typeof OffscreenCanvas=="function"&&v instanceof OffscreenCanvas)return v.convertToBlob({type:g,quality:e}).then((function(s){try{return o=s,o.name=p,o.lastModified=i,n.call(this)}catch(r){return l(r)}}).bind(this),l);{let s;return s=v.toDataURL(g,e),yt(s,p,i).then((function(r){try{return o=r,n.call(this)}catch(a){return l(a)}}).bind(this),l)}}}function m(){return t(o)}})}function Ce(v){v.width=0,v.height=0}function Ne(){return new Promise(function(v,g){let p,i,e,t;return Ne.cachedResult!==void 0?v(Ne.cachedResult):yt("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(l){try{return p=l,tt(p).then(function(o){try{return i=o[1],rt(i,p.type,p.name,p.lastModified).then(function(m){try{return e=m,Ce(i),tt(e).then(function(x){try{return t=x[0],Ne.cachedResult=t.width===1&&t.height===2,v(Ne.cachedResult)}catch(n){return g(n)}},g)}catch(x){return g(x)}},g)}catch(m){return g(m)}},g)}catch(o){return g(o)}},g)})}function Vt(v){return new Promise((g,p)=>{const i=new Ht;i.onload=e=>{const t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return g(-2);const l=t.byteLength;let o=2;for(;o<l;){if(t.getUint16(o+2,!1)<=8)return g(-1);const m=t.getUint16(o,!1);if(o+=2,m==65505){if(t.getUint32(o+=2,!1)!=1165519206)return g(-1);const x=t.getUint16(o+=6,!1)==18761;o+=t.getUint32(o+4,x);const n=t.getUint16(o,x);o+=2;for(let s=0;s<n;s++)if(t.getUint16(o+12*s,x)==274)return g(t.getUint16(o+12*s+8,x))}else{if((65280&m)!=65280)break;o+=t.getUint16(o,!1)}}return g(-1)},i.onerror=e=>p(e),i.readAsArrayBuffer(v)})}function Kt(v,g){const{width:p}=v,{height:i}=v,{maxWidthOrHeight:e}=g;let t,l=v;return isFinite(e)&&(p>e||i>e)&&([l,t]=nt(p,i),p>i?(l.width=e,l.height=i/p*e):(l.width=p/i*e,l.height=e),t.drawImage(v,0,0,l.width,l.height),Ce(v)),l}function Zt(v,g){const{width:p}=v,{height:i}=v,[e,t]=nt(p,i);switch(g>4&&g<9?(e.width=i,e.height=p):(e.width=p,e.height=i),g){case 2:t.transform(-1,0,0,1,p,0);break;case 3:t.transform(-1,0,0,-1,p,i);break;case 4:t.transform(1,0,0,-1,0,i);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,i,0);break;case 7:t.transform(0,-1,-1,0,i,p);break;case 8:t.transform(0,-1,1,0,0,p)}return t.drawImage(v,0,0,p,i),Ce(v),e}function Et(v,g,p=0){return new Promise(function(i,e){let t,l,o,m,x,n,s,r,a,b,D,F,y,k,U,_,T,h,E,c;function f(C=5){if(g.signal&&g.signal.aborted)throw g.signal.reason;t+=C,g.onProgress(Math.min(t,100))}function I(C){if(g.signal&&g.signal.aborted)throw g.signal.reason;t=Math.min(Math.max(C,t),100),g.onProgress(t)}return t=p,l=g.maxIteration||10,o=1024*g.maxSizeMB*1024,f(),tt(v,g).then((function(C){try{return[,m]=C,f(),x=Kt(m,g),f(),new Promise(function(A,S){var w;if(!(w=g.exifOrientation))return Vt(v).then((function(u){try{return w=u,R.call(this)}catch(d){return S(d)}}).bind(this),S);function R(){return A(w)}return R.call(this)}).then((function(A){try{return n=A,f(),Ne().then((function(S){try{return s=S?x:Zt(x,n),f(),r=g.initialQuality||1,a=g.fileType||v.type,rt(s,a,v.name,v.lastModified,r).then((function(w){try{{let u=function(){if(l--&&(U>o||U>y)){let z,j;return z=c?.95*E.width:E.width,j=c?.95*E.height:E.height,[T,h]=nt(z,j),h.drawImage(E,0,0,z,j),r*=a==="image/png"?.85:.95,rt(T,a,v.name,v.lastModified,r).then(function(L){try{return _=L,Ce(E),E=T,U=_.size,I(Math.min(99,Math.floor((k-U)/(k-o)*100))),u}catch(H){return e(H)}},e)}return[1]},d=function(){return Ce(E),Ce(T),Ce(x),Ce(s),Ce(m),I(100),i(_)};if(b=w,f(),D=b.size>o,F=b.size>v.size,!D&&!F)return I(100),i(b);var R;return y=v.size,k=b.size,U=k,E=s,c=!g.alwaysKeepResolution&&D,(R=(function(z){for(;z;){if(z.then)return void z.then(R,e);try{if(z.pop){if(z.length)return z.pop()?d.call(this):z;z=u}else z=z.call(this)}catch(j){return e(j)}}}).bind(this))(u)}}catch(u){return e(u)}}).bind(this),e)}catch(w){return e(w)}}).bind(this),e)}catch(S){return e(S)}}).bind(this),e)}catch(A){return e(A)}}).bind(this),e)})}const Pr=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let gt;function Lr(v,g){return new Promise((p,i)=>{gt||(gt=function(l){const o=[];return o.push(l),URL.createObjectURL(new Blob(o))}(Pr));const e=new Worker(gt);e.addEventListener("message",function(l){if(g.signal&&g.signal.aborted)e.terminate();else if(l.data.progress===void 0){if(l.data.error)return i(new Error(l.data.error)),void e.terminate();p(l.data.file),e.terminate()}else g.onProgress(l.data.progress)}),e.addEventListener("error",i),g.signal&&g.signal.addEventListener("abort",()=>{i(g.signal.reason),e.terminate()}),e.postMessage({file:v,imageCompressionLibUrl:g.libURL,options:{...g,onProgress:void 0,signal:void 0}})})}function ue(v,g){return new Promise(function(p,i){let e,t,l,o,m,x;if(e={...g},l=0,{onProgress:o}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,m=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=a=>{l=a,typeof o=="function"&&o(l)},!(v instanceof Blob||v instanceof zr))return i(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(v.type))return i(new Error("The file given is not an image"));if(x=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!m||typeof Worker!="function"||x)return Et(v,e).then((function(a){try{return t=a,r.call(this)}catch(b){return i(b)}}).bind(this),i);var n=(function(){try{return r.call(this)}catch(a){return i(a)}}).bind(this),s=function(a){try{return Et(v,e).then(function(b){try{return t=b,n()}catch(D){return i(D)}},i)}catch(b){return i(b)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",Lr(v,e).then(function(a){try{return t=a,n()}catch{return s()}},s)}catch{s()}function r(){try{t.name=v.name,t.lastModified=v.lastModified}catch{}try{e.preserveExif&&v.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===v.type)&&(t=Ot(v,t))}catch{}return p(t)}})}ue.getDataUrlFromFile=$t,ue.getFilefromDataUrl=yt,ue.loadImage=Gt,ue.drawImageInCanvas=qt,ue.drawFileInCanvas=tt,ue.canvasToFile=rt,ue.getExifOrientation=Vt,ue.handleMaxWidthOrHeight=Kt,ue.followExifOrientation=Zt,ue.cleanupCanvasMemory=Ce,ue.isAutoOrientationInBrowser=Ne,ue.approximateBelowMaximumCanvasSizeOfBrowser=Qt,ue.copyExifWithoutOrientation=Ot,ue.getBrowserName=Pe,ue.version="2.0.2";const Vr=({images:v,onImagesChange:g,storagePath:p,disabled:i=!1})=>{const[e,t]=le.useState(!1),[l,o]=le.useState(0),[m,x]=le.useState(null),[n,s]=le.useState(null),r=le.useRef(null),a=async y=>{const k=Array.from(y.target.files||[]);if(k.length!==0){t(!0),s(null),o(0);try{const U=Ke(),_=[];for(let T=0;T<k.length;T++){const h=k[T];let E=h;h.size>1024*1024&&(E=await ue(h,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0}));const c=`${Date.now()}_${pt()}.${E.type.split("/")[1]}`,f=`${p}/${c}`,I=Ze(U,f),C=Ft(I,E);await new Promise((A,S)=>{C.on("state_changed",w=>{const R=(T+w.bytesTransferred/w.totalBytes)/k.length*100;o(R)},w=>{console.error("Upload error:",w),S(w)},async()=>{const w=await Rt(C.snapshot.ref);_.push({url:w,path:f,title:h.name.replace(/\.[^/.]+$/,"")}),A()})})}g([...v,..._])}catch(U){console.error("Error uploading images:",U),s("Failed to upload images. Please try again.")}finally{t(!1),o(0),r.current&&(r.current.value="")}}},b=async y=>{const k=v[y];try{const U=Ke(),_=Ze(U,k.path);await kt(_);const T=v.filter((h,E)=>E!==y);g(T)}catch(U){console.error("Error deleting image:",U),s("Failed to delete image. It may have been already deleted.");const _=v.filter((T,h)=>h!==y);g(_)}},D=le.useCallback((y,k)=>{const U=[...v];U[y]={...U[y],title:k},g(U)},[v,g]),F=y=>{x(y)};return P.jsxs(ae,{children:[P.jsxs(ae,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:G[3]},children:[P.jsxs(ae,{sx:{display:"flex",alignItems:"center",gap:G[2]},children:[P.jsx(Dt,{sx:{color:N.text.tertiary}}),P.jsx(oe,{variant:"h6",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.semibold,color:N.text.primary},children:"Images"}),P.jsxs(oe,{variant:"body2",sx:{color:N.text.tertiary,fontSize:q.fontSize.sm},children:[v.length," ",v.length===1?"image":"images"]})]}),P.jsx(Xe,{variant:"outlined",startIcon:P.jsx(Mt,{}),onClick:()=>{var y;return(y=r.current)==null?void 0:y.click()},disabled:i||e,sx:{borderRadius:re.md,textTransform:"none",fontWeight:q.fontWeight.medium},children:"Upload Images"}),P.jsx("input",{ref:r,type:"file",accept:"image/*",multiple:!0,style:{display:"none"},onChange:a,disabled:i})]}),e&&P.jsxs(ae,{sx:{mb:G[3]},children:[P.jsx(zt,{variant:"determinate",value:l}),P.jsxs(oe,{variant:"caption",sx:{color:N.text.tertiary,mt:G[1],display:"block"},children:["Uploading... ",Math.round(l),"%"]})]}),n&&P.jsx(Pt,{severity:"error",onClose:()=>s(null),sx:{mb:G[3]},children:n}),v.length>0?P.jsx(St,{container:!0,spacing:G[2],children:v.map((y,k)=>P.jsx(St,{item:!0,xs:12,sm:6,md:4,children:P.jsxs(fr,{sx:{borderRadius:re.lg,boxShadow:It.sm,transition:"all 0.2s","&:hover":{boxShadow:It.md}},children:[P.jsx(ur,{component:"img",height:"160",image:y.url,alt:y.title,sx:{objectFit:"cover",cursor:"pointer"},onClick:()=>F(y)}),P.jsx(hr,{sx:{p:G[2]},children:P.jsx(gr,{fullWidth:!0,size:"small",placeholder:"Image title...",value:y.title,onChange:U=>D(k,U.target.value),disabled:i,sx:{"& .MuiInputBase-root":{fontSize:q.fontSize.sm}}})}),P.jsxs(pr,{sx:{px:G[2],pb:G[2],pt:0,justifyContent:"space-between"},children:[P.jsx(Ye,{title:"View fullscreen",children:P.jsx(We,{size:"small",onClick:()=>F(y),children:P.jsx(br,{fontSize:"small"})})}),P.jsx(Ye,{title:"Delete image",children:P.jsx(We,{size:"small",onClick:()=>b(k),disabled:i,sx:{color:N.error,"&:hover":{backgroundColor:"#FEE2E2"}},children:P.jsx(Lt,{fontSize:"small"})})})]})]})},k))}):P.jsxs(ae,{sx:{border:`2px dashed ${N.neutral[300]}`,borderRadius:re.lg,p:G[6],textAlign:"center",backgroundColor:N.background.secondary},children:[P.jsx(Dt,{sx:{fontSize:48,color:N.text.tertiary,mb:G[2]}}),P.jsx(oe,{variant:"body1",sx:{color:N.text.secondary,mb:G[1]},children:"No images yet"}),P.jsxs(oe,{variant:"body2",sx:{color:N.text.tertiary,fontSize:q.fontSize.sm},children:['Click "Upload Images" to add images to this ',p.includes("design")?"design":p.includes("build")?"build":"test"]})]}),P.jsx(jt,{open:!!m,onClose:()=>x(null),maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{backgroundColor:N.background.primary,borderRadius:re.xl}},children:P.jsx(Tt,{sx:{p:0,position:"relative"},children:m&&P.jsxs(P.Fragment,{children:[P.jsx(We,{onClick:()=>x(null),sx:{position:"absolute",top:G[2],right:G[2],backgroundColor:"rgba(0, 0, 0, 0.5)",color:"#fff","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"},zIndex:1},children:P.jsx(mr,{})}),P.jsx("img",{src:m.url,alt:m.title,style:{width:"100%",height:"auto",display:"block"}}),m.title&&P.jsx(ae,{sx:{p:G[3],backgroundColor:N.background.secondary},children:P.jsx(oe,{variant:"h6",sx:{fontFamily:q.fontFamily.display,color:N.text.primary},children:m.title})})]})})})]})},Br=v=>{var p;switch((p=v.split(".").pop())==null?void 0:p.toLowerCase()){case"pdf":return P.jsx(Sr,{sx:{color:"#D32F2F"}});case"doc":case"docx":return P.jsx(Ut,{sx:{color:"#1976D2"}});case"xls":case"xlsx":case"csv":return P.jsx(Dr,{sx:{color:"#2E7D32"}});case"txt":case"md":return P.jsx(Ut,{sx:{color:N.text.secondary}});case"json":case"xml":case"html":case"css":case"js":case"ts":return P.jsx(_r,{sx:{color:"#F57C00"}});case"zip":case"rar":case"7z":return P.jsx(Cr,{sx:{color:"#5E35B1"}});default:return P.jsx(bt,{sx:{color:N.text.tertiary}})}},Kr=({files:v,onFilesChange:g,storagePath:p,disabled:i=!1,maxFileSize:e=10,allowedTypes:t=[]})=>{const[l,o]=le.useState(!1),[m,x]=le.useState(0),[n,s]=le.useState(""),[r,a]=le.useState(null),b=le.useRef(null),D=le.useCallback(k=>{var _;const U=e*1024*1024;if(k.size>U)return`File size exceeds ${e}MB limit`;if(t.length>0){const T=`.${(_=k.name.split(".").pop())==null?void 0:_.toLowerCase()}`;if(!t.some(E=>E.startsWith(".")?E.toLowerCase()===T:k.type===E))return`File type not allowed. Allowed types: ${t.join(", ")}`}return null},[e,t]),F=async k=>{const U=Array.from(k.target.files||[]);if(U.length!==0){o(!0),a(null),x(0);try{const _=Ke(),T=[];for(let h=0;h<U.length;h++){const E=U[h];s(E.name);const c=D(E);if(c){a(c);continue}const f=E.name.split(".").pop(),I=`${Date.now()}_${pt()}.${f}`,C=`${p}/files/${I}`,A=Ze(_,C),S=Ft(A,E);await new Promise((w,R)=>{S.on("state_changed",u=>{const d=(h+u.bytesTransferred/u.totalBytes)/U.length*100;x(d)},u=>{console.error("Upload error:",u),R(u)},async()=>{const u=await Rt(S.snapshot.ref);T.push({id:pt(),url:u,name:E.name,path:C}),w()})})}g([...v,...T])}catch(_){console.error("Error uploading files:",_),a("Failed to upload files. Please try again.")}finally{o(!1),x(0),s(""),b.current&&(b.current.value="")}}},y=async k=>{const U=v[k];try{const _=Ke(),T=Ze(_,U.path);await kt(T);const h=v.filter((E,c)=>c!==k);g(h)}catch(_){console.error("Error deleting file:",_),a("Failed to delete file. It may have been already deleted.");const T=v.filter((h,E)=>E!==k);g(T)}};return P.jsxs(ae,{children:[P.jsxs(ae,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:G[3]},children:[P.jsxs(ae,{sx:{display:"flex",alignItems:"center",gap:G[2]},children:[P.jsx(bt,{sx:{color:N.text.tertiary}}),P.jsx(oe,{variant:"h6",sx:{fontFamily:q.fontFamily.display,fontWeight:q.fontWeight.semibold,color:N.text.primary},children:"Files"}),P.jsxs(oe,{variant:"body2",sx:{color:N.text.tertiary,fontSize:q.fontSize.sm},children:[v.length," ",v.length===1?"file":"files"]})]}),P.jsx(Xe,{variant:"outlined",startIcon:P.jsx(Mt,{}),onClick:()=>{var k;return(k=b.current)==null?void 0:k.click()},disabled:i||l,sx:{borderRadius:re.md,textTransform:"none",fontWeight:q.fontWeight.medium},children:"Upload Files"}),P.jsx("input",{ref:b,type:"file",multiple:!0,style:{display:"none"},onChange:F,disabled:i,accept:t.length>0?t.join(","):void 0})]}),l&&P.jsxs(ae,{sx:{mb:G[3]},children:[P.jsxs(oe,{variant:"caption",sx:{color:N.text.secondary,mb:G[1],display:"block"},children:["Uploading ",n,"..."]}),P.jsx(zt,{variant:"determinate",value:m}),P.jsxs(oe,{variant:"caption",sx:{color:N.text.tertiary,mt:G[1],display:"block"},children:[Math.round(m),"%"]})]}),r&&P.jsx(Pt,{severity:"error",onClose:()=>a(null),sx:{mb:G[3]},children:r}),v.length>0?P.jsx(yr,{sx:{border:`1px solid ${N.neutral[200]}`,borderRadius:re.lg,backgroundColor:N.background.secondary,overflow:"hidden"},children:v.map((k,U)=>{var _;return P.jsxs(vr,{sx:{borderBottom:U<v.length-1?`1px solid ${N.neutral[200]}`:"none","&:hover":{backgroundColor:N.neutral[50]}},children:[P.jsx(xr,{children:Br(k.name)}),P.jsx(wr,{primary:P.jsx(oe,{variant:"body2",sx:{fontWeight:q.fontWeight.medium,color:N.text.primary},children:k.name}),secondary:P.jsxs(oe,{variant:"caption",sx:{color:N.text.tertiary},children:[(_=k.name.split(".").pop())==null?void 0:_.toUpperCase()," file"]})}),P.jsx(Ir,{children:P.jsx(We,{edge:"end",onClick:()=>y(U),disabled:i,sx:{color:N.error,"&:hover":{backgroundColor:"#FEE2E2"}},children:P.jsx(Lt,{})})})]},k.id)})}):P.jsxs(ae,{sx:{border:`2px dashed ${N.neutral[300]}`,borderRadius:re.lg,p:G[6],textAlign:"center",backgroundColor:N.background.secondary},children:[P.jsx(bt,{sx:{fontSize:48,color:N.text.tertiary,mb:G[2]}}),P.jsx(oe,{variant:"body1",sx:{color:N.text.secondary,mb:G[1]},children:"No files attached"}),P.jsx(oe,{variant:"body2",sx:{color:N.text.tertiary,fontSize:q.fontSize.sm},children:'Click "Upload Files" to attach documents, data files, or other resources'}),e&&P.jsx(Ar,{label:`Max file size: ${e}MB`,size:"small",sx:{mt:G[2]}})]})]})};export{Qr as C,Kr as F,Vr as I,qr as R,Er as l,Gr as u};
