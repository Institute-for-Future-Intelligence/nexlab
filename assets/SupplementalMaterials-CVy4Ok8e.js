import{j as e,y as V,z as ee,am as D,a9 as ke,al as _,B as c,v as Y,t as K,I as Q,a1 as ge,a5 as Ie,ak as ie,T as o,af as we,a0 as Ae,a as I,ai as Fe,Y as le,r as f,G as b,bt as De,bu as ze,ao as ye,N as re,O as se,U as ne,V as je,W as oe,C as Ce,a7 as We,A as Se,J as Me,P as Te,aK as ce,aH as de,ar as xe,az as O,aA as L,aB as Re,a3 as U,aC as q,aD as Pe,Z as H,_ as N,aE as Be,K as $e,aF as Ee,D as he}from"./ui-DcSnJRFv.js";import{j as r,P as Oe,k as ae,b as k,u as J,l as ue,c as y,a as te,d as Le,s as v,t as S,m as Ue,n as qe,o as He}from"./index-KeQY9hs7.js";import{P as G,R as fe,x as pe,v as X,_ as me,I as Ne,e as Z,y as Ye,i as _e,f as ve}from"./firebase-CTJJwFJC.js";import"./vendor-BFl3bqVE.js";const Ge=s=>{const h=new Date;if(s.scheduledTimestamp){const a=s.scheduledTimestamp.toDate();return a>h?`Scheduled for ${a.toLocaleDateString()}`:`Scheduled ${a.toLocaleDateString()}`}if(s.published){const a=s.timestamp.toDate(),i=Math.floor((h.getTime()-a.getTime())/(1e3*60*60*24));if(i===0)return"Published today";if(i===1)return"Published yesterday";if(i<7)return`Published ${i} days ago`;if(i<30){const x=Math.floor(i/7);return`Published ${x} week${x>1?"s":""} ago`}else return`Published ${a.toLocaleDateString()}`}const t=s.timestamp.toDate(),d=Math.floor((h.getTime()-t.getTime())/(1e3*60*60*24));if(d===0)return"Created today";if(d===1)return"Created yesterday";if(d<7)return`Created ${d} days ago`;if(d<30){const a=Math.floor(d/7);return`Created ${a} week${a>1?"s":""} ago`}else return`Created ${t.toLocaleDateString()}`},Je=({material:s,isCourseAdmin:h=!1,loading:t=!1,onView:d,onEdit:a,onDelete:i,onUnpublish:x,className:u})=>{const p=(g=>g.published?{label:"Published",color:r.palette.success.main,backgroundColor:r.palette.success.light,icon:e.jsx(ie,{sx:{fontSize:16}})}:g.scheduledTimestamp?{label:"Scheduled",color:r.palette.info.main,backgroundColor:r.palette.info.light,icon:e.jsx(we,{sx:{fontSize:16}})}:{label:"Draft",color:r.palette.warning.main,backgroundColor:r.palette.warning.light,icon:e.jsx(Ae,{sx:{fontSize:16}})})(s);return t?e.jsxs(V,{className:u,sx:{height:200},children:[e.jsxs(ee,{children:[e.jsx(D,{variant:"text",width:"80%",height:32}),e.jsx(D,{variant:"text",width:"60%",height:24,sx:{mt:1}}),e.jsx(D,{variant:"rectangular",width:"100%",height:40,sx:{mt:2,borderRadius:2}})]}),e.jsxs(ke,{children:[e.jsx(D,{variant:"circular",width:40,height:40}),e.jsx(D,{variant:"circular",width:40,height:40}),e.jsx(D,{variant:"circular",width:40,height:40})]})]}):e.jsx(_,{in:!0,timeout:300,children:e.jsx(V,{className:u,sx:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-4px)",boxShadow:r.shadows[8]}},children:e.jsxs(ee,{sx:{flexGrow:1,pb:3,px:3,pt:3},children:[e.jsxs(c,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Y,{icon:p.icon,label:p.label,size:"small",sx:{backgroundColor:p.backgroundColor,color:p.color,fontWeight:600,"& .MuiChip-icon":{color:p.color}}}),h&&e.jsxs(c,{sx:{display:"flex",gap:.5},children:[e.jsx(K,{title:"Edit Material",arrow:!0,children:e.jsx(Q,{size:"small",onClick:g=>{g.stopPropagation(),a==null||a(s.id)},sx:{color:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.light,color:r.palette.primary.contrastText}},children:e.jsx(ge,{fontSize:"small"})})}),e.jsx(K,{title:"Delete Material",arrow:!0,children:e.jsx(Q,{size:"small",onClick:g=>{g.stopPropagation(),i==null||i(s.id)},sx:{color:r.palette.error.main,"&:hover":{backgroundColor:r.palette.error.light,color:r.palette.error.contrastText}},children:e.jsx(Ie,{fontSize:"small"})})}),s.published&&x&&e.jsx(K,{title:"Unpublish Material",arrow:!0,children:e.jsx(Q,{size:"small",onClick:g=>{g.stopPropagation(),x==null||x(s.id)},sx:{color:r.palette.warning.main,"&:hover":{backgroundColor:r.palette.warning.light,color:r.palette.warning.contrastText}},children:e.jsx(ie,{fontSize:"small"})})})]})]}),e.jsx(o,{variant:"h5",component:"h3",sx:{fontFamily:r.typography.h5.fontFamily,fontWeight:600,fontSize:{xs:"1.25rem",sm:"1.5rem"},lineHeight:1.3,color:r.palette.text.primary,mb:1,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{color:r.palette.primary.main,textDecoration:"underline",textDecorationColor:r.palette.primary.main,textDecorationThickness:"2px",textUnderlineOffset:"4px",transform:"translateY(-1px)"}},onClick:g=>{g.stopPropagation(),d==null||d(s.id)},children:s.title||"Untitled Material"}),e.jsx(c,{sx:{mt:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:1},children:[e.jsx(c,{component:"span",sx:{width:8,height:8,borderRadius:"50%",backgroundColor:p.color}}),Ge(s)]})})]})})})},Ze=()=>e.jsx(Oe,{title:"Course Materials"}),Ke=({selectedCourse:s,variant:h="contained",size:t="large",showModeToggle:d=!1,onModeChange:a,currentMode:i="manual"})=>{const x=ae(),u=()=>{s&&x(`/add-material?course=${s}&mode=${d?i:"manual"}`)},j=p=>{a&&a(p)};return d?e.jsx(_,{in:!0,timeout:500,children:e.jsxs(c,{sx:{display:"flex",flexDirection:"column",gap:2,p:3,backgroundColor:r.palette.background.paper,borderRadius:k["2xl"],border:`1px solid ${r.palette.divider}`,boxShadow:r.shadows[2]},children:[e.jsx(o,{variant:"h6",sx:{fontFamily:r.typography.h6.fontFamily,fontWeight:r.typography.h6.fontWeight,color:r.palette.text.primary,textAlign:"center",mb:1},children:"Create New Material"}),e.jsx(o,{variant:"body2",sx:{color:r.palette.text.secondary,textAlign:"center",mb:2},children:"Choose how you'd like to create your material"}),e.jsxs(c,{sx:{display:"flex",gap:2},children:[e.jsx(I,{variant:i==="manual"?"contained":"outlined",startIcon:e.jsx(ge,{}),onClick:()=>j("manual"),disabled:!s,sx:{flex:1,py:2,borderRadius:k.xl,textTransform:"none",fontWeight:600,...i==="manual"&&{backgroundColor:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.dark}},...i!=="manual"&&{borderColor:r.palette.primary.main,color:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.light,borderColor:r.palette.primary.dark}}},children:"Manual Entry"}),e.jsx(I,{variant:i==="ai"?"contained":"outlined",startIcon:e.jsx(Fe,{}),onClick:()=>j("ai"),disabled:!s,sx:{flex:1,py:2,borderRadius:k.xl,textTransform:"none",fontWeight:600,...i==="ai"&&{backgroundColor:r.palette.secondary.main,"&:hover":{backgroundColor:r.palette.secondary.dark}},...i!=="ai"&&{borderColor:r.palette.secondary.main,color:r.palette.secondary.main,"&:hover":{backgroundColor:r.palette.secondary.light,borderColor:r.palette.secondary.dark}}},children:"AI Import"})]}),e.jsx(I,{variant:"contained",startIcon:e.jsx(le,{}),onClick:u,disabled:!s,size:t,sx:{width:"100%",py:2,borderRadius:k.xl,textTransform:"none",fontWeight:600,backgroundColor:i==="ai"?r.palette.secondary.main:r.palette.primary.main,"&:hover":{backgroundColor:i==="ai"?r.palette.secondary.dark:r.palette.primary.dark,transform:"translateY(-1px)",boxShadow:r.shadows[4]},transition:r.transitions.create(["all"],{duration:r.transitions.duration.short})},children:i==="ai"?"Import with AI":"Create Material"})]})}):e.jsx(_,{in:!0,timeout:300,children:e.jsx(I,{variant:h,startIcon:e.jsx(le,{}),onClick:u,disabled:!s,size:t,sx:{borderRadius:r.shape.borderRadius,textTransform:"none",fontWeight:600,py:t==="large"?2:t==="medium"?1.5:1,px:t==="large"?4:t==="medium"?3:2,transition:r.transitions.create(["all"],{duration:r.transitions.duration.short}),"&:hover":{transform:"translateY(-1px)",boxShadow:r.shadows[4]},...h==="contained"&&{backgroundColor:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.dark}},...h==="outlined"&&{borderColor:r.palette.primary.main,color:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.light,borderColor:r.palette.primary.dark}}},children:"Add Material"})})},Qe=({courseId:s,isCourseAdmin:h,onDeleteClick:t,onUnpublishClick:d})=>{const[a,i]=f.useState(0),[x,u]=f.useState([]),[j,p]=f.useState(!0),[g,w]=f.useState(null),{userDetails:A}=J(),T=ae(),z=G(),F=[{key:"published",label:"Published",icon:"ðŸ“š"},{key:"scheduled",label:"Scheduled",icon:"â°"},{key:"saved",label:"Drafts",icon:"ðŸ’¾"}];f.useEffect(()=>{if(!s){u([]),p(!1);return}p(!0);const n=A!=null&&A.isAdmin?fe(me(z,"materials"),X("course","==",s),pe("timestamp","desc")):fe(me(z,"materials"),X("course","==",s),X("published","==",!0),pe("timestamp","desc")),l=Ne(n,m=>{const C=m.docs.map(E=>({id:E.id,...E.data()}));u(C),p(!1),w(null)},m=>{console.error("Error fetching materials:",m),w("Failed to fetch materials"),p(!1)});return()=>l()},[s,z,A]);const R=(n,l)=>{i(l)},P=n=>{T(`/view-material/${n}`)},B=n=>{T(`/edit-material/${n}`)},W=n=>x.filter(l=>{switch(n){case"published":return l.published===!0;case"scheduled":return l.scheduledTimestamp&&!l.published;case"saved":return!l.published&&!l.scheduledTimestamp;default:return!1}}),$=n=>W(n).length,M=W(F[a].key);return j?e.jsxs(c,{sx:{width:"100%"},children:[e.jsx(c,{sx:{mb:4},children:e.jsx(D,{variant:"rectangular",height:60,sx:{borderRadius:2}})}),e.jsx(b,{container:!0,spacing:3,children:Array.from({length:6}).map((n,l)=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,children:e.jsx(D,{variant:"rectangular",height:200,sx:{borderRadius:2}})},l))})]}):g?e.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200,p:4},children:[e.jsx(o,{variant:"h6",sx:{color:r.palette.error.main,mb:2,textAlign:"center"},children:"Error Loading Materials"}),e.jsx(o,{variant:"body2",sx:{color:r.palette.text.secondary,textAlign:"center"},children:g})]}):e.jsxs(c,{sx:{width:"100%"},children:[e.jsx(c,{sx:{mb:4},children:e.jsx(De,{value:a,onChange:R,variant:"fullWidth",sx:{backgroundColor:r.palette.background.paper,borderRadius:k.xl,boxShadow:r.shadows[1],"& .MuiTabs-indicator":{backgroundColor:r.palette.primary.main,height:3,borderRadius:"3px 3px 0 0"},"& .MuiTabs-flexContainer":{gap:1}},children:F.map((n,l)=>{const m=$(n.key);return e.jsx(ze,{label:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(o,{variant:"button",sx:{fontWeight:600,textTransform:"none",fontSize:"0.875rem"},children:n.label}),e.jsx(Y,{label:m,size:"small",sx:{backgroundColor:r.palette.primary.light,color:r.palette.primary.main,fontWeight:600,minWidth:24,height:20,fontSize:"0.75rem"}})]}),sx:{textTransform:"none",fontWeight:600,minHeight:48,color:r.palette.text.primary,"&.Mui-selected":{color:r.palette.primary.main,backgroundColor:r.palette.primary.light,borderRadius:k.xl},"&:hover":{backgroundColor:r.palette.action.hover,borderRadius:k.xl}}},n.key)})})}),M.length===0?e.jsx(ye,{maxWidth:"md",children:e.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300,textAlign:"center"},children:[e.jsxs(o,{variant:"h6",sx:{color:r.palette.text.secondary,mb:2},children:[a===0&&"No published materials yet.",a===1&&"No scheduled materials.",a===2&&"No draft materials saved."]}),e.jsxs(o,{variant:"body2",sx:{color:r.palette.text.disabled},children:[a===0&&"Published materials will appear here once you publish them.",a===1&&"Scheduled materials will appear here once you schedule them.",a===2&&"Draft materials will appear here as you work on them."]})]})}):e.jsx(_,{in:!0,timeout:300,children:e.jsx(b,{container:!0,spacing:3,children:M.map(n=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Je,{material:n,isCourseAdmin:h,onView:P,onEdit:B,onDelete:t,onUnpublish:d})},n.id))})})]})},Xe=({materialId:s,open:h,onClose:t,onDelete:d})=>{const a=G(),i=async()=>{const x=Z(a,"materials",s);await Ye(x),d(),t()};return e.jsxs(re,{open:h,onClose:t,children:[e.jsx(se,{children:"Delete Material"}),e.jsx(ne,{children:e.jsx(je,{children:"Are you sure you want to delete this material? This action cannot be undone."})}),e.jsxs(oe,{children:[e.jsx(I,{onClick:t,color:"primary",children:"Cancel"}),e.jsx(I,{onClick:i,color:"secondary",children:"Delete"})]})]})},Ve=({materialId:s,open:h,onClose:t,onUnpublish:d})=>{const a=G(),i=async()=>{const x=Z(a,"materials",s);await _e(x,{published:!1}),d(),t()};return e.jsxs(re,{open:h,onClose:t,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(se,{id:"alert-dialog-title",children:"Unpublish Material"}),e.jsx(ne,{children:e.jsx(je,{id:"alert-dialog-description",children:"Are you sure you want to unpublish this material? It will no longer be visible to users until it is published again."})}),e.jsxs(oe,{children:[e.jsx(I,{onClick:t,color:"primary",children:"Cancel"}),e.jsx(I,{onClick:i,color:"error",autoFocus:!0,children:"Unpublish"})]})]})},et=({initialCourse:s})=>{const{userDetails:h}=J(),t=G(),[d,a]=f.useState(s??null),[i,x]=f.useState(!1),[u,j]=f.useState(null),[p,g]=f.useState({open:!1,materialId:null}),[w,A]=f.useState(null),[T,z]=f.useState(!1),F=f.useCallback(async()=>{if(d)try{z(!0);const l=Z(t,"courses",d),m=await ve(l);if(m.exists()){const C=m.data(),E=(C==null?void 0:C.courseAdmin)||[];x(E.includes(h==null?void 0:h.uid))}else x(!1)}catch(l){console.error("Error fetching course admin status:",l),A("Failed to verify course permissions")}finally{z(!1)}},[d,t,h]);f.useEffect(()=>{d&&F()},[d,F]),f.useEffect(()=>{s&&d!==s&&a(s)},[s,d]);const R=l=>{j(l)},P=()=>{j(null)},B=()=>{console.log("Material deleted:",u),j(null)},W=l=>{g({open:!0,materialId:l})},$=()=>{console.log("Material unpublished:",p.materialId),g({open:!1,materialId:null})},M=()=>{g({open:!1,materialId:null})},n=()=>{A(null)};return e.jsxs(c,{sx:{width:"100%"},children:[d?e.jsx(_,{in:!0,timeout:500,children:e.jsx(c,{children:e.jsx(Qe,{courseId:d,isCourseAdmin:i,onDeleteClick:R,onUnpublishClick:W})})}):e.jsx(ye,{maxWidth:"md",children:e.jsxs(c,{sx:{textAlign:"center",py:8,px:4,backgroundColor:r.palette.background.paper,borderRadius:k["2xl"],border:`1px solid ${r.palette.divider}`},children:[e.jsx(o,{variant:"h5",sx:{fontFamily:r.typography.h5.fontFamily,fontWeight:r.typography.h5.fontWeight,color:r.palette.text.secondary,mb:2},children:"Select a Course"}),e.jsx(o,{variant:"body1",sx:{color:r.palette.text.secondary,maxWidth:400,mx:"auto"},children:"Please select a course from the dropdown above to view and manage course materials."})]})}),T&&e.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:4},children:e.jsx(Ce,{size:40,sx:{color:r.palette.primary.main}})}),u&&e.jsx(Xe,{materialId:u,open:!!u,onClose:P,onDelete:B}),p.materialId&&e.jsx(Ve,{materialId:p.materialId,open:p.open,onClose:M,onUnpublish:$}),w&&e.jsx(We,{open:!!w,autoHideDuration:6e3,onClose:n,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(Se,{onClose:n,severity:"error",sx:{backgroundColor:r.palette.error.light,color:r.palette.error.contrastText,"& .MuiAlert-icon":{color:r.palette.error.main}},children:w})})]})},tt=()=>{const{userDetails:s}=J();return f.useMemo(()=>{if(!(s!=null&&s.classes))return{publicCourses:[],userCourses:[]};const t=Object.entries(s.classes).map(([i,x])=>{let u,j;return x.courseCreatedAt&&(x.courseCreatedAt instanceof Date?u=x.courseCreatedAt:u=ue(x.courseCreatedAt)),x.enrolledAt&&(x.enrolledAt instanceof Date?j=x.enrolledAt:j=ue(x.enrolledAt)),{id:i,number:x.number,title:x.title,isPublic:i==="rqoyheM9Lf8jGftIoZyT",courseCreatedAt:u||void 0,enrolledAt:j||void 0,isCourseAdmin:x.isCourseAdmin}}),d=t.filter(i=>i.isPublic),a=t.filter(i=>!i.isPublic);return a.sort((i,x)=>!i.enrolledAt&&!x.enrolledAt?0:i.enrolledAt?x.enrolledAt?x.enrolledAt.getTime()-i.enrolledAt.getTime():-1:1),{publicCourses:d,userCourses:a}},[s==null?void 0:s.classes])},rt=({course:s,onClick:h})=>{const t=s.isPublic||s.id==="xsA42JCvfCUtmyoyx45s";return e.jsx(V,{onClick:h,sx:{height:"100%",cursor:"pointer",backgroundColor:y.background.primary,borderRadius:k.xl,border:`1px solid ${y.neutral[200]}`,boxShadow:te.sm,transition:Le.transitions.normal,position:"relative","&:hover":{transform:"translateY(-8px)",boxShadow:te.xl,border:`1px solid ${t?y.warning:y.primary[500]}`}},children:e.jsx(ee,{sx:{textAlign:"center",p:v[4],height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:e.jsxs(c,{sx:{flex:1},children:[e.jsx(c,{sx:{color:t?y.warning:y.primary[500],mb:v[3],display:"flex",justifyContent:"center"},children:e.jsx(Me,{sx:{fontSize:40}})}),e.jsx(o,{variant:"h6",component:"h3",sx:{fontWeight:S.fontWeight.bold,fontFamily:S.fontFamily.display,fontSize:"2rem",color:y.text.primary,mb:v[2]},children:s.number}),e.jsx(o,{variant:"body2",sx:{color:y.text.secondary,fontFamily:S.fontFamily.secondary,fontSize:S.fontSize.lg,lineHeight:1.5,mb:v[1]},children:s.title}),s.enrolledAt&&e.jsxs(o,{variant:"caption",sx:{color:y.text.tertiary,fontFamily:S.fontFamily.secondary,fontSize:S.fontSize.xs,fontStyle:"italic",mb:v[2],display:"block"},children:["Enrolled: ",s.enrolledAt.toLocaleDateString()]}),e.jsx(Y,{label:s.isCourseAdmin?"Instructor Access":"Student Access",size:"small",sx:{backgroundColor:s.isCourseAdmin?y.warning+"20":y.secondary[100],color:s.isCourseAdmin?y.warning:y.secondary[700],fontFamily:S.fontFamily.secondary,fontWeight:S.fontWeight.medium,fontSize:S.fontSize.xs}})]})})})},be=({title:s,courses:h,onCourseClick:t})=>h.length===0?null:e.jsxs(c,{sx:{mb:v[6]},children:[e.jsxs(c,{sx:{mb:v[4]},children:[e.jsx(o,{variant:"h4",component:"h2",sx:{fontFamily:S.fontFamily.display,fontSize:S.fontSize.xl,fontWeight:S.fontWeight.bold,color:y.text.primary,mb:v[2]},children:s}),e.jsxs(o,{variant:"body1",sx:{fontFamily:S.fontFamily.secondary,fontSize:S.fontSize.base,color:y.text.secondary,lineHeight:1.6},children:[h.length," ",h.length===1?"course":"courses"," available"]})]}),e.jsx(b,{container:!0,spacing:v[4],children:h.map(d=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(rt,{course:d,onClick:()=>t(d.id)})},d.id))})]}),st=({courses:s})=>{const h=ae(),{publicCourses:t,userCourses:d}=tt(),a=i=>{h(`/supplemental-materials?course=${i}`)};return e.jsx(c,{sx:{width:"100%",padding:4},children:e.jsxs(c,{sx:{mb:v[6],p:v[4],backgroundColor:y.background.secondary,borderRadius:k.xl,border:`1px solid ${y.neutral[200]}`,boxShadow:te.sm,position:"relative",mt:v[3]},children:[e.jsx(c,{sx:{position:"absolute",top:"-25px",left:"40px",backgroundColor:y.secondary[500],borderRadius:`${k.lg} ${k.lg} 0 0`,px:v[3],py:v[1],zIndex:1},children:e.jsx(o,{sx:{color:y.text.inverse,fontFamily:S.fontFamily.display,fontSize:"2rem",fontWeight:S.fontWeight.bold,whiteSpace:"nowrap",lineHeight:1},children:"Available Courses"})}),e.jsxs(c,{sx:{mt:v[3]},children:[e.jsx(be,{title:"Public Course",courses:t,onCourseClick:a}),e.jsx(be,{title:"Your Enrolled Courses",courses:d,onCourseClick:a})]})]})})},nt=({courseId:s,isAdmin:h=!1})=>{var B,W,$,M;const[t,d]=f.useState(null),[a,i]=f.useState(null),[x,u]=f.useState(!0),[j,p]=f.useState(null),[g,w]=f.useState(!1),A=G();f.useEffect(()=>{s&&(async()=>{try{u(!0);const l=Z(A,"courses",s),m=await ve(l);if(m.exists()){const C=m.data();d(C.additionalInfo||null),i(C.syllabusFile||null)}else p("Course not found")}catch(l){console.error("Error fetching course additional info:",l),p("Failed to load course information")}finally{u(!1)}})()},[s,A]);const T=()=>{a!=null&&a.url&&window.open(a.url,"_blank")},F=(()=>{if(!t)return{};const n=new Set(["contactInfo","policies","additionalResources","labSpecific","textbooks","gradingPolicy","assignments","prerequisites","lastUpdated"]),l={};return Object.keys(t).forEach(m=>{!n.has(m)&&t[m]!=null&&(l[m]=t[m])}),l})(),R=Object.keys(F).length>0,P=t&&(t.contactInfo||t.policies||t.additionalResources||t.labSpecific||((B=t.textbooks)==null?void 0:B.length)||((W=t.gradingPolicy)==null?void 0:W.length)||(($=t.assignments)==null?void 0:$.length)||((M=t.prerequisites)==null?void 0:M.length)||R);return x?e.jsx(c,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(Ce,{})}):j?e.jsx(Se,{severity:"error",sx:{mb:3},children:j}):!P&&!a?null:e.jsxs(Te,{sx:{p:3,mb:4,backgroundColor:"#f8f9fa",borderRadius:"15px",border:"1px solid #e3f2fd"},children:[e.jsxs(o,{variant:"h4",sx:{mb:3,display:"flex",alignItems:"center",gap:1,fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"2rem"},children:[e.jsx(ce,{sx:{color:"#0B53C0"}}),"Course Information"]}),a&&e.jsx(c,{sx:{mb:3},children:e.jsx(I,{variant:"outlined",startIcon:e.jsx(xe,{}),endIcon:e.jsx(de,{}),onClick:()=>w(!0),sx:{mb:2,fontFamily:"Staatliches, sans-serif",fontSize:"1.2rem",textTransform:"none",borderRadius:"15px",backgroundColor:"#CDDAFF",color:"#0B53C0",border:"1px solid #0B53C0","&:hover":{backgroundColor:"#0B53C0",color:"#FFFFFF"}},children:"Syllabus"})}),P&&e.jsxs(c,{sx:{mb:2},children:[(t==null?void 0:t.contactInfo)&&Object.keys(t.contactInfo).length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(U,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Re,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Contact Information"})]})}),e.jsx(q,{children:e.jsxs(b,{container:!0,spacing:2,children:[t.contactInfo.email&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Email"}),e.jsx(o,{variant:"body1",children:t.contactInfo.email})]}),t.contactInfo.phone&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Phone"}),e.jsx(o,{variant:"body1",children:t.contactInfo.phone})]}),t.contactInfo.office&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Office"}),e.jsx(o,{variant:"body1",children:t.contactInfo.office})]}),t.contactInfo.officeHours&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Office Hours"}),e.jsx(o,{variant:"body1",children:t.contactInfo.officeHours})]}),t.contactInfo.website&&e.jsxs(b,{item:!0,xs:12,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Website"}),e.jsx(o,{variant:"body1",children:e.jsx("a",{href:t.contactInfo.website,target:"_blank",rel:"noopener noreferrer",children:t.contactInfo.website})})]})]})})]}),(t==null?void 0:t.textbooks)&&t.textbooks.length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(U,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Pe,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Textbooks & Resources"})]})}),e.jsx(q,{children:e.jsx(H,{children:t.textbooks.map((n,l)=>e.jsxs(N,{sx:{px:0,flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(o,{variant:"body1",sx:{fontWeight:"medium"},children:n.title}),e.jsx(Y,{label:n.required?"Required":"Optional",size:"small",color:n.required?"error":"default"})]}),e.jsxs(c,{sx:{pl:0},children:[n.author&&e.jsxs(o,{variant:"body2",color:"text.secondary",children:["by ",n.author]}),n.edition&&e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Edition: ",n.edition]}),n.isbn&&e.jsxs(o,{variant:"body2",color:"text.secondary",children:["ISBN: ",n.isbn]})]})]},l))})})]}),(t==null?void 0:t.gradingPolicy)&&t.gradingPolicy.length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(U,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Be,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Grading Policy"})]})}),e.jsx(q,{children:e.jsx(H,{children:t.gradingPolicy.map((n,l)=>e.jsxs(N,{sx:{px:0,flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",mb:n.description?1:0},children:[e.jsx(o,{variant:"body1",children:n.component}),e.jsx(Y,{label:`${n.percentage}%`,size:"small",color:"primary"})]}),n.description&&e.jsx(o,{variant:"body2",color:"text.secondary",children:n.description})]},l))})})]}),(t==null?void 0:t.labSpecific)&&Object.keys(t.labSpecific).length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(U,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx($e,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Laboratory Information"})]})}),e.jsx(q,{children:e.jsxs(b,{container:!0,spacing:3,children:[t.labSpecific.safetyRequirements&&e.jsxs(b,{item:!0,xs:12,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Safety Requirements"}),e.jsx(H,{dense:!0,children:t.labSpecific.safetyRequirements.map((n,l)=>e.jsx(N,{sx:{py:.5},children:e.jsxs(o,{variant:"body2",children:["â€¢ ",n]})},l))})]}),t.labSpecific.dresscode&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Dress Code"}),e.jsx(H,{dense:!0,children:t.labSpecific.dresscode.map((n,l)=>e.jsx(N,{sx:{py:.5},children:e.jsxs(o,{variant:"body2",children:["â€¢ ",n]})},l))})]}),t.labSpecific.requiredEquipment&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Required Equipment"}),e.jsx(H,{dense:!0,children:t.labSpecific.requiredEquipment.map((n,l)=>e.jsx(N,{sx:{py:.5},children:e.jsxs(o,{variant:"body2",children:["â€¢ ",n]})},l))})]})]})})]}),(t==null?void 0:t.policies)&&Object.keys(t.policies).length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(U,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ee,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Course Policies"})]})}),e.jsx(q,{children:e.jsx(b,{container:!0,spacing:2,children:Object.entries(t.policies).map(([n,l])=>{if(!l)return null;const m=n.replace(/([A-Z])/g," $1").replace(/^./,C=>C.toUpperCase());return e.jsxs(b,{item:!0,xs:12,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:m}),e.jsx(o,{variant:"body2",sx:{mt:.5},children:l}),e.jsx(he,{sx:{mt:1}})]},n)})})})]}),R&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(U,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Other Course Information"})]})}),e.jsx(q,{children:e.jsx(b,{container:!0,spacing:2,children:Object.entries(F).map(([n,l])=>{const m=n.replace(/([A-Z])/g," $1").replace(/^./,C=>C.toUpperCase());return e.jsxs(b,{item:!0,xs:12,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:m}),e.jsx(c,{sx:{mt:.5},children:Array.isArray(l)?e.jsx(H,{dense:!0,children:l.map((C,E)=>e.jsx(N,{sx:{py:.25,px:0},children:e.jsxs(o,{variant:"body2",children:["â€¢ ",typeof C=="object"?JSON.stringify(C,null,2):String(C)]})},E))}):typeof l=="object"?e.jsx(c,{sx:{p:1,backgroundColor:"grey.100",borderRadius:1},children:e.jsx(o,{variant:"body2",component:"pre",sx:{fontFamily:"monospace",fontSize:"0.875rem"},children:JSON.stringify(l,null,2)})}):e.jsx(o,{variant:"body2",children:String(l)})}),Object.keys(F).indexOf(n)<Object.keys(F).length-1&&e.jsx(he,{sx:{mt:2}})]},n)})})})]})]}),e.jsxs(re,{open:g,onClose:()=>w(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"15px",backgroundColor:"#f8f9fa"}},children:[e.jsxs(se,{sx:{display:"flex",alignItems:"center",gap:1,fontFamily:"Staatliches, sans-serif",fontSize:"1.5rem",fontWeight:"bold",color:"#0B53C0",backgroundColor:"#ECF4FE",borderBottom:"1px solid #e3f2fd"},children:[e.jsx(xe,{sx:{color:"#0B53C0"}}),"Syllabus Document"]}),e.jsx(ne,{sx:{pt:3},children:a&&e.jsxs(c,{children:[e.jsxs(o,{variant:"body1",sx:{mb:2,fontFamily:"Staatliches, sans-serif",fontSize:"1.1rem",color:"#0B53C0"},children:[e.jsx("strong",{children:"Filename:"})," ",a.metadata.originalFilename]}),e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[e.jsx("strong",{children:"Type:"})," ",Ue(a.metadata.fileType)]}),e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[e.jsx("strong",{children:"Size:"})," ",qe(a.metadata.fileSize)]}),e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:[e.jsx("strong",{children:"Uploaded:"})," ",(()=>{if(!a.metadata.uploadedAt)return"Date not available";const n=a.metadata.uploadedAt;if(n instanceof Date)return n.toLocaleDateString();if(typeof n=="object"&&n!==null&&"seconds"in n)return new Date(n.seconds*1e3).toLocaleDateString();try{return new Date(n).toLocaleDateString()}catch{return"Date not available"}})()]})]})}),e.jsxs(oe,{sx:{p:3,gap:2},children:[e.jsx(I,{onClick:()=>w(!1),sx:{fontFamily:"Staatliches, sans-serif",fontSize:"1.1rem",textTransform:"none",borderRadius:"15px",color:"#666","&:hover":{backgroundColor:"#f0f0f0"}},children:"Close"}),e.jsx(I,{onClick:T,variant:"contained",startIcon:e.jsx(de,{}),sx:{fontFamily:"Staatliches, sans-serif",fontSize:"1.1rem",textTransform:"none",borderRadius:"15px",backgroundColor:"#CDDAFF",color:"#0B53C0","&:hover":{backgroundColor:"#0B53C0",color:"#FFFFFF"}},children:"Download"})]})]})]})},ct=()=>{const{userDetails:s}=J(),[h]=He(),t=h.get("course")||null,d=f.useMemo(()=>{const i=s!=null&&s.classes?Object.entries(s.classes).map(([x,u])=>({id:x,number:u.number,title:u.title})):[];return console.log("[SupplementalMaterials] Course list updated:",{count:i.length,courses:i.map(x=>`${x.number} - ${x.title}`),timestamp:new Date().toISOString()}),i},[s==null?void 0:s.classes]),a=f.useMemo(()=>d.find(i=>i.id===t),[d,t]);return e.jsxs(c,{className:"supplemental-container",children:[e.jsx(Ze,{}),t?e.jsxs(c,{children:[e.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:3},children:e.jsx(Y,{label:a?`${a.number} - ${a.title}`:"Selected Course",variant:"outlined",sx:{borderRadius:"15px",fontSize:"32px",fontWeight:"bold",background:"#e0f2f1",color:"#00695c",cursor:"pointer",transition:"background-color 0.3s",fontFamily:"Staatliches, sans-serif",padding:"20px 20px","&:hover":{backgroundColor:"#b2dfdb"}}})}),e.jsx(nt,{courseId:t,isAdmin:s==null?void 0:s.isAdmin}),e.jsxs(c,{className:"supplemental-content",children:[(s==null?void 0:s.isAdmin)&&e.jsx(Ke,{selectedCourse:t}),e.jsx(et,{initialCourse:t})]})]}):e.jsx(e.Fragment,{children:e.jsx(st,{courses:d})})]})};export{ct as default};
