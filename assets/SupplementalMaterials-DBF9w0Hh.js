import{j as e,B as l,a as k,T as o,a8 as Y,E as ge,a5 as ke,p as ie,f as ee,g as te,a9 as D,Y as Ie,N as G,z as Q,I as X,O as we,a7 as le,a2 as Ae,y as Fe,r as p,G as b,bu as De,bv as ze,ac as ye,D as se,l as ne,m as oe,n as je,o as ae,C as Ce,V as Te,W as Se,i as We,P as Me,aG as ce,aD as de,af as xe,av as O,aw as L,ax as Be,H as q,ay as U,az as Re,t as H,v as N,aA as Pe,L as $e,aB as Ee,q as he}from"./ui-ySD7tZ62.js";import{u as J,A as Oe,i as r,b as I,g as Z,j as ue,c as y,a as re,d as Le,s as v,t as S,k as qe,l as Ue,m as He,B as Ne}from"./index-m_vZ80Qp.js";import{P as _,R as pe,x as fe,v as V,_ as me,I as Ge,e as K,y as Ye,i as _e,f as ve}from"./firebase-DpGenoA-.js";import"./vendor-BFl3bqVE.js";const Je=()=>{const s=J(),h=()=>{s("/")};return e.jsxs(l,{children:[e.jsx(l,{className:"supplemental-header",children:e.jsx(k,{variant:"text",startIcon:e.jsx(Oe,{}),onClick:h,className:"supplemental-back-button",children:"Home Page"})}),e.jsx(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:e.jsx(o,{className:"supplemental-title",children:"Course Materials"})})]})},Ze=({selectedCourse:s,variant:h="contained",size:t="large",showModeToggle:d=!1,onModeChange:a,currentMode:i="manual"})=>{const x=J(),u=()=>{s&&x(`/add-material?course=${s}&mode=${d?i:"manual"}`)},j=f=>{a&&a(f)};return d?e.jsx(Y,{in:!0,timeout:500,children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:2,p:3,backgroundColor:r.palette.background.paper,borderRadius:I["2xl"],border:`1px solid ${r.palette.divider}`,boxShadow:r.shadows[2]},children:[e.jsx(o,{variant:"h6",sx:{fontFamily:r.typography.h6.fontFamily,fontWeight:r.typography.h6.fontWeight,color:r.palette.text.primary,textAlign:"center",mb:1},children:"Create New Material"}),e.jsx(o,{variant:"body2",sx:{color:r.palette.text.secondary,textAlign:"center",mb:2},children:"Choose how you'd like to create your material"}),e.jsxs(l,{sx:{display:"flex",gap:2},children:[e.jsx(k,{variant:i==="manual"?"contained":"outlined",startIcon:e.jsx(ge,{}),onClick:()=>j("manual"),disabled:!s,sx:{flex:1,py:2,borderRadius:I.xl,textTransform:"none",fontWeight:600,...i==="manual"&&{backgroundColor:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.dark}},...i!=="manual"&&{borderColor:r.palette.primary.main,color:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.light,borderColor:r.palette.primary.dark}}},children:"Manual Entry"}),e.jsx(k,{variant:i==="ai"?"contained":"outlined",startIcon:e.jsx(ke,{}),onClick:()=>j("ai"),disabled:!s,sx:{flex:1,py:2,borderRadius:I.xl,textTransform:"none",fontWeight:600,...i==="ai"&&{backgroundColor:r.palette.secondary.main,"&:hover":{backgroundColor:r.palette.secondary.dark}},...i!=="ai"&&{borderColor:r.palette.secondary.main,color:r.palette.secondary.main,"&:hover":{backgroundColor:r.palette.secondary.light,borderColor:r.palette.secondary.dark}}},children:"AI Import"})]}),e.jsx(k,{variant:"contained",startIcon:e.jsx(ie,{}),onClick:u,disabled:!s,size:t,sx:{width:"100%",py:2,borderRadius:I.xl,textTransform:"none",fontWeight:600,backgroundColor:i==="ai"?r.palette.secondary.main:r.palette.primary.main,"&:hover":{backgroundColor:i==="ai"?r.palette.secondary.dark:r.palette.primary.dark,transform:"translateY(-1px)",boxShadow:r.shadows[4]},transition:r.transitions.create(["all"],{duration:r.transitions.duration.short})},children:i==="ai"?"Import with AI":"Create Material"})]})}):e.jsx(Y,{in:!0,timeout:300,children:e.jsx(k,{variant:h,startIcon:e.jsx(ie,{}),onClick:u,disabled:!s,size:t,sx:{borderRadius:r.shape.borderRadius,textTransform:"none",fontWeight:600,py:t==="large"?2:t==="medium"?1.5:1,px:t==="large"?4:t==="medium"?3:2,transition:r.transitions.create(["all"],{duration:r.transitions.duration.short}),"&:hover":{transform:"translateY(-1px)",boxShadow:r.shadows[4]},...h==="contained"&&{backgroundColor:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.dark}},...h==="outlined"&&{borderColor:r.palette.primary.main,color:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.light,borderColor:r.palette.primary.dark}}},children:"Add Material"})})},Ke=s=>{const h=new Date;if(s.scheduledTimestamp){const a=s.scheduledTimestamp.toDate();return a>h?`Scheduled for ${a.toLocaleDateString()}`:`Scheduled ${a.toLocaleDateString()}`}if(s.published){const a=s.timestamp.toDate(),i=Math.floor((h.getTime()-a.getTime())/(1e3*60*60*24));if(i===0)return"Published today";if(i===1)return"Published yesterday";if(i<7)return`Published ${i} days ago`;if(i<30){const x=Math.floor(i/7);return`Published ${x} week${x>1?"s":""} ago`}else return`Published ${a.toLocaleDateString()}`}const t=s.timestamp.toDate(),d=Math.floor((h.getTime()-t.getTime())/(1e3*60*60*24));if(d===0)return"Created today";if(d===1)return"Created yesterday";if(d<7)return`Created ${d} days ago`;if(d<30){const a=Math.floor(d/7);return`Created ${a} week${a>1?"s":""} ago`}else return`Created ${t.toLocaleDateString()}`},Qe=({material:s,isCourseAdmin:h=!1,loading:t=!1,onView:d,onEdit:a,onDelete:i,onUnpublish:x,className:u})=>{const f=(g=>g.published?{label:"Published",color:r.palette.success.main,backgroundColor:r.palette.success.light,icon:e.jsx(le,{sx:{fontSize:16}})}:g.scheduledTimestamp?{label:"Scheduled",color:r.palette.info.main,backgroundColor:r.palette.info.light,icon:e.jsx(Ae,{sx:{fontSize:16}})}:{label:"Draft",color:r.palette.warning.main,backgroundColor:r.palette.warning.light,icon:e.jsx(Fe,{sx:{fontSize:16}})})(s);return t?e.jsxs(ee,{className:u,sx:{height:200},children:[e.jsxs(te,{children:[e.jsx(D,{variant:"text",width:"80%",height:32}),e.jsx(D,{variant:"text",width:"60%",height:24,sx:{mt:1}}),e.jsx(D,{variant:"rectangular",width:"100%",height:40,sx:{mt:2,borderRadius:2}})]}),e.jsxs(Ie,{children:[e.jsx(D,{variant:"circular",width:40,height:40}),e.jsx(D,{variant:"circular",width:40,height:40}),e.jsx(D,{variant:"circular",width:40,height:40})]})]}):e.jsx(Y,{in:!0,timeout:300,children:e.jsx(ee,{className:u,sx:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-4px)",boxShadow:r.shadows[8]}},children:e.jsxs(te,{sx:{flexGrow:1,pb:3,px:3,pt:3},children:[e.jsxs(l,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(G,{icon:f.icon,label:f.label,size:"small",sx:{backgroundColor:f.backgroundColor,color:f.color,fontWeight:600,"& .MuiChip-icon":{color:f.color}}}),h&&e.jsxs(l,{sx:{display:"flex",gap:.5},children:[e.jsx(Q,{title:"Edit Material",arrow:!0,children:e.jsx(X,{size:"small",onClick:g=>{g.stopPropagation(),a==null||a(s.id)},sx:{color:r.palette.primary.main,"&:hover":{backgroundColor:r.palette.primary.light,color:r.palette.primary.contrastText}},children:e.jsx(ge,{fontSize:"small"})})}),e.jsx(Q,{title:"Delete Material",arrow:!0,children:e.jsx(X,{size:"small",onClick:g=>{g.stopPropagation(),i==null||i(s.id)},sx:{color:r.palette.error.main,"&:hover":{backgroundColor:r.palette.error.light,color:r.palette.error.contrastText}},children:e.jsx(we,{fontSize:"small"})})}),s.published&&x&&e.jsx(Q,{title:"Unpublish Material",arrow:!0,children:e.jsx(X,{size:"small",onClick:g=>{g.stopPropagation(),x==null||x(s.id)},sx:{color:r.palette.warning.main,"&:hover":{backgroundColor:r.palette.warning.light,color:r.palette.warning.contrastText}},children:e.jsx(le,{fontSize:"small"})})})]})]}),e.jsx(o,{variant:"h5",component:"h3",sx:{fontFamily:r.typography.h5.fontFamily,fontWeight:600,fontSize:{xs:"1.25rem",sm:"1.5rem"},lineHeight:1.3,color:r.palette.text.primary,mb:1,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{color:r.palette.primary.main,textDecoration:"underline",textDecorationColor:r.palette.primary.main,textDecorationThickness:"2px",textUnderlineOffset:"4px",transform:"translateY(-1px)"}},onClick:g=>{g.stopPropagation(),d==null||d(s.id)},children:s.title||"Untitled Material"}),e.jsx(l,{sx:{mt:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.875rem",display:"flex",alignItems:"center",gap:1},children:[e.jsx(l,{component:"span",sx:{width:8,height:8,borderRadius:"50%",backgroundColor:f.color}}),Ke(s)]})})]})})})},Xe=({courseId:s,isCourseAdmin:h,onDeleteClick:t,onUnpublishClick:d})=>{const[a,i]=p.useState(0),[x,u]=p.useState([]),[j,f]=p.useState(!0),[g,w]=p.useState(null),{userDetails:A}=Z(),M=J(),z=_(),F=[{key:"published",label:"Published",icon:"📚"},{key:"scheduled",label:"Scheduled",icon:"⏰"},{key:"saved",label:"Drafts",icon:"💾"}];p.useEffect(()=>{if(!s){u([]),f(!1);return}f(!0);const n=A!=null&&A.isAdmin?pe(me(z,"materials"),V("course","==",s),fe("timestamp","desc")):pe(me(z,"materials"),V("course","==",s),V("published","==",!0),fe("timestamp","desc")),c=Ge(n,m=>{const C=m.docs.map(E=>({id:E.id,...E.data()}));u(C),f(!1),w(null)},m=>{console.error("Error fetching materials:",m),w("Failed to fetch materials"),f(!1)});return()=>c()},[s,z,A]);const B=(n,c)=>{i(c)},R=n=>{M(`/view-material/${n}`)},P=n=>{M(`/edit-material/${n}`)},T=n=>x.filter(c=>{switch(n){case"published":return c.published===!0;case"scheduled":return c.scheduledTimestamp&&!c.published;case"saved":return!c.published&&!c.scheduledTimestamp;default:return!1}}),$=n=>T(n).length,W=T(F[a].key);return j?e.jsxs(l,{sx:{width:"100%"},children:[e.jsx(l,{sx:{mb:4},children:e.jsx(D,{variant:"rectangular",height:60,sx:{borderRadius:2}})}),e.jsx(b,{container:!0,spacing:3,children:Array.from({length:6}).map((n,c)=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,children:e.jsx(D,{variant:"rectangular",height:200,sx:{borderRadius:2}})},c))})]}):g?e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200,p:4},children:[e.jsx(o,{variant:"h6",sx:{color:r.palette.error.main,mb:2,textAlign:"center"},children:"Error Loading Materials"}),e.jsx(o,{variant:"body2",sx:{color:r.palette.text.secondary,textAlign:"center"},children:g})]}):e.jsxs(l,{sx:{width:"100%"},children:[e.jsx(l,{sx:{mb:4},children:e.jsx(De,{value:a,onChange:B,variant:"fullWidth",sx:{backgroundColor:r.palette.background.paper,borderRadius:I.xl,boxShadow:r.shadows[1],"& .MuiTabs-indicator":{backgroundColor:r.palette.primary.main,height:3,borderRadius:"3px 3px 0 0"},"& .MuiTabs-flexContainer":{gap:1}},children:F.map((n,c)=>{const m=$(n.key);return e.jsx(ze,{label:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(o,{variant:"button",sx:{fontWeight:600,textTransform:"none",fontSize:"0.875rem"},children:n.label}),e.jsx(G,{label:m,size:"small",sx:{backgroundColor:r.palette.primary.light,color:r.palette.primary.main,fontWeight:600,minWidth:24,height:20,fontSize:"0.75rem"}})]}),sx:{textTransform:"none",fontWeight:600,minHeight:48,color:r.palette.text.primary,"&.Mui-selected":{color:r.palette.primary.main,backgroundColor:r.palette.primary.light,borderRadius:I.xl},"&:hover":{backgroundColor:r.palette.action.hover,borderRadius:I.xl}}},n.key)})})}),W.length===0?e.jsx(ye,{maxWidth:"md",children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300,textAlign:"center"},children:[e.jsxs(o,{variant:"h6",sx:{color:r.palette.text.secondary,mb:2},children:[a===0&&"No published materials yet.",a===1&&"No scheduled materials.",a===2&&"No draft materials saved."]}),e.jsxs(o,{variant:"body2",sx:{color:r.palette.text.disabled},children:[a===0&&"Published materials will appear here once you publish them.",a===1&&"Scheduled materials will appear here once you schedule them.",a===2&&"Draft materials will appear here as you work on them."]})]})}):e.jsx(Y,{in:!0,timeout:300,children:e.jsx(b,{container:!0,spacing:3,children:W.map(n=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Qe,{material:n,isCourseAdmin:h,onView:R,onEdit:P,onDelete:t,onUnpublish:d})},n.id))})})]})},Ve=({materialId:s,open:h,onClose:t,onDelete:d})=>{const a=_(),i=async()=>{const x=K(a,"materials",s);await Ye(x),d(),t()};return e.jsxs(se,{open:h,onClose:t,children:[e.jsx(ne,{children:"Delete Material"}),e.jsx(oe,{children:e.jsx(je,{children:"Are you sure you want to delete this material? This action cannot be undone."})}),e.jsxs(ae,{children:[e.jsx(k,{onClick:t,color:"primary",children:"Cancel"}),e.jsx(k,{onClick:i,color:"secondary",children:"Delete"})]})]})},et=({materialId:s,open:h,onClose:t,onUnpublish:d})=>{const a=_(),i=async()=>{const x=K(a,"materials",s);await _e(x,{published:!1}),d(),t()};return e.jsxs(se,{open:h,onClose:t,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ne,{id:"alert-dialog-title",children:"Unpublish Material"}),e.jsx(oe,{children:e.jsx(je,{id:"alert-dialog-description",children:"Are you sure you want to unpublish this material? It will no longer be visible to users until it is published again."})}),e.jsxs(ae,{children:[e.jsx(k,{onClick:t,color:"primary",children:"Cancel"}),e.jsx(k,{onClick:i,color:"error",autoFocus:!0,children:"Unpublish"})]})]})},tt=({initialCourse:s})=>{const{userDetails:h}=Z(),t=_(),[d,a]=p.useState(s??null),[i,x]=p.useState(!1),[u,j]=p.useState(null),[f,g]=p.useState({open:!1,materialId:null}),[w,A]=p.useState(null),[M,z]=p.useState(!1),F=p.useCallback(async()=>{if(d)try{z(!0);const c=K(t,"courses",d),m=await ve(c);if(m.exists()){const C=m.data(),E=(C==null?void 0:C.courseAdmin)||[];x(E.includes(h==null?void 0:h.uid))}else x(!1)}catch(c){console.error("Error fetching course admin status:",c),A("Failed to verify course permissions")}finally{z(!1)}},[d,t,h]);p.useEffect(()=>{d&&F()},[d,F]),p.useEffect(()=>{s&&d!==s&&a(s)},[s,d]);const B=c=>{j(c)},R=()=>{j(null)},P=()=>{console.log("Material deleted:",u),j(null)},T=c=>{g({open:!0,materialId:c})},$=()=>{console.log("Material unpublished:",f.materialId),g({open:!1,materialId:null})},W=()=>{g({open:!1,materialId:null})},n=()=>{A(null)};return e.jsxs(l,{sx:{width:"100%"},children:[d?e.jsx(Y,{in:!0,timeout:500,children:e.jsx(l,{children:e.jsx(Xe,{courseId:d,isCourseAdmin:i,onDeleteClick:B,onUnpublishClick:T})})}):e.jsx(ye,{maxWidth:"md",children:e.jsxs(l,{sx:{textAlign:"center",py:8,px:4,backgroundColor:r.palette.background.paper,borderRadius:I["2xl"],border:`1px solid ${r.palette.divider}`},children:[e.jsx(o,{variant:"h5",sx:{fontFamily:r.typography.h5.fontFamily,fontWeight:r.typography.h5.fontWeight,color:r.palette.text.secondary,mb:2},children:"Select a Course"}),e.jsx(o,{variant:"body1",sx:{color:r.palette.text.secondary,maxWidth:400,mx:"auto"},children:"Please select a course from the dropdown above to view and manage course materials."})]})}),M&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:4},children:e.jsx(Ce,{size:40,sx:{color:r.palette.primary.main}})}),u&&e.jsx(Ve,{materialId:u,open:!!u,onClose:R,onDelete:P}),f.materialId&&e.jsx(et,{materialId:f.materialId,open:f.open,onClose:W,onUnpublish:$}),w&&e.jsx(Te,{open:!!w,autoHideDuration:6e3,onClose:n,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(Se,{onClose:n,severity:"error",sx:{backgroundColor:r.palette.error.light,color:r.palette.error.contrastText,"& .MuiAlert-icon":{color:r.palette.error.main}},children:w})})]})},rt=()=>{const{userDetails:s}=Z();return p.useMemo(()=>{if(!(s!=null&&s.classes))return{publicCourses:[],userCourses:[]};const t=Object.entries(s.classes).map(([i,x])=>{let u,j;return x.courseCreatedAt&&(x.courseCreatedAt instanceof Date?u=x.courseCreatedAt:u=ue(x.courseCreatedAt)),x.enrolledAt&&(x.enrolledAt instanceof Date?j=x.enrolledAt:j=ue(x.enrolledAt)),{id:i,number:x.number,title:x.title,isPublic:i==="rqoyheM9Lf8jGftIoZyT",courseCreatedAt:u||void 0,enrolledAt:j||void 0,isCourseAdmin:x.isCourseAdmin}}),d=t.filter(i=>i.isPublic),a=t.filter(i=>!i.isPublic);return a.sort((i,x)=>!i.enrolledAt&&!x.enrolledAt?0:i.enrolledAt?x.enrolledAt?x.enrolledAt.getTime()-i.enrolledAt.getTime():-1:1),{publicCourses:d,userCourses:a}},[s==null?void 0:s.classes])},st=({course:s,onClick:h})=>{const t=s.isPublic||s.id==="xsA42JCvfCUtmyoyx45s";return e.jsx(ee,{onClick:h,sx:{height:"100%",cursor:"pointer",backgroundColor:y.background.primary,borderRadius:I.xl,border:`1px solid ${y.neutral[200]}`,boxShadow:re.sm,transition:Le.transitions.normal,position:"relative","&:hover":{transform:"translateY(-8px)",boxShadow:re.xl,border:`1px solid ${t?y.warning:y.primary[500]}`}},children:e.jsx(te,{sx:{textAlign:"center",p:v[4],height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:e.jsxs(l,{sx:{flex:1},children:[e.jsx(l,{sx:{color:t?y.warning:y.primary[500],mb:v[3],display:"flex",justifyContent:"center"},children:e.jsx(We,{sx:{fontSize:40}})}),e.jsx(o,{variant:"h6",component:"h3",sx:{fontWeight:S.fontWeight.bold,fontFamily:S.fontFamily.display,fontSize:"2rem",color:y.text.primary,mb:v[2]},children:s.number}),e.jsx(o,{variant:"body2",sx:{color:y.text.secondary,fontFamily:S.fontFamily.secondary,fontSize:S.fontSize.lg,lineHeight:1.5,mb:v[1]},children:s.title}),s.enrolledAt&&e.jsxs(o,{variant:"caption",sx:{color:y.text.tertiary,fontFamily:S.fontFamily.secondary,fontSize:S.fontSize.xs,fontStyle:"italic",mb:v[2],display:"block"},children:["Enrolled: ",s.enrolledAt.toLocaleDateString()]}),e.jsx(G,{label:s.isCourseAdmin?"Instructor Access":"Student Access",size:"small",sx:{backgroundColor:s.isCourseAdmin?y.warning+"20":y.secondary[100],color:s.isCourseAdmin?y.warning:y.secondary[700],fontFamily:S.fontFamily.secondary,fontWeight:S.fontWeight.medium,fontSize:S.fontSize.xs}})]})})})},be=({title:s,courses:h,onCourseClick:t})=>h.length===0?null:e.jsxs(l,{sx:{mb:v[6]},children:[e.jsxs(l,{sx:{mb:v[4]},children:[e.jsx(o,{variant:"h4",component:"h2",sx:{fontFamily:S.fontFamily.display,fontSize:S.fontSize.xl,fontWeight:S.fontWeight.bold,color:y.text.primary,mb:v[2]},children:s}),e.jsxs(o,{variant:"body1",sx:{fontFamily:S.fontFamily.secondary,fontSize:S.fontSize.base,color:y.text.secondary,lineHeight:1.6},children:[h.length," ",h.length===1?"course":"courses"," available"]})]}),e.jsx(b,{container:!0,spacing:v[4],children:h.map(d=>e.jsx(b,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(st,{course:d,onClick:()=>t(d.id)})},d.id))})]}),nt=({courses:s})=>{const h=J(),{publicCourses:t,userCourses:d}=rt(),a=i=>{h(`/supplemental-materials?course=${i}`)};return e.jsx(l,{sx:{width:"100%",padding:4},children:e.jsxs(l,{sx:{mb:v[6],p:v[4],backgroundColor:y.background.secondary,borderRadius:I.xl,border:`1px solid ${y.neutral[200]}`,boxShadow:re.sm,position:"relative",mt:v[3]},children:[e.jsx(l,{sx:{position:"absolute",top:"-25px",left:"40px",backgroundColor:y.secondary[500],borderRadius:`${I.lg} ${I.lg} 0 0`,px:v[3],py:v[1],zIndex:1},children:e.jsx(o,{sx:{color:y.text.inverse,fontFamily:S.fontFamily.display,fontSize:"2rem",fontWeight:S.fontWeight.bold,whiteSpace:"nowrap",lineHeight:1},children:"Available Courses"})}),e.jsxs(l,{sx:{mt:v[3]},children:[e.jsx(be,{title:"Public Course",courses:t,onCourseClick:a}),e.jsx(be,{title:"Your Enrolled Courses",courses:d,onCourseClick:a})]})]})})},ot=({courseId:s,isAdmin:h=!1})=>{var P,T,$,W;const[t,d]=p.useState(null),[a,i]=p.useState(null),[x,u]=p.useState(!0),[j,f]=p.useState(null),[g,w]=p.useState(!1),A=_();p.useEffect(()=>{s&&(async()=>{try{u(!0);const c=K(A,"courses",s),m=await ve(c);if(m.exists()){const C=m.data();d(C.additionalInfo||null),i(C.syllabusFile||null)}else f("Course not found")}catch(c){console.error("Error fetching course additional info:",c),f("Failed to load course information")}finally{u(!1)}})()},[s,A]);const M=()=>{a!=null&&a.url&&window.open(a.url,"_blank")},F=(()=>{if(!t)return{};const n=new Set(["contactInfo","policies","additionalResources","labSpecific","textbooks","gradingPolicy","assignments","prerequisites","lastUpdated"]),c={};return Object.keys(t).forEach(m=>{!n.has(m)&&t[m]!=null&&(c[m]=t[m])}),c})(),B=Object.keys(F).length>0,R=t&&(t.contactInfo||t.policies||t.additionalResources||t.labSpecific||((P=t.textbooks)==null?void 0:P.length)||((T=t.gradingPolicy)==null?void 0:T.length)||(($=t.assignments)==null?void 0:$.length)||((W=t.prerequisites)==null?void 0:W.length)||B);return x?e.jsx(l,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(Ce,{})}):j?e.jsx(Se,{severity:"error",sx:{mb:3},children:j}):!R&&!a?null:e.jsxs(Me,{sx:{p:3,mb:4,backgroundColor:"#f8f9fa",borderRadius:"15px",border:"1px solid #e3f2fd"},children:[e.jsxs(o,{variant:"h4",sx:{mb:3,display:"flex",alignItems:"center",gap:1,fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"2rem"},children:[e.jsx(ce,{sx:{color:"#0B53C0"}}),"Course Information"]}),a&&e.jsx(l,{sx:{mb:3},children:e.jsx(k,{variant:"outlined",startIcon:e.jsx(xe,{}),endIcon:e.jsx(de,{}),onClick:()=>w(!0),sx:{mb:2,fontFamily:"Staatliches, sans-serif",fontSize:"1.2rem",textTransform:"none",borderRadius:"15px",backgroundColor:"#CDDAFF",color:"#0B53C0",border:"1px solid #0B53C0","&:hover":{backgroundColor:"#0B53C0",color:"#FFFFFF"}},children:"Syllabus"})}),R&&e.jsxs(l,{sx:{mb:2},children:[(t==null?void 0:t.contactInfo)&&Object.keys(t.contactInfo).length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(q,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Be,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Contact Information"})]})}),e.jsx(U,{children:e.jsxs(b,{container:!0,spacing:2,children:[t.contactInfo.email&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Email"}),e.jsx(o,{variant:"body1",children:t.contactInfo.email})]}),t.contactInfo.phone&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Phone"}),e.jsx(o,{variant:"body1",children:t.contactInfo.phone})]}),t.contactInfo.office&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Office"}),e.jsx(o,{variant:"body1",children:t.contactInfo.office})]}),t.contactInfo.officeHours&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Office Hours"}),e.jsx(o,{variant:"body1",children:t.contactInfo.officeHours})]}),t.contactInfo.website&&e.jsxs(b,{item:!0,xs:12,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Website"}),e.jsx(o,{variant:"body1",children:e.jsx("a",{href:t.contactInfo.website,target:"_blank",rel:"noopener noreferrer",children:t.contactInfo.website})})]})]})})]}),(t==null?void 0:t.textbooks)&&t.textbooks.length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(q,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Re,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Textbooks & Resources"})]})}),e.jsx(U,{children:e.jsx(H,{children:t.textbooks.map((n,c)=>e.jsxs(N,{sx:{px:0,flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(o,{variant:"body1",sx:{fontWeight:"medium"},children:n.title}),e.jsx(G,{label:n.required?"Required":"Optional",size:"small",color:n.required?"error":"default"})]}),e.jsxs(l,{sx:{pl:0},children:[n.author&&e.jsxs(o,{variant:"body2",color:"text.secondary",children:["by ",n.author]}),n.edition&&e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Edition: ",n.edition]}),n.isbn&&e.jsxs(o,{variant:"body2",color:"text.secondary",children:["ISBN: ",n.isbn]})]})]},c))})})]}),(t==null?void 0:t.gradingPolicy)&&t.gradingPolicy.length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(q,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Pe,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Grading Policy"})]})}),e.jsx(U,{children:e.jsx(H,{children:t.gradingPolicy.map((n,c)=>e.jsxs(N,{sx:{px:0,flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",mb:n.description?1:0},children:[e.jsx(o,{variant:"body1",children:n.component}),e.jsx(G,{label:`${n.percentage}%`,size:"small",color:"primary"})]}),n.description&&e.jsx(o,{variant:"body2",color:"text.secondary",children:n.description})]},c))})})]}),(t==null?void 0:t.labSpecific)&&Object.keys(t.labSpecific).length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(q,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx($e,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Laboratory Information"})]})}),e.jsx(U,{children:e.jsxs(b,{container:!0,spacing:3,children:[t.labSpecific.safetyRequirements&&e.jsxs(b,{item:!0,xs:12,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Safety Requirements"}),e.jsx(H,{dense:!0,children:t.labSpecific.safetyRequirements.map((n,c)=>e.jsx(N,{sx:{py:.5},children:e.jsxs(o,{variant:"body2",children:["• ",n]})},c))})]}),t.labSpecific.dresscode&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Dress Code"}),e.jsx(H,{dense:!0,children:t.labSpecific.dresscode.map((n,c)=>e.jsx(N,{sx:{py:.5},children:e.jsxs(o,{variant:"body2",children:["• ",n]})},c))})]}),t.labSpecific.requiredEquipment&&e.jsxs(b,{item:!0,xs:12,md:6,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:"Required Equipment"}),e.jsx(H,{dense:!0,children:t.labSpecific.requiredEquipment.map((n,c)=>e.jsx(N,{sx:{py:.5},children:e.jsxs(o,{variant:"body2",children:["• ",n]})},c))})]})]})})]}),(t==null?void 0:t.policies)&&Object.keys(t.policies).length>0&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(q,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ee,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Course Policies"})]})}),e.jsx(U,{children:e.jsx(b,{container:!0,spacing:2,children:Object.entries(t.policies).map(([n,c])=>{if(!c)return null;const m=n.replace(/([A-Z])/g," $1").replace(/^./,C=>C.toUpperCase());return e.jsxs(b,{item:!0,xs:12,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:m}),e.jsx(o,{variant:"body2",sx:{mt:.5},children:c}),e.jsx(he,{sx:{mt:1}})]},n)})})})]}),B&&e.jsxs(O,{children:[e.jsx(L,{expandIcon:e.jsx(q,{sx:{color:"#0B53C0"}}),sx:{"&:hover":{backgroundColor:"#f0f7ff !important"},"&.Mui-expanded":{backgroundColor:"#f0f7ff"},backgroundColor:"transparent"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{sx:{color:"#0B53C0"}}),e.jsx(o,{variant:"h6",sx:{fontFamily:"Staatliches, sans-serif",fontWeight:"bold",color:"#0B53C0",fontSize:"1.25rem"},children:"Other Course Information"})]})}),e.jsx(U,{children:e.jsx(b,{container:!0,spacing:2,children:Object.entries(F).map(([n,c])=>{const m=n.replace(/([A-Z])/g," $1").replace(/^./,C=>C.toUpperCase());return e.jsxs(b,{item:!0,xs:12,children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontWeight:"bold"},children:m}),e.jsx(l,{sx:{mt:.5},children:Array.isArray(c)?e.jsx(H,{dense:!0,children:c.map((C,E)=>e.jsx(N,{sx:{py:.25,px:0},children:e.jsxs(o,{variant:"body2",children:["• ",typeof C=="object"?JSON.stringify(C,null,2):String(C)]})},E))}):typeof c=="object"?e.jsx(l,{sx:{p:1,backgroundColor:"grey.100",borderRadius:1},children:e.jsx(o,{variant:"body2",component:"pre",sx:{fontFamily:"monospace",fontSize:"0.875rem"},children:JSON.stringify(c,null,2)})}):e.jsx(o,{variant:"body2",children:String(c)})}),Object.keys(F).indexOf(n)<Object.keys(F).length-1&&e.jsx(he,{sx:{mt:2}})]},n)})})})]})]}),e.jsxs(se,{open:g,onClose:()=>w(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"15px",backgroundColor:"#f8f9fa"}},children:[e.jsxs(ne,{sx:{display:"flex",alignItems:"center",gap:1,fontFamily:"Staatliches, sans-serif",fontSize:"1.5rem",fontWeight:"bold",color:"#0B53C0",backgroundColor:"#ECF4FE",borderBottom:"1px solid #e3f2fd"},children:[e.jsx(xe,{sx:{color:"#0B53C0"}}),"Syllabus Document"]}),e.jsx(oe,{sx:{pt:3},children:a&&e.jsxs(l,{children:[e.jsxs(o,{variant:"body1",sx:{mb:2,fontFamily:"Staatliches, sans-serif",fontSize:"1.1rem",color:"#0B53C0"},children:[e.jsx("strong",{children:"Filename:"})," ",a.metadata.originalFilename]}),e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[e.jsx("strong",{children:"Type:"})," ",qe(a.metadata.fileType)]}),e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[e.jsx("strong",{children:"Size:"})," ",Ue(a.metadata.fileSize)]}),e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:[e.jsx("strong",{children:"Uploaded:"})," ",(()=>{if(!a.metadata.uploadedAt)return"Date not available";const n=a.metadata.uploadedAt;if(n instanceof Date)return n.toLocaleDateString();if(typeof n=="object"&&n!==null&&"seconds"in n)return new Date(n.seconds*1e3).toLocaleDateString();try{return new Date(n).toLocaleDateString()}catch{return"Date not available"}})()]})]})}),e.jsxs(ae,{sx:{p:3,gap:2},children:[e.jsx(k,{onClick:()=>w(!1),sx:{fontFamily:"Staatliches, sans-serif",fontSize:"1.1rem",textTransform:"none",borderRadius:"15px",color:"#666","&:hover":{backgroundColor:"#f0f0f0"}},children:"Close"}),e.jsx(k,{onClick:M,variant:"contained",startIcon:e.jsx(de,{}),sx:{fontFamily:"Staatliches, sans-serif",fontSize:"1.1rem",textTransform:"none",borderRadius:"15px",backgroundColor:"#CDDAFF",color:"#0B53C0","&:hover":{backgroundColor:"#0B53C0",color:"#FFFFFF"}},children:"Download"})]})]})]})},dt=()=>{const{userDetails:s}=Z(),[h]=He(),t=h.get("course")||null,d=p.useMemo(()=>{const i=s!=null&&s.classes?Object.entries(s.classes).map(([x,u])=>({id:x,number:u.number,title:u.title})):[];return console.log("[SupplementalMaterials] Course list updated:",{count:i.length,courses:i.map(x=>`${x.number} - ${x.title}`),timestamp:new Date().toISOString()}),i},[s==null?void 0:s.classes]),a=p.useMemo(()=>d.find(i=>i.id===t),[d,t]);return e.jsxs(l,{className:"supplemental-container",children:[e.jsx(Je,{}),t?e.jsxs(l,{children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(Ne,{returnToSelection:!0}),e.jsx(G,{label:a?`${a.number} - ${a.title}`:"Selected Course",variant:"outlined",sx:{borderRadius:"15px",fontSize:"32px",fontWeight:"bold",background:"#e0f2f1",color:"#00695c",cursor:"pointer",transition:"background-color 0.3s",fontFamily:"Staatliches, sans-serif",padding:"20px 20px","&:hover":{backgroundColor:"#b2dfdb"}}})]}),e.jsx(ot,{courseId:t,isAdmin:s==null?void 0:s.isAdmin}),e.jsxs(l,{className:"supplemental-content",children:[(s==null?void 0:s.isAdmin)&&e.jsx(Ze,{selectedCourse:t}),e.jsx(tt,{initialCourse:t})]})]}):e.jsx(e.Fragment,{children:e.jsx(nt,{courses:d})})]})};export{dt as default};
